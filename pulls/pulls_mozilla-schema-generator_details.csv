,pullid,pulls_number,pulltitle,pullsbody,pullsuserlogin,pullsuserid,pullauthordate,author_association,merged_status,stats_addns,stats_delns,stats_changed_files,pull_repo_desc,pull_repo_lang,pull_commit_sha,pull_commit_message
0,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/194,194,Update docker engine version in CI,"Bug fix for #193 

The current docker engine version being used doesn't interpret the variables passed in the chown part of COPY commands.

This configuration succeeded in https://app.circleci.com/pipelines/github/mozilla/mozilla-schema-generator/892/workflows/705b5c24-3408-4fdc-a294-f45091e6774c/jobs/1342",jklukas,691060,2021-04-13T15:33:23Z,CONTRIBUTOR,True,27,6,3,A library for creating full representations of Mozilla telemetry pings.,Python,5dc2c5d77c5ad342e9e3c1ebf3041fb95acbe0f3,"Update docker engine version in CI

The current version doesn't interpret the variables passed in the chown
part of COPY commands."
1,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/193,193,Optimize Dockerfile,"The recursive `chown` step takes over 30 seconds to execute, significantly
slowing down the development process when attempting to test changes with
`make build && make run`.

By putting this step earlier, changes to the `bin/` content no longer trigger
a rerun of the `chown` step, cutting build time to less than 10 seconds.",jklukas,691060,2021-04-13T14:17:59Z,CONTRIBUTOR,True,24,4,2,A library for creating full representations of Mozilla telemetry pings.,Python,218bc880552eb2971ca01ce9d3166bc7e6501b6e,"Optimize Dockerfile

The recursive `chown` step takes over 30 seconds to execute, significantly
slowing down the development process when attempting to test changes with
`make build && make run`.

By putting this step earlier, changes to the `bin/` content no longer trigger
a rerun of the `chown` step, cutting build time to less than 10 seconds."
2,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/192,192,Comment out rally-zero-one incompatibility,"This is the followup to #191. Once the generated-schema has been overwritten, this can be merged in to place the normal validation rules against the namespace. ",acmiyaguchi,3304040,2021-04-12T20:46:12Z,COLLABORATOR,True,1,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,a8393b4dc1503b898b3282c05be82ecd782dad1c,Comment out rally-zero-one incompatibility
3,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/191,191,Bug 1703615 - Revert generated schema for rally-zero-one,"[bug 1703615](https://bugzilla.mozilla.org/show_bug.cgi?id=1703615) and https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/671

The rally-zero-one schema was reverted due to it having the incorrect structure after discussion with @hamilton. The schema was generated and deployed to stage, which is fine since it hasn't been deployed to prod. CI prevents this from being removed without an explicit whitelist entry.

",acmiyaguchi,3304040,2021-04-12T20:42:17Z,COLLABORATOR,True,5,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,e36e7d4a99c86cfdcf9a79cfcbb266558afc0b26,Bug 1703615 - Revert generated schema for rally-zero-one
4,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/190,190,Update all default branch references,Both this repo and mozilla-pipeline-schemas now have `main` as the default branch name.,jklukas,691060,2021-04-09T20:17:12Z,CONTRIBUTOR,True,18,18,6,A library for creating full representations of Mozilla telemetry pings.,Python,7d13b73ccec2dded36b0236ab22d06bbd26a170c,"Update all default branch references

Both this repo and mozilla-pipeline-schemas now have `main` as the default
branch name."
5,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/189,189,Bump jsonschema-transpiler to 1.9.0,Fixes https://github.com/mozilla/mozilla-schema-generator/issues/188 via https://github.com/mozilla/jsonschema-transpiler/pull/98,acmiyaguchi,3304040,2021-03-30T21:58:55Z,COLLABORATOR,True,1,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,99fca487a113ca1fe21c03be6017196ec6dd5247,Bump jsonschema-transpiler to 1.9.0
6,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/187,187,Bump pyyaml from 4.2b1 to 5.4 in /requirements,"Bumps [pyyaml](https://github.com/yaml/pyyaml) from 4.2b1 to 5.4.
<details>
<summary>Changelog</summary>
<p><em>Sourced from <a href=""https://github.com/yaml/pyyaml/blob/master/CHANGES"">pyyaml's changelog</a>.</em></p>
<blockquote>
<p>5.4 (2021-01-19)</p>
<ul>
<li><a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/407"">yaml/pyyaml#407</a> -- Build modernization, remove distutils, fix metadata, build wheels, CI to GHA</li>
<li><a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/472"">yaml/pyyaml#472</a> -- Fix for CVE-2020-14343, moves arbitrary python tags to UnsafeLoader</li>
<li><a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/441"">yaml/pyyaml#441</a> -- Fix memory leak in implicit resolver setup</li>
<li><a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/392"">yaml/pyyaml#392</a> -- Fix py2 copy support for timezone objects</li>
<li><a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/378"">yaml/pyyaml#378</a> -- Fix compatibility with Jython</li>
</ul>
<p>5.3.1 (2020-03-18)</p>
<ul>
<li><a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/386"">yaml/pyyaml#386</a> -- Prevents arbitrary code execution during python/object/new constructor</li>
</ul>
<p>5.3 (2020-01-06)</p>
<ul>
<li><a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/290"">yaml/pyyaml#290</a> -- Use <code>is</code> instead of equality for comparing with <code>None</code></li>
<li><a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/270"">yaml/pyyaml#270</a> -- Fix typos and stylistic nit</li>
<li><a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/309"">yaml/pyyaml#309</a> -- Fix up small typo</li>
<li><a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/161"">yaml/pyyaml#161</a> -- Fix handling of <strong>slots</strong></li>
<li><a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/358"">yaml/pyyaml#358</a> -- Allow calling add_multi_constructor with None</li>
<li><a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/285"">yaml/pyyaml#285</a> -- Add use of safe_load() function in README</li>
<li><a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/351"">yaml/pyyaml#351</a> -- Fix reader for Unicode code points over 0xFFFF</li>
<li><a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/360"">yaml/pyyaml#360</a> -- Enable certain unicode tests when maxunicode not &gt; 0xffff</li>
<li><a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/359"">yaml/pyyaml#359</a> -- Use full_load in yaml-highlight example</li>
<li><a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/244"">yaml/pyyaml#244</a> -- Document that PyYAML is implemented with Cython</li>
<li><a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/329"">yaml/pyyaml#329</a> -- Fix for Python 3.10</li>
<li><a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/310"">yaml/pyyaml#310</a> -- Increase size of index, line, and column fields</li>
<li><a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/260"">yaml/pyyaml#260</a> -- Remove some unused imports</li>
<li><a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/163"">yaml/pyyaml#163</a> -- Create timezone-aware datetimes when parsed as such</li>
<li><a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/363"">yaml/pyyaml#363</a> -- Add tests for timezone</li>
</ul>
<h2>5.2 (2019-12-02)</h2>
<ul>
<li>Repair incompatibilities introduced with 5.1. The default Loader was changed,
but several methods like add_constructor still used the old default
<a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/279"">yaml/pyyaml#279</a> -- A more flexible fix for custom tag constructors
<a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/287"">yaml/pyyaml#287</a> -- Change default loader for yaml.add_constructor
<a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/305"">yaml/pyyaml#305</a> -- Change default loader for add_implicit_resolver, add_path_resolver</li>
<li>Make FullLoader safer by removing python/object/apply from the default FullLoader
<a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/347"">yaml/pyyaml#347</a> -- Move constructor for object/apply to UnsafeConstructor</li>
<li>Fix bug introduced in 5.1 where quoting went wrong on systems with sys.maxunicode &lt;= 0xffff
<a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/276"">yaml/pyyaml#276</a> -- Fix logic for quoting special characters</li>
<li>Other PRs:
<a href=""https://github-redirect.dependabot.com/yaml/pyyaml/pull/280"">yaml/pyyaml#280</a> -- Update CHANGES for 5.1</li>
</ul>
<h2>5.1.2 (2019-07-30)</h2>
<ul>
<li>Re-release of 5.1 with regenerated Cython sources to build properly for Python 3.8b2+</li>
</ul>
<!-- raw HTML omitted -->
</blockquote>
<p>... (truncated)</p>
</details>
<details>
<summary>Commits</summary>
<ul>
<li>See full diff in <a href=""https://github.com/yaml/pyyaml/commits/5.4"">compare view</a></li>
</ul>
</details>
<br />


[![Dependabot compatibility score](https://dependabot-badges.githubapp.com/badges/compatibility_score?dependency-name=pyyaml&package-manager=pip&previous-version=4.2b1&new-version=5.4)](https://docs.github.com/en/github/managing-security-vulnerabilities/about-dependabot-security-updates#about-compatibility-scores)

Dependabot will resolve any conflicts with this PR as long as you don't alter it yourself. You can also trigger a rebase manually by commenting `@dependabot rebase`.

[//]: # (dependabot-automerge-start)
[//]: # (dependabot-automerge-end)

---

<details>
<summary>Dependabot commands and options</summary>
<br />

You can trigger Dependabot actions by commenting on this PR:
- `@dependabot rebase` will rebase this PR
- `@dependabot recreate` will recreate this PR, overwriting any edits that have been made to it
- `@dependabot merge` will merge this PR after your CI passes on it
- `@dependabot squash and merge` will squash and merge this PR after your CI passes on it
- `@dependabot cancel merge` will cancel a previously requested merge and block automerging
- `@dependabot reopen` will reopen this PR if it is closed
- `@dependabot close` will close this PR and stop Dependabot recreating it. You can achieve the same result by closing it manually
- `@dependabot ignore this major version` will close this PR and stop Dependabot creating any more for this major version (unless you reopen the PR or upgrade to it yourself)
- `@dependabot ignore this minor version` will close this PR and stop Dependabot creating any more for this minor version (unless you reopen the PR or upgrade to it yourself)
- `@dependabot ignore this dependency` will close this PR and stop Dependabot creating any more for this dependency (unless you reopen the PR or upgrade to it yourself)
- `@dependabot use these labels` will set the current labels as the default for future PRs for this repo and language
- `@dependabot use these reviewers` will set the current reviewers as the default for future PRs for this repo and language
- `@dependabot use these assignees` will set the current assignees as the default for future PRs for this repo and language
- `@dependabot use this milestone` will set the current milestone as the default for future PRs for this repo and language

You can disable automated security fix PRs for this repo from the [Security Alerts page](https://github.com/mozilla/mozilla-schema-generator/network/alerts).

</details>",dependabot[bot],49699333,2021-03-25T22:32:26Z,NONE,False,1,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,dff90f0545213d511b827c0229571295c3aa5762,"Bump pyyaml from 4.2b1 to 5.4 in /requirements

Bumps [pyyaml](https://github.com/yaml/pyyaml) from 4.2b1 to 5.4.
- [Release notes](https://github.com/yaml/pyyaml/releases)
- [Changelog](https://github.com/yaml/pyyaml/blob/master/CHANGES)
- [Commits](https://github.com/yaml/pyyaml/commits/5.4)

Signed-off-by: dependabot[bot] <support@github.com>"
7,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/186,186,Fix broken glean ping tests,"Tests were broken via https://github.com/mozilla/probe-scraper/pull/285 (in particular [the removal of the glean app](https://github.com/mozilla/probe-scraper/pull/285/files#diff-a039c9b63812e8c69d4ad7a53ccb7c5b15f3721aadca48e869ca5653fa7b4229L38-L51)). This also caused related issues filed in https://github.com/mozilla/probe-scraper/issues/293.

While schema generation itself was fine, this broke some of the existing tests that relied on the `glean` application name. This is blocking automatic deploys to dockerhub (e.g. #185).

```
E           requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://probeinfo.telemetry.mozilla.org/glean/glean/pings?t=2021-03-23T18:05:21.174148
```

See: https://app.circleci.com/pipelines/github/mozilla/mozilla-schema-generator/856/workflows/8aa6093e-eeeb-4de9-98d9-ed9328898d69/jobs/1298

This points the default library to `glean-core` and updates the tests appropriately. 

See https://github.com/mozilla-services/mozilla-pipeline-schemas/commit/35b792efc81ab948469c2b043e38d539bc4e736d for a commit while debugging this test failure, which ran without incompatible issues.
",acmiyaguchi,3304040,2021-03-23T19:24:27Z,COLLABORATOR,True,3,3,2,A library for creating full representations of Mozilla telemetry pings.,Python,ba9622dac07378c1e657ecdaedcf887df5b3eb96,Fix broken glean ping tests
8,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/185,185,Bug 1697602 Remove configs for account-ecosystem pings,"See https://bugzilla.mozilla.org/show_bug.cgi?id=1697602

Marking as draft, as this must not be merged until https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/664 is merged to remove the associated base JSON schemas.",jklukas,691060,2021-03-15T19:52:22Z,CONTRIBUTOR,True,4,27,3,A library for creating full representations of Mozilla telemetry pings.,Python,a899ca0d0bcbaeccf8de318ca0f1387f43b566f9,"Bug 1697602 Remove configs for account-ecosystem pings

See https://bugzilla.mozilla.org/show_bug.cgi?id=1697602"
9,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/185,185,Bug 1697602 Remove configs for account-ecosystem pings,"See https://bugzilla.mozilla.org/show_bug.cgi?id=1697602

Marking as draft, as this must not be merged until https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/664 is merged to remove the associated base JSON schemas.",jklukas,691060,2021-03-15T19:52:22Z,CONTRIBUTOR,True,4,27,3,A library for creating full representations of Mozilla telemetry pings.,Python,6b1117f9d57080f60e7b3103f39ae179002ffd06,Allow incompatibility
10,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/184,184,Bug 1688633 Increase column default_max_size,See https://bugzilla.mozilla.org/show_bug.cgi?id=1688633 for context,jklukas,691060,2021-03-08T14:27:36Z,CONTRIBUTOR,True,1,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,daa02a7799c5bed618dadd0a205d2484fdb2a4e8,"Bug 1688633 Increase column default_max_size

See https://bugzilla.mozilla.org/show_bug.cgi?id=1688633 for context"
11,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/184,184,Bug 1688633 Increase column default_max_size,See https://bugzilla.mozilla.org/show_bug.cgi?id=1688633 for context,jklukas,691060,2021-03-08T14:27:36Z,CONTRIBUTOR,True,1,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,92ef0eea04142612d8333003fd5364cf7475409a,Merge branch 'main' into col-limit-increase
12,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/182,182,Bug 1695795: Remove unused Glean metric types,Related to https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/662,mdboom,38294,2021-03-02T22:07:15Z,CONTRIBUTOR,True,0,84,1,A library for creating full representations of Mozilla telemetry pings.,Python,9431f54f7f376527519a29ef1e0c179dd700d1bd,Bug 1695795: Remove unused Glean metric types
13,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/182,182,Bug 1695795: Remove unused Glean metric types,Related to https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/662,mdboom,38294,2021-03-02T22:07:15Z,CONTRIBUTOR,True,0,84,1,A library for creating full representations of Mozilla telemetry pings.,Python,6f7409481ade30be8a9617df20277d0304167172,Merge branch 'main' into remove-unused-glean-metric-types
14,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/180,180,Reduce verbosity when setting up git/ssh,,acmiyaguchi,3304040,2021-02-09T00:59:23Z,COLLABORATOR,True,2,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,b8fd3e5c86651bdc53604944eebb7fd987fbbd39,Reduce verbosity when setting up git/ssh
15,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/179,179,Fix location of incompatibility allowlist,"Followup to #178.

This sets the correct location of the incompatibility allowlist.  I see the following in test logs after applying the patch.

```
allowing incompatible changes in the following documents:
        glean-js-tmp.events.1.txt
        glean-js-tmp.baseline.1.txt
        glean-js-tmp.deletion-request.1.txt
        glean-js-tmp.metrics.1.txt
```

I also echo the installed package of msg for good measure at the beginning of the script, because it doesn't look like airflow gives the hash of the container being run(?). 

```
git+git@github.com:mozilla/mozilla-schema-generator.git@af8c45676f3d9203f9a18875834aa219a61061f1#egg=mozilla_schema_generator
```",acmiyaguchi,3304040,2021-02-09T00:31:09Z,COLLABORATOR,True,4,1,2,A library for creating full representations of Mozilla telemetry pings.,Python,7b422ca7b77a14a9e1ad1ff3441faeeaf17813dd,Add correct location of incompatibility-allowlist
16,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/179,179,Fix location of incompatibility allowlist,"Followup to #178.

This sets the correct location of the incompatibility allowlist.  I see the following in test logs after applying the patch.

```
allowing incompatible changes in the following documents:
        glean-js-tmp.events.1.txt
        glean-js-tmp.baseline.1.txt
        glean-js-tmp.deletion-request.1.txt
        glean-js-tmp.metrics.1.txt
```

I also echo the installed package of msg for good measure at the beginning of the script, because it doesn't look like airflow gives the hash of the container being run(?). 

```
git+git@github.com:mozilla/mozilla-schema-generator.git@af8c45676f3d9203f9a18875834aa219a61061f1#egg=mozilla_schema_generator
```",acmiyaguchi,3304040,2021-02-09T00:31:09Z,COLLABORATOR,True,4,1,2,A library for creating full representations of Mozilla telemetry pings.,Python,af8c45676f3d9203f9a18875834aa219a61061f1,Echo msg version on run
17,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/179,179,Fix location of incompatibility allowlist,"Followup to #178.

This sets the correct location of the incompatibility allowlist.  I see the following in test logs after applying the patch.

```
allowing incompatible changes in the following documents:
        glean-js-tmp.events.1.txt
        glean-js-tmp.baseline.1.txt
        glean-js-tmp.deletion-request.1.txt
        glean-js-tmp.metrics.1.txt
```

I also echo the installed package of msg for good measure at the beginning of the script, because it doesn't look like airflow gives the hash of the container being run(?). 

```
git+git@github.com:mozilla/mozilla-schema-generator.git@af8c45676f3d9203f9a18875834aa219a61061f1#egg=mozilla_schema_generator
```",acmiyaguchi,3304040,2021-02-09T00:31:09Z,COLLABORATOR,True,4,1,2,A library for creating full representations of Mozilla telemetry pings.,Python,489d2e3218529bfca87a08d01b65bd9197c4c35e,Remove exists=True condition
18,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/178,178,Bug 1689513 - allow deletion of glean-js-tmp,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1689513)

#176 used the normalized namespace, instead of the actual namespace name in mozilla-pipeline-schemas.  As per airflow failures:

```
[2021-02-08 23:22:31,455] {pod_launcher.py:156} INFO - b'items removed from the base\n'
[2021-02-08 23:22:31,456] {pod_launcher.py:156} INFO - b'-glean-js-tmp.metrics.1.txt\n'
[2021-02-08 23:22:31,456] {pod_launcher.py:156} INFO - b'-glean-js-tmp.deletion-request.1.txt\n'
[2021-02-08 23:22:31,456] {pod_launcher.py:156} INFO - b'-glean-js-tmp.events.1.txt\n'
[2021-02-08 23:22:31,456] {pod_launcher.py:156} INFO - b'-glean-js-tmp.baseline.1.txt\n'
[2021-02-08 23:22:31,456] {pod_launcher.py:156} INFO - b'\n'
[2021-02-08 23:22:31,457] {pod_launcher.py:156} INFO - b'found incompatible changes\n'
```
",acmiyaguchi,3304040,2021-02-08T23:44:04Z,COLLABORATOR,True,1,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,656a71e9d7cf31c88b8070290d7bb3caf99fd575,Bug 1689513 - allow deletion of glean-js-tmp
19,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/177,177,master -> main,,fbertsch,20819040,2021-02-04T14:29:55Z,COLLABORATOR,True,9,9,3,A library for creating full representations of Mozilla telemetry pings.,Python,318df83473b60f1a5101c19c5640dab629ce02f8,master -> main
20,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/177,177,master -> main,,fbertsch,20819040,2021-02-04T14:29:55Z,COLLABORATOR,True,9,9,3,A library for creating full representations of Mozilla telemetry pings.,Python,a0e24b2f0c9ce4f7288f8fdf0c7af42da2890204,Update Dockerflow reference
21,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/176,176,Bug 1689513 - Allow glean_js_tmp drop,See https://github.com/mozilla/probe-scraper/pull/266,fbertsch,20819040,2021-01-29T01:52:27Z,COLLABORATOR,True,3,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,f7c96616d10fba4978fba32a6a5110e0c24e3b07,Allow glean_js_tmp drop
22,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/176,176,Bug 1689513 - Allow glean_js_tmp drop,See https://github.com/mozilla/probe-scraper/pull/266,fbertsch,20819040,2021-01-29T01:52:27Z,COLLABORATOR,True,3,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,0e18c648512fc78a4bdfcd44cf6068a6eaecc923,Add bug number
23,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/175,175,Bug 1688633 Bump max number of fields 9900 -> 10000,See https://bugzilla.mozilla.org/show_bug.cgi?id=1688633,jklukas,691060,2021-01-25T14:46:26Z,CONTRIBUTOR,True,1,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,2764c4fcc6d1620f8f1422bfc4d8afb611d5af34,"Bug 1688633 Bump max number of fields 9900 -> 10000

See https://bugzilla.mozilla.org/show_bug.cgi?id=1688633"
24,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/174,174,Remove commit section in README,"I was thinking about https://github.com/mozilla/mozilla-schema-generator/issues/172 more. Even if we limit to the last N commits in the README in #173, there will still be no-op commits with changes to MPS that don't affect schemas (e.g. documentation or CI changes). If we want more detailed information, we should look to the commit log or the deploy dashboard for this.",acmiyaguchi,3304040,2021-01-05T19:37:15Z,COLLABORATOR,True,0,6,1,A library for creating full representations of Mozilla telemetry pings.,Python,a18b8d1ebbdf1c87f3f9385f45bb31680e6eca7e,Remove commit section in README
25,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/173,173,Only include last N commits in generated-schemas README,"Fixes #172

Not tied to this approach, just putting this forward as an alternative.",fbertsch,20819040,2021-01-05T14:27:38Z,COLLABORATOR,True,2,4,1,A library for creating full representations of Mozilla telemetry pings.,Python,add61902ef42f1faf90c7c780a96b9c4e3b6dfdb,"Only include last N commits in generated-schemas README

Fixes #172"
26,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/173,173,Only include last N commits in generated-schemas README,"Fixes #172

Not tied to this approach, just putting this forward as an alternative.",fbertsch,20819040,2021-01-05T14:27:38Z,COLLABORATOR,True,2,4,1,A library for creating full representations of Mozilla telemetry pings.,Python,2aeedd818dc709502bfa99b4e3172873bb2b0260,Remove use of head
27,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/173,173,Only include last N commits in generated-schemas README,"Fixes #172

Not tied to this approach, just putting this forward as an alternative.",fbertsch,20819040,2021-01-05T14:27:38Z,COLLABORATOR,True,2,4,1,A library for creating full representations of Mozilla telemetry pings.,Python,a23ffb97dfd2546ee6ff208cacb3bfbe626e307d,"Update bin/generate_commit

Co-authored-by: whd <whd@users.noreply.github.com>"
28,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/171,171,Fix #102 - Add readme for generated-schemas branch,This fixes #102 and builds on a contribution from #165. The output can be found here: https://github.com/mozilla-services/mozilla-pipeline-schemas/tree/test-generated-schemas#mozilla-pipeline-schemas-generated-schemas,acmiyaguchi,3304040,2020-12-21T22:22:34Z,COLLABORATOR,True,32,3,2,A library for creating full representations of Mozilla telemetry pings.,Python,a4865a6101c3e6a4e769b79db7f943669a260c5a,Add readme for schemas
29,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/171,171,Fix #102 - Add readme for generated-schemas branch,This fixes #102 and builds on a contribution from #165. The output can be found here: https://github.com/mozilla-services/mozilla-pipeline-schemas/tree/test-generated-schemas#mozilla-pipeline-schemas-generated-schemas,acmiyaguchi,3304040,2020-12-21T22:22:34Z,COLLABORATOR,True,32,3,2,A library for creating full representations of Mozilla telemetry pings.,Python,8f01f53add3c98788594a25d089baff01ed7cd97,use cat instea dof echo
30,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/171,171,Fix #102 - Add readme for generated-schemas branch,This fixes #102 and builds on a contribution from #165. The output can be found here: https://github.com/mozilla-services/mozilla-pipeline-schemas/tree/test-generated-schemas#mozilla-pipeline-schemas-generated-schemas,acmiyaguchi,3304040,2020-12-21T22:22:34Z,COLLABORATOR,True,32,3,2,A library for creating full representations of Mozilla telemetry pings.,Python,f874f2d384dc0a3d46c91a38c84eed6d650945b8,ADD tree
31,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/171,171,Fix #102 - Add readme for generated-schemas branch,This fixes #102 and builds on a contribution from #165. The output can be found here: https://github.com/mozilla-services/mozilla-pipeline-schemas/tree/test-generated-schemas#mozilla-pipeline-schemas-generated-schemas,acmiyaguchi,3304040,2020-12-21T22:22:34Z,COLLABORATOR,True,32,3,2,A library for creating full representations of Mozilla telemetry pings.,Python,47b67a8f500df2f8a65056d1f33b207b37105af1,Update generated README
32,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/171,171,Fix #102 - Add readme for generated-schemas branch,This fixes #102 and builds on a contribution from #165. The output can be found here: https://github.com/mozilla-services/mozilla-pipeline-schemas/tree/test-generated-schemas#mozilla-pipeline-schemas-generated-schemas,acmiyaguchi,3304040,2020-12-21T22:22:34Z,COLLABORATOR,True,32,3,2,A library for creating full representations of Mozilla telemetry pings.,Python,48610885a0e4e6ea67199dac7b270eaf08ca809b,Update format of readme
33,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/170,170,Bug 1682627 - Support propagating schema incompatible changes,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1682627)

This adds support for a incompatibility-allowlist that allows for deletions or schema incompatible changes. This is done by omitting the document from the base revision. The entries only need to exist in the allowlist for the single commit (and should probably be removed afterwards). 

",acmiyaguchi,3304040,2020-12-18T21:26:39Z,COLLABORATOR,True,214,4,4,A library for creating full representations of Mozilla telemetry pings.,Python,f5e87cf1286cd330684df4cc524dbc2cbe7bd17c,Add deletion-allowlist for schemas with glob matching
34,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/170,170,Bug 1682627 - Support propagating schema incompatible changes,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1682627)

This adds support for a incompatibility-allowlist that allows for deletions or schema incompatible changes. This is done by omitting the document from the base revision. The entries only need to exist in the allowlist for the single commit (and should probably be removed afterwards). 

",acmiyaguchi,3304040,2020-12-18T21:26:39Z,COLLABORATOR,True,214,4,4,A library for creating full representations of Mozilla telemetry pings.,Python,ad5c2e9d4292855453d8aba3f524ac61510c2880,Add an empty deletion-allowlist for validation
35,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/170,170,Bug 1682627 - Support propagating schema incompatible changes,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1682627)

This adds support for a incompatibility-allowlist that allows for deletions or schema incompatible changes. This is done by omitting the document from the base revision. The entries only need to exist in the allowlist for the single commit (and should probably be removed afterwards). 

",acmiyaguchi,3304040,2020-12-18T21:26:39Z,COLLABORATOR,True,214,4,4,A library for creating full representations of Mozilla telemetry pings.,Python,1026a3b535fa279981e836f13c40e4fd3bdda55e,Set config for commits in CI
36,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/170,170,Bug 1682627 - Support propagating schema incompatible changes,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1682627)

This adds support for a incompatibility-allowlist that allows for deletions or schema incompatible changes. This is done by omitting the document from the base revision. The entries only need to exist in the allowlist for the single commit (and should probably be removed afterwards). 

",acmiyaguchi,3304040,2020-12-18T21:26:39Z,COLLABORATOR,True,214,4,4,A library for creating full representations of Mozilla telemetry pings.,Python,461afcf44990e58e1df071a9fab3c6c48866de2f,Allow for incompatible column changes
37,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/170,170,Bug 1682627 - Support propagating schema incompatible changes,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1682627)

This adds support for a incompatibility-allowlist that allows for deletions or schema incompatible changes. This is done by omitting the document from the base revision. The entries only need to exist in the allowlist for the single commit (and should probably be removed afterwards). 

",acmiyaguchi,3304040,2020-12-18T21:26:39Z,COLLABORATOR,True,214,4,4,A library for creating full representations of Mozilla telemetry pings.,Python,aad3fa65fc3447853b10bc1318a79ab7959f5589,Merge branch 'master' into delete-pings
38,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/170,170,Bug 1682627 - Support propagating schema incompatible changes,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1682627)

This adds support for a incompatibility-allowlist that allows for deletions or schema incompatible changes. This is done by omitting the document from the base revision. The entries only need to exist in the allowlist for the single commit (and should probably be removed afterwards). 

",acmiyaguchi,3304040,2020-12-18T21:26:39Z,COLLABORATOR,True,214,4,4,A library for creating full representations of Mozilla telemetry pings.,Python,9d68783b3bd5a4fdef8049185cd23f5d98c805c0,Add documentation on incompatibility-allowlist
39,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/169,169,[Bug 1682368] Common ping sections for uninstall and dns_study_v1,https://bugzilla.mozilla.org/show_bug.cgi?id=1682368,scholtzan,1239705,2020-12-18T20:23:42Z,CONTRIBUTOR,True,6,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,fd1f14f12a0b83aac3006aa5eb102468b68fa244,[Bug 1682368] Common ping sections for uninstall and dns_study_v1
40,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/168,168,Bug 1675103 - Set `payload.hangs[].stack` to string in telemetry.bhr.4,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1675103)

This is a followup to https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/636 and sets `payload.hangs[].stack` to a string so it will be included in the BigQuery table as a json string. ",acmiyaguchi,3304040,2020-12-07T21:27:05Z,COLLABORATOR,True,95,78,12,A library for creating full representations of Mozilla telemetry pings.,Python,1297a6e787b106fc86475f4f3866c128632efbc3,Add bhr ping schema generator
41,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/168,168,Bug 1675103 - Set `payload.hangs[].stack` to string in telemetry.bhr.4,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1675103)

This is a followup to https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/636 and sets `payload.hangs[].stack` to a string so it will be included in the BigQuery table as a json string. ",acmiyaguchi,3304040,2020-12-07T21:27:05Z,COLLABORATOR,True,95,78,12,A library for creating full representations of Mozilla telemetry pings.,Python,c8e54e4da9547e2c358315a4d7a2b3de1d5c990e,Format files with black to pass `make lint`
42,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/166,166,Bug 1672448 Persist Glean retention_days setting to generated schema,"This translates the `retention_days` setting from Glean repositories.yaml
to `mozPipelineMetadata.expiration_policy.delete_after_days` in all generated
JSON schemas for the application.

We will need a further step in the ops logic to act on this schema-level
metadata, setting the appropriate table-level retention policy in BQ.",jklukas,691060,2020-11-02T18:35:36Z,CONTRIBUTOR,True,48,35,4,A library for creating full representations of Mozilla telemetry pings.,Python,1c8db717dd073dfd1a9ef8d9109ce49ea9174e57,"Bug 1672448 Persist Glean retention_days setting to generated schema

This translates the `retention_days` setting from Glean repositories.yaml
to `mozPipelineMetadata.expiration_policy.delete_after_days` in all generated
JSON schemas for the application.

We will need a further step in the ops logic to act on this schema-level
metadata, setting the appropriate table-level retention policy in BQ."
43,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/166,166,Bug 1672448 Persist Glean retention_days setting to generated schema,"This translates the `retention_days` setting from Glean repositories.yaml
to `mozPipelineMetadata.expiration_policy.delete_after_days` in all generated
JSON schemas for the application.

We will need a further step in the ops logic to act on this schema-level
metadata, setting the appropriate table-level retention policy in BQ.",jklukas,691060,2020-11-02T18:35:36Z,CONTRIBUTOR,True,48,35,4,A library for creating full representations of Mozilla telemetry pings.,Python,80180f1c8a5a8991a2e814b6564a2f313b99e6f0,Run black
44,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/166,166,Bug 1672448 Persist Glean retention_days setting to generated schema,"This translates the `retention_days` setting from Glean repositories.yaml
to `mozPipelineMetadata.expiration_policy.delete_after_days` in all generated
JSON schemas for the application.

We will need a further step in the ops logic to act on this schema-level
metadata, setting the appropriate table-level retention policy in BQ.",jklukas,691060,2020-11-02T18:35:36Z,CONTRIBUTOR,True,48,35,4,A library for creating full representations of Mozilla telemetry pings.,Python,9114b61a119f31f1a2b7ed0999a057a4d0b4af3c,Update test_glean
45,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/166,166,Bug 1672448 Persist Glean retention_days setting to generated schema,"This translates the `retention_days` setting from Glean repositories.yaml
to `mozPipelineMetadata.expiration_policy.delete_after_days` in all generated
JSON schemas for the application.

We will need a further step in the ops logic to act on this schema-level
metadata, setting the appropriate table-level retention policy in BQ.",jklukas,691060,2020-11-02T18:35:36Z,CONTRIBUTOR,True,48,35,4,A library for creating full representations of Mozilla telemetry pings.,Python,07dad255da7e778444fa7a5974819d3accfa23cc,test typo
46,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/166,166,Bug 1672448 Persist Glean retention_days setting to generated schema,"This translates the `retention_days` setting from Glean repositories.yaml
to `mozPipelineMetadata.expiration_policy.delete_after_days` in all generated
JSON schemas for the application.

We will need a further step in the ops logic to act on this schema-level
metadata, setting the appropriate table-level retention policy in BQ.",jklukas,691060,2020-11-02T18:35:36Z,CONTRIBUTOR,True,48,35,4,A library for creating full representations of Mozilla telemetry pings.,Python,54cfb76edfe43f157d46bbefe4df8734a99ded0d,Bump version to 0.3.0
47,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/166,166,Bug 1672448 Persist Glean retention_days setting to generated schema,"This translates the `retention_days` setting from Glean repositories.yaml
to `mozPipelineMetadata.expiration_policy.delete_after_days` in all generated
JSON schemas for the application.

We will need a further step in the ops logic to act on this schema-level
metadata, setting the appropriate table-level retention policy in BQ.",jklukas,691060,2020-11-02T18:35:36Z,CONTRIBUTOR,True,48,35,4,A library for creating full representations of Mozilla telemetry pings.,Python,674579d47cdccae5d1ad86cadad9aafcfea5ab7f,Add test_retention_days
48,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/165,165,Add readme for schemas,"Resolve: https://github.com/mozilla/mozilla-schema-generator/issues/102
",JoyLubega,29824008,2020-10-21T08:34:09Z,CONTRIBUTOR,False,36,5,2,A library for creating full representations of Mozilla telemetry pings.,Python,a40a511268b6a04870a330f2742b74d7dc1219e4,Add readme for schemas
49,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/165,165,Add readme for schemas,"Resolve: https://github.com/mozilla/mozilla-schema-generator/issues/102
",JoyLubega,29824008,2020-10-21T08:34:09Z,CONTRIBUTOR,False,36,5,2,A library for creating full representations of Mozilla telemetry pings.,Python,56c36e9a7813a9ba95f6c01a802db13016265e6c,use cat instea dof echo
50,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/165,165,Add readme for schemas,"Resolve: https://github.com/mozilla/mozilla-schema-generator/issues/102
",JoyLubega,29824008,2020-10-21T08:34:09Z,CONTRIBUTOR,False,36,5,2,A library for creating full representations of Mozilla telemetry pings.,Python,c295bdf14f159bbcbeeab8388c13fa89bddade89,ADD tree
51,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/164,164,Added linting with isort and black,"This PR fixes #162 

- Added isort to format imports
- Added black to format code",DawoodShahat,19612755,2020-10-18T07:33:43Z,CONTRIBUTOR,True,738,645,27,A library for creating full representations of Mozilla telemetry pings.,Python,f81909206d494e5bf513516e6d67ec7cecc19500,added_linting_isort_black
52,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/164,164,Added linting with isort and black,"This PR fixes #162 

- Added isort to format imports
- Added black to format code",DawoodShahat,19612755,2020-10-18T07:33:43Z,CONTRIBUTOR,True,738,645,27,A library for creating full representations of Mozilla telemetry pings.,Python,623d121858fbd75db493efab86ba071f65ac4fb4,lint_before_tests
53,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/164,164,Added linting with isort and black,"This PR fixes #162 

- Added isort to format imports
- Added black to format code",DawoodShahat,19612755,2020-10-18T07:33:43Z,CONTRIBUTOR,True,738,645,27,A library for creating full representations of Mozilla telemetry pings.,Python,44ff631987ee7cadd6a1972741c233a6591686c0,make_isort_black_compatible
54,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/164,164,Added linting with isort and black,"This PR fixes #162 

- Added isort to format imports
- Added black to format code",DawoodShahat,19612755,2020-10-18T07:33:43Z,CONTRIBUTOR,True,738,645,27,A library for creating full representations of Mozilla telemetry pings.,Python,dd8cfcea7ae2d9d4eda2bdcdaaa11a31a5ceb39b,codebase_formatted
55,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/164,164,Added linting with isort and black,"This PR fixes #162 

- Added isort to format imports
- Added black to format code",DawoodShahat,19612755,2020-10-18T07:33:43Z,CONTRIBUTOR,True,738,645,27,A library for creating full representations of Mozilla telemetry pings.,Python,9d2c0018086bda496b0e5a17204b3851bfac7aab,added_autoflake
56,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/164,164,Added linting with isort and black,"This PR fixes #162 

- Added isort to format imports
- Added black to format code",DawoodShahat,19612755,2020-10-18T07:33:43Z,CONTRIBUTOR,True,738,645,27,A library for creating full representations of Mozilla telemetry pings.,Python,394a2c7ca3b994478328ffe5fac8167c4b7ed7fa,Merge branch 'master' into add_isort_black_linting
57,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/164,164,Added linting with isort and black,"This PR fixes #162 

- Added isort to format imports
- Added black to format code",DawoodShahat,19612755,2020-10-18T07:33:43Z,CONTRIBUTOR,True,738,645,27,A library for creating full representations of Mozilla telemetry pings.,Python,60b5a36d3350c47daf797172b90b17d4d538a76d,Update Makefile
58,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/163,163,Remove redundant conditional,,DawoodShahat,19612755,2020-10-17T19:17:21Z,CONTRIBUTOR,True,0,3,1,A library for creating full representations of Mozilla telemetry pings.,Python,34c4a31313d7d988e7bc7102570cf7dec3393e22,remove redundant conditional
59,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/161,161,Set default branch in commands to track mozilla-pipeline-schemas,This fixes #160 by setting the default branch to `master`. The `__main__` entrypoint is formatted and refactored so the default is set in a single place.,acmiyaguchi,3304040,2020-10-15T19:08:25Z,COLLABORATOR,True,116,148,1,A library for creating full representations of Mozilla telemetry pings.,Python,5537bbe93823959892f79f42bf56963e845c0059,Format __main__ with black and isort
60,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/161,161,Set default branch in commands to track mozilla-pipeline-schemas,This fixes #160 by setting the default branch to `master`. The `__main__` entrypoint is formatted and refactored so the default is set in a single place.,acmiyaguchi,3304040,2020-10-15T19:08:25Z,COLLABORATOR,True,116,148,1,A library for creating full representations of Mozilla telemetry pings.,Python,8e2c413cf5e00d82d2e775fa82fe251b9a672cec,Refactor common options into a separate decorator
61,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/161,161,Set default branch in commands to track mozilla-pipeline-schemas,This fixes #160 by setting the default branch to `master`. The `__main__` entrypoint is formatted and refactored so the default is set in a single place.,acmiyaguchi,3304040,2020-10-15T19:08:25Z,COLLABORATOR,True,116,148,1,A library for creating full representations of Mozilla telemetry pings.,Python,a4658de30a642abfbade59e4613d6d8356c6694c,Fix #160 - Set default branch to master in commands
62,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/158,158,Use glean-core as default dependency,"At this point, there are no repositories using the default dependency, so this shouldn't change anything.",fbertsch,20819040,2020-10-14T13:19:53Z,COLLABORATOR,False,1,2,1,A library for creating full representations of Mozilla telemetry pings.,Python,d1bca2ddd86f5cbaa6ffa88e09da16a66a52598b,Remove ignore_pings in favor of pings.yaml
63,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/158,158,Use glean-core as default dependency,"At this point, there are no repositories using the default dependency, so this shouldn't change anything.",fbertsch,20819040,2020-10-14T13:19:53Z,COLLABORATOR,False,1,2,1,A library for creating full representations of Mozilla telemetry pings.,Python,8990390e019ea1bfe68d235bca86a62a708033e7,Use glean-core as default dependency
64,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/157,157,Add MPS_VALIDATE_BQ env var to allow disabling validation,"When making changes to this repo, the testing workflow may involve pushing
changes to test-generated-schemas, and then needing to walk them back.

This PR adds a new environment variable that can be set to ""false"" to disable
the validation step and allow exploration with pushing to branches like
test-generated-schemas.",jklukas,691060,2020-10-09T20:28:30Z,CONTRIBUTOR,True,9,3,2,A library for creating full representations of Mozilla telemetry pings.,Python,3c337dadf398289323425bce14088b3350ce1862,"Add MPS_VALIDATE_BQ env var to allow disabling validation

When making changes to this repo, the testing workflow may involve pushing
changes to test-generated-schemas, and then needing to walk them back.

This PR adds a new environment variable that can be set to ""false"" to disable
the validation step and allow exploration with pushing to branches like
test-generated-schemas."
65,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,3f66665ac1b0e88967f78d8951fe09e9c68ca596,Move logic into a generate function
66,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,a2759e7c613c60789d9da302a1644b19e07d00d4,Refactor assumptions about current directory and format long commands
67,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,290bd65f1555bfb42d8991b7710119b7bf6d3895,Add commands for generating diffs between schemas
68,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,f8d67ac071c45babad40d520f14f47154f492d73,Refactor schema_generator scripts for reusability
69,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,4f0ee1519d5e51ca0e9d5c9939286714d524256c,Fix script for successful push; add call to realpath breaking mac compat
70,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,1dbbbb1cae295839069530a848f1d6accf96cd71,Consolidate helpers in generate_commit
71,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,bdf6002c2a11661b594354c6a11f7b86d0b44a12,Add initial testing script for validating
72,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,f0aaf9a5764380b3464018aa9525a9b6f3697d5f,Add ability to change base branch
73,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,cf5242c50243a5c109331e0c44eb94badb981e4d,Update formatting of diffs
74,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,e6c9694ea69004b1750d30cfec3e1912c9097aed,Move validation logic into main script
75,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,7cf55a4d88f7588f79cf3a6e78d524abe27fd3d5,Add comments and make some functions private (by convention)
76,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,f94dcf76eb75a6afb1d3339da56e82650b075d80,Move validate_bigquery script into schema generator
77,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,0b08db35decb63f3bfbee0422acc74dd28588623,Add mozilla-pipeline-schemas submodule for testing
78,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,bb934e0d8e4604bc50382602ac95a918d1079a8f,Ensure mps is on the generated-schemas branch
79,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,422c48b5dc7a78e24ee8b5e8afcc255d429bc094,Add tests for validate_bigquery
80,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,2a3f52cd65d2e0b080e6dfadb23ac3a52630e17b,Update main script for validate-bigquery local-validation
81,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,97224fbeb4bf7b35f727f2323e25216543f6cbc5,Pull submodule for testing
82,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,202855ca00f8025b4f7711864a0e4f04678cb3a3,Set the default branch for the submodule
83,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,dec3629355b30d1a431a02d8ad74e2ebde4ce9ce,Add directions for initializing submodule for tests
84,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,f6a4f9f64b94aba4123b245ec0ba004fb3edfdfc,Checkout master branch before local clone
85,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,4d1d27bb77b5664b732d56fc6594eaa43f630e0f,Use HEAD instead of head
86,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,88bc5ecbc470b5fbd92d5b6e3f2fab69bce4a287,Fix linting errors
87,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,a09ad321c9cbfe51811eca3737c85d3b7f6681a6,"Update mozilla_schema_generator/validate_bigquery.py

Co-authored-by: Frank Bertsch <fbertsch@mozilla.com>"
88,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/156,156,Bug 1666608 - Check for schema incompatibilities before pushing,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1666608)

This also fixes #74.

This adds an extra validation step before pushing schemas to `generated-schemas`. The basis of this is to generate a compact set of columns on the generated BigQuery schemas to determine if any columns are removed. This also refactors the main script for reusable components while developing this.

My testing workflow so far is something like this:

```bash
docker-compose run -v $PWD:/app/mozilla-schema-generator --entrypoint /bin/bash app
source mozilla-schema-generator/bin/schema_generator.sh
# -e causes the container to exit immediately
set +e
setup_git
setup_mps
mozilla-schema-generator/bin/test_validate master
mozilla-schema-generator/bin/test_validate master~5
```

The `test_validate` runs the following command with some output:

<details>
<summary>Click to expand</summary>

```diff
items removed from the base
-telemetry.android-anr-report.9.txt
-telemetry.android-anr-report.6.txt
-telemetry.android-anr-report.4.txt
-telemetry.android-anr-report.3.txt
-telemetry.android-anr-report.10.txt
-telemetry.android-anr-report.2.txt
-telemetry.android-anr-report.5.txt
-telemetry.android-anr-report.1.txt
-telemetry.android-anr-report.7.txt
-telemetry.android-anr-report.8.txt

items added to the base
+activity-stream.on-save-recs.1.txt
+pioneer-core.probes.1.txt
+pioneer-debug.pioneer-enrollment.1.txt
+pioneer-core.deletion-request.1.txt
+pioneer-core.pioneer-enrollment.1.txt
+pioneer-core.survey.1.txt
+pioneer-meta.pioneer-enrollment.1.txt

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-launcher-process.launcher-process-failure.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-launcher-process.launcher-process-failure.1.txt
@@ -8,2 +8,3 @@
root.is_admin_without_uac BOOL
+root.launcher_error.detour_orig_bytes STRING
root.launcher_error.hresult INT64

--- /app/validate_schema_evolution/6be65fba320440a7c479d38e3df66931a639be56_base-revision/firefox-accounts.account-ecosystem.1.txt
+++ /app/validate_schema_evolution/998a2ea5e691ff2cb33d8c604c1e22e341f60386_test-generated-schemas/firefox-accounts.account-ecosystem.1.txt
@@ -1,2 +1,3 @@
root.additional_properties STRING
+root.country STRING
root.document_id STRING
@@ -4,2 +5,3 @@
root.ecosystem_user_id STRING
+root.event STRING
root.metadata.geo.city STRING
@@ -25,3 +27,5 @@
root.normalized_os_version STRING
+root.oauth_client_id STRING
root.previous_ecosystem_user_ids.[] STRING
+root.region STRING
root.sample_id INT64

found incompatible changes
```
</details>

Running the following command generates the following logs:

```
mozilla-schema-generator/bin/test_validate master generated-schemas generated-schemas~5
```

<details>
<summary>Click to expand</summary>

```diff
--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.main.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.main.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.saved-session.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.saved-session.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/firefox-desktop.metrics.1.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/firefox-desktop.metrics.1.txt
@@ -65,2 +65,4 @@
root.metrics.string.ping_reason STRING
+root.metrics.timespan.fog_initialization.time_unit STRING
+root.metrics.timespan.fog_initialization.value INT64
root.normalized_app_name STRING

--- /app/validate_schema_evolution/55863c2f2c9428bf2a5d29f4c5090daac9e75484_base-revision/telemetry.first-shutdown.4.txt
+++ /app/validate_schema_evolution/485be1e70334be6b858b522c354f3487a9c05b3d_generated-schemas/telemetry.first-shutdown.4.txt
@@ -970,3 +970,8 @@
root.payload.histograms.http2_fail_before_settings STRING
+root.payload.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.histograms.http3_request_per_conn STRING
+root.payload.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.histograms.http3_timer_delayed STRING
+root.payload.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.histograms.http_09_info STRING
@@ -3396,2 +3401,6 @@
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -4378,2 +4387,4 @@
root.payload.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -5270,3 +5281,8 @@
root.payload.processes.content.histograms.htmleditors_with_resizers STRING
+root.payload.processes.content.histograms.http3_blocked_by_stream_limit_per_conn STRING
root.payload.processes.content.histograms.http3_request_per_conn STRING
+root.payload.processes.content.histograms.http3_sending_blocked_by_flow_control_per_trans STRING
+root.payload.processes.content.histograms.http3_timer_delayed STRING
+root.payload.processes.content.histograms.http3_trans_blocked_by_stream_limit_per_conn STRING
+root.payload.processes.content.histograms.http3_trans_sending_blocked_by_flow_control_per_conn STRING
root.payload.processes.content.histograms.http_09_info STRING
@@ -7642,2 +7658,6 @@
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_script_shift_attributes_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptminsize_attribute_page STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_document STRING
+root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_scriptsizemultiplier_attribute_page STRING
root.payload.processes.content.histograms.use_counter2_deprecated_math_ml_deprecated_stixgeneral_operator_stretching_document STRING
@@ -8571,2 +8591,4 @@
root.payload.processes.content.keyed_histograms.http3_connecttion_close_code.[].value STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].key STRING
+root.payload.processes.content.keyed_histograms.http3_time_to_reuse_idle_connecttion_ms.[].value STRING
root.payload.processes.content.keyed_histograms.http_cache_disposition_3.[].key STRING
@@ -8739,2 +8761,4 @@
root.payload.processes.content.keyed_scalars.pictureinpicture_opened_method.[].value INT64
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].key STRING
+root.payload.processes.content.keyed_scalars.printing_paper_size.[].value INT64
root.payload.processes.content.keyed_scalars.telemetry_accumulate_unknown_histogram_keys.[].key STRING
@@ -9184,2 +9208,6 @@
root.payload.processes.parent.keyed_scalars.update_bitshresult.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_bookmarkmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_handoff.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_keywordoffer.[].key STRING
@@ -9192,2 +9220,6 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_shortcut.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabmenu.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_tabtosearch.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_newtab.[].key STRING
@@ -9196,2 +9228,4 @@
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_topsites_urlbar.[].value INT64
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].key STRING
+root.payload.processes.parent.keyed_scalars.urlbar_searchmode_touchbar.[].value INT64
root.payload.processes.parent.keyed_scalars.urlbar_searchmode_typed.[].key STRING
@@ -9401,2 +9435,3 @@
root.payload.processes.parent.scalars.media_blocked_no_metadata_endup_no_audio_track INT64
+root.payload.processes.parent.scalars.media_element_in_page_count INT64
root.payload.processes.parent.scalars.media_page_count INT64

no incompatible changes detected
```
</details>

This generates the following folder in the app route with the corresponding schemas:

```bash
app@4fa21f97c7c0:~$ ls -l /app/validate_schema_evolution
+ ls --color=auto -l /app/validate_schema_evolution
total 228
drwxr-xr-x 2 app app 36864 Oct  7 00:01 18c22f3dc7a195082ab572db49147674b01f45bc_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:59 89ae26322ae3e44105fe4e6fb65b2f0e243a166f_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:58 907d6442ede68ea79032cae0333c2a9f09a38c67_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:57 907d6442ede68ea79032cae0333c2a9f09a38c67_test-generated-schemas
drwxr-xr-x 2 app app 36864 Oct  6 23:56 bac79a33459fcc5084d08e2d3170172ec818f22b_base-revision
drwxr-xr-x 2 app app 36864 Oct  6 23:59 cc5f6746a9385d5d5c03f09575b636a80e557eea_test-generated-schemas
```

This generates a flat folder with BigQuery schemas in them. It should be possible to apply schemas between two revisions to an dataset too.",acmiyaguchi,3304040,2020-10-02T00:15:27Z,COLLABORATOR,True,624,119,11,A library for creating full representations of Mozilla telemetry pings.,Python,59a3878f50286b52297b40484c3b529f044610ba,Bump version to 0.2.0 and add gitpython dependency
89,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/155,155,Copy bq schemas to a bq/ folder,See the ~[new generated content in the test-generated-schemas branch](https://github.com/mozilla-services/mozilla-pipeline-schemas/compare/db283cc5353d516922435d92a2ef12ecda524898...ea7ba2217223ef69248175e27309c285d5a88e48)~ (outdated),jklukas,691060,2020-09-30T17:18:50Z,CONTRIBUTOR,False,103,6,2,A library for creating full representations of Mozilla telemetry pings.,Python,cdb839c363e31d013ab69b489b1778afa452d3ec,Copy bq schemas to a bq/ folder
90,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/155,155,Copy bq schemas to a bq/ folder,See the ~[new generated content in the test-generated-schemas branch](https://github.com/mozilla-services/mozilla-pipeline-schemas/compare/db283cc5353d516922435d92a2ef12ecda524898...ea7ba2217223ef69248175e27309c285d5a88e48)~ (outdated),jklukas,691060,2020-09-30T17:18:50Z,CONTRIBUTOR,False,103,6,2,A library for creating full representations of Mozilla telemetry pings.,Python,c538c9ce360a6714a0caff4fe597e56c00d8c293,Remove exemption for xfocsp-error-report
91,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/155,155,Copy bq schemas to a bq/ folder,See the ~[new generated content in the test-generated-schemas branch](https://github.com/mozilla-services/mozilla-pipeline-schemas/compare/db283cc5353d516922435d92a2ef12ecda524898...ea7ba2217223ef69248175e27309c285d5a88e48)~ (outdated),jklukas,691060,2020-09-30T17:18:50Z,CONTRIBUTOR,False,103,6,2,A library for creating full representations of Mozilla telemetry pings.,Python,8a5377378f1285a045eab8e7c641a8760c48e58a,Delay popd
92,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/155,155,Copy bq schemas to a bq/ folder,See the ~[new generated content in the test-generated-schemas branch](https://github.com/mozilla-services/mozilla-pipeline-schemas/compare/db283cc5353d516922435d92a2ef12ecda524898...ea7ba2217223ef69248175e27309c285d5a88e48)~ (outdated),jklukas,691060,2020-09-30T17:18:50Z,CONTRIBUTOR,False,103,6,2,A library for creating full representations of Mozilla telemetry pings.,Python,1facc618d5750fad0a8ac8853f30832c8774f110,Relative path for symlink
93,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/155,155,Copy bq schemas to a bq/ folder,See the ~[new generated content in the test-generated-schemas branch](https://github.com/mozilla-services/mozilla-pipeline-schemas/compare/db283cc5353d516922435d92a2ef12ecda524898...ea7ba2217223ef69248175e27309c285d5a88e48)~ (outdated),jklukas,691060,2020-09-30T17:18:50Z,CONTRIBUTOR,False,103,6,2,A library for creating full representations of Mozilla telemetry pings.,Python,fbd799cc6b7c7df26f1b58cdb46f8de984b2aa24,Use PurePath for building relative path for symlink
94,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/155,155,Copy bq schemas to a bq/ folder,See the ~[new generated content in the test-generated-schemas branch](https://github.com/mozilla-services/mozilla-pipeline-schemas/compare/db283cc5353d516922435d92a2ef12ecda524898...ea7ba2217223ef69248175e27309c285d5a88e48)~ (outdated),jklukas,691060,2020-09-30T17:18:50Z,CONTRIBUTOR,False,103,6,2,A library for creating full representations of Mozilla telemetry pings.,Python,6196b871dfb1c3aed987e651c98c3eb27bfd5761,Use schema.yaml files
95,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/155,155,Copy bq schemas to a bq/ folder,See the ~[new generated content in the test-generated-schemas branch](https://github.com/mozilla-services/mozilla-pipeline-schemas/compare/db283cc5353d516922435d92a2ef12ecda524898...ea7ba2217223ef69248175e27309c285d5a88e48)~ (outdated),jklukas,691060,2020-09-30T17:18:50Z,CONTRIBUTOR,False,103,6,2,A library for creating full representations of Mozilla telemetry pings.,Python,7b94de4353df09f33404e52a62366d3699d7c94c,Pass delete_after_days to expirationMs
96,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/154,154,Update docs for MSG,"It looks like the README hasn't been updated since the initial version, and
contains several statements that are out of line with how we are using the
generator in practice today.",jklukas,691060,2020-09-30T14:09:06Z,CONTRIBUTOR,True,27,22,1,A library for creating full representations of Mozilla telemetry pings.,Python,26348be7f2fac63e216fae166fa6c36a49ef7a8a,"Update docs for MSG

It looks like the README hasn't been updated since the initial version, and
contains several statements that are out of line with how we are using the
generator in practice today."
97,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/154,154,Update docs for MSG,"It looks like the README hasn't been updated since the initial version, and
contains several statements that are out of line with how we are using the
generator in practice today.",jklukas,691060,2020-09-30T14:09:06Z,CONTRIBUTOR,True,27,22,1,A library for creating full representations of Mozilla telemetry pings.,Python,fa18ee39dff1aaaf61495dea3c2b864a7c088da3,"Update README.md

Co-authored-by: Frank Bertsch <fbertsch@mozilla.com>"
98,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/154,154,Update docs for MSG,"It looks like the README hasn't been updated since the initial version, and
contains several statements that are out of line with how we are using the
generator in practice today.",jklukas,691060,2020-09-30T14:09:06Z,CONTRIBUTOR,True,27,22,1,A library for creating full representations of Mozilla telemetry pings.,Python,46d6b317d66870f5d252a2b2bdb2545f425a4691,Merge branch 'master' into docs-update
99,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/154,154,Update docs for MSG,"It looks like the README hasn't been updated since the initial version, and
contains several statements that are out of line with how we are using the
generator in practice today.",jklukas,691060,2020-09-30T14:09:06Z,CONTRIBUTOR,True,27,22,1,A library for creating full representations of Mozilla telemetry pings.,Python,70e958e15c16cf3f4358a8c2b869171ba0561396,Talk about common pings and glean pings as targets
100,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/154,154,Update docs for MSG,"It looks like the README hasn't been updated since the initial version, and
contains several statements that are out of line with how we are using the
generator in practice today.",jklukas,691060,2020-09-30T14:09:06Z,CONTRIBUTOR,True,27,22,1,A library for creating full representations of Mozilla telemetry pings.,Python,ec3699a7a836949e53d6c1d5ea8eecdb30dcd727,Add note about coercing complex types to JSON string
101,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/153,153,"Clarifying commentary, esp. around how aliases work","I mistakenly filed https://github.com/mozilla/mozilla-schema-generator/pull/150 due to a misconception about how schema aliasing worked. Until this point, I hadn't fully understood that the modifications we make to JSON schemas are
mostly thrown out before committing changes.

This PR mostly just adds commentary, but does change internal behavior by copying around only BQ schemas when aliasing, making it more clear that aliasing has no effect on the JSON schemas committed to the published branch.

Before this change, the logs show:

```
Aliasing telemetry/main/main.4.bq to telemetry/saved-session/saved-session.4.bq
Aliasing telemetry/main/main.4.schema.json to telemetry/saved-session/saved-session.4.schema.json
Aliasing telemetry/main/main.4.bq to telemetry/first-shutdown/first-shutdown.4.bq
Aliasing telemetry/main/main.4.schema.json to telemetry/first-shutdown/first-shutdown.4.schema.json
```

and I was misdirected by those messages into thinking that we would be overwriting the `schema.json` files in the published output with the contents of `main.4.schema.json`.

With this change, the logs show:

```
Aliasing telemetry/main/main.4.bq to telemetry/saved-session/saved-session.4.bq
Aliasing telemetry/main/main.4.bq to telemetry/first-shutdown/first-shutdown.4.bq
```

And I've confirmed that when I run the generator with these changes, it's a no-op. It reports ""nothing to commit, working tree clean"".",jklukas,691060,2020-09-29T20:25:48Z,CONTRIBUTOR,True,10,6,3,A library for creating full representations of Mozilla telemetry pings.,Python,42b7f001b23371e42b43a426fad6371bee22726e,"Clarifying commentary, esp. around how aliases work

I mistakenly filed https://github.com/mozilla/mozilla-schema-generator/pull/150
due to a misconception about how schema aliasing worked. Until this point,
I hadn't fully understood that the modifications we make to JSON schemas are
mostly thrown out before committing changes.

This PR mostly just adds commentary, but does change internal behavior by
copying around only BQ schemas when aliasing, making it more clear that aliasing
has no effect on the JSON schemas committed to the published branch."
102,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/152,152,Bump limit again,All the way to 9900...,fbertsch,20819040,2020-09-29T02:20:18Z,COLLABORATOR,True,1,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,aaa113bfe38cbb800c1328ba1d5dc4762fcc52e3,Bump limit again
103,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/151,151,Hard fail,"Fixes #74.

For the current `HEAD`, this actually results in:

```
Schema Incompatible Changes Found

telemetry/android-anr-report/android-anr-report.3.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.8.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.9.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.4.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.1.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.7.schema.json
File Removed (disallowed)

telemetry/disableSHA1rollout/disableSHA1rollout.4.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.5.schema.json
File Removed (disallowed)

telemetry/untrustedModules/untrustedModules.4.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.6.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.2.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.10.schema.json
```

I added the commit allowlist to let us bypass checks for certain commits on `generated-schemas`.",fbertsch,20819040,2020-09-28T20:20:10Z,COLLABORATOR,False,322,24,6,A library for creating full representations of Mozilla telemetry pings.,Python,720ee14eb4210e49c9fdbbd1cc207dc01a844c80,Bug 1666608 - Add msg command to compare schemas
104,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/151,151,Hard fail,"Fixes #74.

For the current `HEAD`, this actually results in:

```
Schema Incompatible Changes Found

telemetry/android-anr-report/android-anr-report.3.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.8.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.9.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.4.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.1.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.7.schema.json
File Removed (disallowed)

telemetry/disableSHA1rollout/disableSHA1rollout.4.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.5.schema.json
File Removed (disallowed)

telemetry/untrustedModules/untrustedModules.4.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.6.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.2.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.10.schema.json
```

I added the commit allowlist to let us bypass checks for certain commits on `generated-schemas`.",fbertsch,20819040,2020-09-28T20:20:10Z,COLLABORATOR,False,322,24,6,A library for creating full representations of Mozilla telemetry pings.,Python,8c985a485d3a79eb0aae9e1e1d335c36ebaa61b2,Add schema compatability check to script
105,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/151,151,Hard fail,"Fixes #74.

For the current `HEAD`, this actually results in:

```
Schema Incompatible Changes Found

telemetry/android-anr-report/android-anr-report.3.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.8.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.9.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.4.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.1.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.7.schema.json
File Removed (disallowed)

telemetry/disableSHA1rollout/disableSHA1rollout.4.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.5.schema.json
File Removed (disallowed)

telemetry/untrustedModules/untrustedModules.4.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.6.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.2.schema.json
File Removed (disallowed)

telemetry/android-anr-report/android-anr-report.10.schema.json
```

I added the commit allowlist to let us bypass checks for certain commits on `generated-schemas`.",fbertsch,20819040,2020-09-28T20:20:10Z,COLLABORATOR,False,322,24,6,A library for creating full representations of Mozilla telemetry pings.,Python,fc54e8b32d7dbc39ace38323221e9a227bd95a4d,Use explicit is_property func
106,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/150,150,Preserve mozPipelineMetadata in alias_schemas,"~~Currently, all main ping clones get their metadata clobbered by main ping metadata.~~

This appears to be incorrect, but I'm not understanding yet how metadata is propagating.",jklukas,691060,2020-09-16T16:42:03Z,CONTRIBUTOR,False,13,2,1,A library for creating full representations of Mozilla telemetry pings.,Python,f3829fd93fac064961c022f33ae760992660f697,"Preserve mozPipelineMetadata in alias_schemas

Currently, all main ping clones get their metadata clobbered by main ping
metadata."
107,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/149,149,Remove first-shutdown from disallowlist,"This appears to be an artifact of m-s-g before the concept of aliases was introduced. See https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/383

We have added saved-session as a main ping alias as well, but don't include it in the disallowlist. These should be symmetrical.",jklukas,691060,2020-09-15T18:46:43Z,CONTRIBUTOR,True,0,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,d53fa4bcf36cebbac16611ae6ebe275774bab19a,"Remove first-shutdown from disallowlist

This appears to be an artifact of m-s-g before the concept of aliases was
introduced. See
https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/383

We have added saved-session as a main ping alias as well, but don't include
it in the disallowlist. These should be symmetrical."
108,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/148,148,"Revert ""[Bug 1656910] Remove saved-session ping processing""","Reverts mozilla/mozilla-schema-generator#144
",scholtzan,1239705,2020-09-10T18:53:46Z,CONTRIBUTOR,True,7,0,2,A library for creating full representations of Mozilla telemetry pings.,Python,6d12eb827fd3e1d39e1147d4cf05595a24620278,"Revert ""[Bug 1656910] Remove saved-session ping processing""

This reverts commit 69ca70f61f123fe17b50452b251b37473a8ad8d3."
109,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/146,146,Increase max column limit to 9600,,fbertsch,20819040,2020-09-08T13:32:23Z,COLLABORATOR,True,4,2,2,A library for creating full representations of Mozilla telemetry pings.,Python,bf89aba06d58edf3ee65670128347a2b5199d258,Increase max column limit to 9600
110,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/146,146,Increase max column limit to 9600,,fbertsch,20819040,2020-09-08T13:32:23Z,COLLABORATOR,True,4,2,2,A library for creating full representations of Mozilla telemetry pings.,Python,92609965b2837daa3b6a08fd674870ed7cd6e2b8,Use default max size in test
111,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/146,146,Increase max column limit to 9600,,fbertsch,20819040,2020-09-08T13:32:23Z,COLLABORATOR,True,4,2,2,A library for creating full representations of Mozilla telemetry pings.,Python,97be951358bb25c1545394e75f0e0f0702c7e6f3,Fix lint
112,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/144,144,[Bug 1656910] Remove saved-session ping processing,See https://bugzilla.mozilla.org/show_bug.cgi?id=1656910,scholtzan,1239705,2020-09-01T22:14:03Z,CONTRIBUTOR,True,0,7,2,A library for creating full representations of Mozilla telemetry pings.,Python,1f01ae7fb749e164361f98939ac1f0c7211bbb52,[Bug 1656910] Remove saved-session ping processing
113,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/144,144,[Bug 1656910] Remove saved-session ping processing,See https://bugzilla.mozilla.org/show_bug.cgi?id=1656910,scholtzan,1239705,2020-09-01T22:14:03Z,CONTRIBUTOR,True,0,7,2,A library for creating full representations of Mozilla telemetry pings.,Python,f48632bcbeda5d59ae50bc01a388d6ecf05e2248,Merge branch 'master' into deprecate-saved-session
114,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/143,143,[Bug 1660040] Add legacy PWMGR histograms to sync ping,"There are some histograms sent by older FF versions (68) that still appear in sync pings. These have been removed, e.g. in https://hg.mozilla.org/mozilla-central/rev/263b8a0e6c34, but I guess we still want to add them so that they are not treated as `additional_properties` anymore.",scholtzan,1239705,2020-08-31T16:24:56Z,CONTRIBUTOR,True,7,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,948c8c56a6335828b634257043b7da565a1c9717,Add legacy PWMGR histograms to sync ping
115,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/142,142,Respect configured MPS_BRANCH_SOURCE for all URLs,"Current behavior is that MPS_BRANCH_SOURCE is ignored for Glean pings and common pings, which always reference master.

I've confirmed that running `make build && make run` with these changes produces no difference in output, thus the code doesn't push a new commit to test-generated-schemas.",jklukas,691060,2020-08-28T16:09:06Z,CONTRIBUTOR,True,63,42,8,A library for creating full representations of Mozilla telemetry pings.,Python,78830b968c3804303c7fdd6e7fbe7b483fc3b4be,"Respect configured MPS_BRANCH_SOURCE for all URLs

Current behavior is that MPS_BRANCH_SOURCE is ignored for Glean pings and
common pings, which always reference master."
116,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/142,142,Respect configured MPS_BRANCH_SOURCE for all URLs,"Current behavior is that MPS_BRANCH_SOURCE is ignored for Glean pings and common pings, which always reference master.

I've confirmed that running `make build && make run` with these changes produces no difference in output, thus the code doesn't push a new commit to test-generated-schemas.",jklukas,691060,2020-08-28T16:09:06Z,CONTRIBUTOR,True,63,42,8,A library for creating full representations of Mozilla telemetry pings.,Python,e36945679a21a33fe8fbf57f260d8c355714eb99,Put {branch} placeholder in all urls
117,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/142,142,Respect configured MPS_BRANCH_SOURCE for all URLs,"Current behavior is that MPS_BRANCH_SOURCE is ignored for Glean pings and common pings, which always reference master.

I've confirmed that running `make build && make run` with these changes produces no difference in output, thus the code doesn't push a new commit to test-generated-schemas.",jklukas,691060,2020-08-28T16:09:06Z,CONTRIBUTOR,True,63,42,8,A library for creating full representations of Mozilla telemetry pings.,Python,1f073e0b5e7299578aeb205ef08deccd44e8f9a1,Merge branch 'master' into follow-branch
118,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/141,141,Use bq_metadata_format for choosing metadata structure,"Depends on https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/598

This change should cause no difference to generated output, since the schemas now contain metadata to determine which format to use.",jklukas,691060,2020-08-27T19:59:48Z,CONTRIBUTOR,True,39,37,3,A library for creating full representations of Mozilla telemetry pings.,Python,63bf09a4d79d3ac659773906385ce42314419e0a,Use bq_metadata_format for choosing metadata structure
119,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/140,140,Bug 1659750 Inject probes into account-ecosystem ping,"Also see https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/599

See output in https://github.com/mozilla-services/mozilla-pipeline-schemas/compare/7a366cf2ef9dbe9eda6842ec40bf84c8badb0013...18dc0df62340383544cd81f209c74654b646b3d2",jklukas,691060,2020-08-27T17:48:27Z,CONTRIBUTOR,True,59,34,6,A library for creating full representations of Mozilla telemetry pings.,Python,6616cd2f3138e1758c38e4453a7e4a7542fae10c,Bug 1659750 Inject probes into account-ecosystem ping
120,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/140,140,Bug 1659750 Inject probes into account-ecosystem ping,"Also see https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/599

See output in https://github.com/mozilla-services/mozilla-pipeline-schemas/compare/7a366cf2ef9dbe9eda6842ec40bf84c8badb0013...18dc0df62340383544cd81f209c74654b646b3d2",jklukas,691060,2020-08-27T17:48:27Z,CONTRIBUTOR,True,59,34,6,A library for creating full representations of Mozilla telemetry pings.,Python,e8abeb6d218e1a06d277269a02f46b3f485690e1,Refactor property_exists to method
121,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/140,140,Bug 1659750 Inject probes into account-ecosystem ping,"Also see https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/599

See output in https://github.com/mozilla-services/mozilla-pipeline-schemas/compare/7a366cf2ef9dbe9eda6842ec40bf84c8badb0013...18dc0df62340383544cd81f209c74654b646b3d2",jklukas,691060,2020-08-27T17:48:27Z,CONTRIBUTOR,True,59,34,6,A library for creating full representations of Mozilla telemetry pings.,Python,b329e0830d486c9d6c3a716ab4d5424a31116465,Check for existence of individual environment sections
122,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/140,140,Bug 1659750 Inject probes into account-ecosystem ping,"Also see https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/599

See output in https://github.com/mozilla-services/mozilla-pipeline-schemas/compare/7a366cf2ef9dbe9eda6842ec40bf84c8badb0013...18dc0df62340383544cd81f209c74654b646b3d2",jklukas,691060,2020-08-27T17:48:27Z,CONTRIBUTOR,True,59,34,6,A library for creating full representations of Mozilla telemetry pings.,Python,82fd9e84b92863eb73e84bac8d072c4376a7ffff,lint
123,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/140,140,Bug 1659750 Inject probes into account-ecosystem ping,"Also see https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/599

See output in https://github.com/mozilla-services/mozilla-pipeline-schemas/compare/7a366cf2ef9dbe9eda6842ec40bf84c8badb0013...18dc0df62340383544cd81f209c74654b646b3d2",jklukas,691060,2020-08-27T17:48:27Z,CONTRIBUTOR,True,59,34,6,A library for creating full representations of Mozilla telemetry pings.,Python,f47039fb24b5a945b4fea4d4ccb35dfe15c34a14,lint
124,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/140,140,Bug 1659750 Inject probes into account-ecosystem ping,"Also see https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/599

See output in https://github.com/mozilla-services/mozilla-pipeline-schemas/compare/7a366cf2ef9dbe9eda6842ec40bf84c8badb0013...18dc0df62340383544cd81f209c74654b646b3d2",jklukas,691060,2020-08-27T17:48:27Z,CONTRIBUTOR,True,59,34,6,A library for creating full representations of Mozilla telemetry pings.,Python,a3ce8c4e69c0678897bcd69dd2b4e535d10af5df,Remove common ping env.system.os manipulation
125,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/140,140,Bug 1659750 Inject probes into account-ecosystem ping,"Also see https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/599

See output in https://github.com/mozilla-services/mozilla-pipeline-schemas/compare/7a366cf2ef9dbe9eda6842ec40bf84c8badb0013...18dc0df62340383544cd81f209c74654b646b3d2",jklukas,691060,2020-08-27T17:48:27Z,CONTRIBUTOR,True,59,34,6,A library for creating full representations of Mozilla telemetry pings.,Python,c807f60edecddfac94034d231ca7c9c8378e3219,Remove test that no longer applies
126,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/140,140,Bug 1659750 Inject probes into account-ecosystem ping,"Also see https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/599

See output in https://github.com/mozilla-services/mozilla-pipeline-schemas/compare/7a366cf2ef9dbe9eda6842ec40bf84c8badb0013...18dc0df62340383544cd81f209c74654b646b3d2",jklukas,691060,2020-08-27T17:48:27Z,CONTRIBUTOR,True,59,34,6,A library for creating full representations of Mozilla telemetry pings.,Python,ae5c715057fced805dd16a07c85d0dba97565c60,lint
127,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/139,139,Inject mozPipelineMetadata to generated Glean json schemas,"Makes Glean JSON schemas parallel to hand-written JSON schemas. See
https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/579",jklukas,691060,2020-08-27T13:29:26Z,CONTRIBUTOR,True,29,12,5,A library for creating full representations of Mozilla telemetry pings.,Python,1996c723cf72e94e2197c3d155fb2b8ecfc555df,"Inject mozPipelineMetadata to generated Glean json schemas

Makes Glean JSON schemas parallel to hand-written JSON schemas. See
https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/579"
128,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/139,139,Inject mozPipelineMetadata to generated Glean json schemas,"Makes Glean JSON schemas parallel to hand-written JSON schemas. See
https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/579",jklukas,691060,2020-08-27T13:29:26Z,CONTRIBUTOR,True,29,12,5,A library for creating full representations of Mozilla telemetry pings.,Python,f9654dc53749a815fd675f97f98dad3be292210c,Update glean tests
129,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/139,139,Inject mozPipelineMetadata to generated Glean json schemas,"Makes Glean JSON schemas parallel to hand-written JSON schemas. See
https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/579",jklukas,691060,2020-08-27T13:29:26Z,CONTRIBUTOR,True,29,12,5,A library for creating full representations of Mozilla telemetry pings.,Python,036683ee6360b5cf6eb73fb06d5c1e11afd15117,Update glean_test
130,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/138,138,Accumulate http response as bytestring,"After https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/579
was merged, schema generation was raising an error when processing the
heartbeat schema.

I believe what happened is that one of our 1024 byte chunks happened to land
within a multibyte character. We were decoding each chunk to text, which wasn't
tolerant to the possibility of a chunk ending within a multibyte character.

With this change, I was able to successfully run on the current mps content.",jklukas,691060,2020-08-26T17:28:41Z,CONTRIBUTOR,True,8,4,1,A library for creating full representations of Mozilla telemetry pings.,Python,8c7dc04139c89a714f8240d1662e734f9620f0ac,"Accumulate http response as bytestring

After https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/579
was merged, schema generation was raising an error when processing the
heartbeat schema.

I believe what happened is that one of our 1024 byte chunks happened to land
within a multibyte character. We were decoding each chunk to text, which wasn't
tolerant to the possibility of a chunk ending within a multibyte character.

With this change, I was able to successfully run on the current mps content."
131,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/137,137,Exclude metadata/metaschema,"This new metadata schema is introduced in
https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/579
and should not have a BQ schema generated.",jklukas,691060,2020-08-26T13:52:40Z,CONTRIBUTOR,True,1,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,75731b14ebf5024391ba8074fea72b6d115617d9,"Exclude metadata/metaschema

This new metadata schema is introduced in
https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/579
and should not have a BQ schema generated."
132,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/136,136,[Bug 1660040] Handle sync ping histograms,"Sync pings have a defined set of histograms: https://firefox-source-docs.mozilla.org/toolkit/components/telemetry/data/sync-ping.html#histograms-in-the-sync-ping

Currently, those are written to `additional_properties` and appear in the missing columns dashboard as `payload.histograms`. 

The diff between the old and the generated sync.4.bq schema:

```diff

@@ -355,6 +355,67 @@
         ""name"": ""events"",
         ""type"": ""RECORD""
       },
+      {
+        ""fields"": [
+          {
+            ""description"": ""The number of sites for which the user has explicitly rejected saving logins"",
+            ""mode"": ""NULLABLE"",
+            ""name"": ""pwmgr_blocklist_num_sites"",
+            ""type"": ""STRING""
+          },
+          {
+            ""description"": ""The result of auto-filling a login form. See http://mzl.la/1Mbs6jL for bucket descriptions."",
+            ""mode"": ""NULLABLE"",
+            ""name"": ""pwmgr_form_autofill_result"",
+            ""type"": ""STRING""
+          },
+          {
+            ""description"": ""Time in days each saved login was last used"",
+            ""mode"": ""NULLABLE"",
+            ""name"": ""pwmgr_login_last_used_days"",
+            ""type"": ""STRING""
+          },
+          {
+            ""description"": ""The safety of a page where we see a password field. (0: safe page & safe submit; 1: safe page & unsafe submit; 2: safe page & unknown submit; 3: unsafe page & safe submit; 4: unsafe page & unsafe submit; 5: unsafe page & unknown submit)"",
+            ""mode"": ""NULLABLE"",
+            ""name"": ""pwmgr_login_page_safety"",
+            ""type"": ""STRING""
+          },
+          {
+            ""description"": ""The number of passwords per hostname"",
+            ""mode"": ""NULLABLE"",
+            ""name"": ""pwmgr_num_passwords_per_hostname"",
+            ""type"": ""STRING""
+          },
+          {
+            ""description"": ""Total number of saved logins, including those that cannot be decrypted"",
+            ""mode"": ""NULLABLE"",
+            ""name"": ""pwmgr_num_saved_passwords"",
+            ""type"": ""STRING""
+          },
+          {
+            ""description"": ""Action taken by user through prompt for creating a login. (0=Prompt displayed [always recorded], 1=Add login, 2=Don't save now, 3=Never save)"",
+            ""mode"": ""NULLABLE"",
+            ""name"": ""pwmgr_prompt_remember_action"",
+            ""type"": ""STRING""
+          },
+          {
+            ""description"": ""Action taken by user through prompt for modifying a login. (0=Prompt displayed [always recorded], 1=Update login, 2=Don't update, 3=Remove saved login)"",
+            ""mode"": ""NULLABLE"",
+            ""name"": ""pwmgr_prompt_update_action"",
+            ""type"": ""STRING""
+          },
+          {
+            ""description"": ""Number of users who have password saving on globally"",
+            ""mode"": ""NULLABLE"",
+            ""name"": ""pwmgr_saving_enabled"",
+            ""type"": ""STRING""
+          }
+        ],
+        ""mode"": ""NULLABLE"",
+        ""name"": ""histograms"",
+        ""type"": ""RECORD""
+      },
       {
         ""fields"": [
           {
```",scholtzan,1239705,2020-08-19T18:22:48Z,CONTRIBUTOR,True,79,1,5,A library for creating full representations of Mozilla telemetry pings.,Python,c07065120f0c5ccd5b70ba0647800711edcb12c6,Handle sync ping histograms
133,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/136,136,[Bug 1660040] Handle sync ping histograms,"Sync pings have a defined set of histograms: https://firefox-source-docs.mozilla.org/toolkit/components/telemetry/data/sync-ping.html#histograms-in-the-sync-ping

Currently, those are written to `additional_properties` and appear in the missing columns dashboard as `payload.histograms`. 

The diff between the old and the generated sync.4.bq schema:

```diff

@@ -355,6 +355,67 @@
         ""name"": ""events"",
         ""type"": ""RECORD""
       },
+      {
+        ""fields"": [
+          {
+            ""description"": ""The number of sites for which the user has explicitly rejected saving logins"",
+            ""mode"": ""NULLABLE"",
+            ""name"": ""pwmgr_blocklist_num_sites"",
+            ""type"": ""STRING""
+          },
+          {
+            ""description"": ""The result of auto-filling a login form. See http://mzl.la/1Mbs6jL for bucket descriptions."",
+            ""mode"": ""NULLABLE"",
+            ""name"": ""pwmgr_form_autofill_result"",
+            ""type"": ""STRING""
+          },
+          {
+            ""description"": ""Time in days each saved login was last used"",
+            ""mode"": ""NULLABLE"",
+            ""name"": ""pwmgr_login_last_used_days"",
+            ""type"": ""STRING""
+          },
+          {
+            ""description"": ""The safety of a page where we see a password field. (0: safe page & safe submit; 1: safe page & unsafe submit; 2: safe page & unknown submit; 3: unsafe page & safe submit; 4: unsafe page & unsafe submit; 5: unsafe page & unknown submit)"",
+            ""mode"": ""NULLABLE"",
+            ""name"": ""pwmgr_login_page_safety"",
+            ""type"": ""STRING""
+          },
+          {
+            ""description"": ""The number of passwords per hostname"",
+            ""mode"": ""NULLABLE"",
+            ""name"": ""pwmgr_num_passwords_per_hostname"",
+            ""type"": ""STRING""
+          },
+          {
+            ""description"": ""Total number of saved logins, including those that cannot be decrypted"",
+            ""mode"": ""NULLABLE"",
+            ""name"": ""pwmgr_num_saved_passwords"",
+            ""type"": ""STRING""
+          },
+          {
+            ""description"": ""Action taken by user through prompt for creating a login. (0=Prompt displayed [always recorded], 1=Add login, 2=Don't save now, 3=Never save)"",
+            ""mode"": ""NULLABLE"",
+            ""name"": ""pwmgr_prompt_remember_action"",
+            ""type"": ""STRING""
+          },
+          {
+            ""description"": ""Action taken by user through prompt for modifying a login. (0=Prompt displayed [always recorded], 1=Update login, 2=Don't update, 3=Remove saved login)"",
+            ""mode"": ""NULLABLE"",
+            ""name"": ""pwmgr_prompt_update_action"",
+            ""type"": ""STRING""
+          },
+          {
+            ""description"": ""Number of users who have password saving on globally"",
+            ""mode"": ""NULLABLE"",
+            ""name"": ""pwmgr_saving_enabled"",
+            ""type"": ""STRING""
+          }
+        ],
+        ""mode"": ""NULLABLE"",
+        ""name"": ""histograms"",
+        ""type"": ""RECORD""
+      },
       {
         ""fields"": [
           {
```",scholtzan,1239705,2020-08-19T18:22:48Z,CONTRIBUTOR,True,79,1,5,A library for creating full representations of Mozilla telemetry pings.,Python,bc7accd24b6c042af1360e87421da667c76de9f0,Add tests for any matcher
134,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/135,135,Add some description for the user_prefs field in the environment,"In particular, mentioning that only prefs in an allow list will
be collected.",wlach,20569,2020-07-30T16:34:17Z,MEMBER,True,16,3,3,A library for creating full representations of Mozilla telemetry pings.,Python,bff7a30686391d742339467e98d5ff6be95550cb,"Add some description for the user_prefs field in the environment

In particular, mentioning that only prefs in an allow list will
be collected."
135,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/135,135,Add some description for the user_prefs field in the environment,"In particular, mentioning that only prefs in an allow list will
be collected.",wlach,20569,2020-07-30T16:34:17Z,MEMBER,True,16,3,3,A library for creating full representations of Mozilla telemetry pings.,Python,81952a80d5e07e812bb76d942c58487bce61148e,Update tests
136,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/135,135,Add some description for the user_prefs field in the environment,"In particular, mentioning that only prefs in an allow list will
be collected.",wlach,20569,2020-07-30T16:34:17Z,MEMBER,True,16,3,3,A library for creating full representations of Mozilla telemetry pings.,Python,16507706f92acc932f74354036be508dce6e8ce2,lint fix
137,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/134,134,Bug 1654558 - Merge telemetry metadata for xfocsp namespace,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1654558#c7)

This uses telemetry metadata for the xfocsp namespace, since the pings are being rerouted from the telemetry namespace via  https://github.com/mozilla/gcp-ingestion/pull/1323",acmiyaguchi,3304040,2020-07-22T23:15:04Z,COLLABORATOR,True,3,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,dfd25db55848c4ad3bdbb3d6f3c5cfeac2245568,Bug 1654558 - Merge telemetry metadata for xfocsp namespace
138,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/133,133,[Bug 1645897] Add descriptions to generated Glean schemas,"Fixes https://bugzilla.mozilla.org/show_bug.cgi?id=1645897

Descriptions now appear in generated schemas, see https://github.com/mozilla-services/mozilla-pipeline-schemas/blob/57d236d038727fe573ccb3c8d5a945c8598df65b/schemas/org-mozilla-mozregression/usage/usage.1.bq#L340",scholtzan,1239705,2020-06-17T18:17:21Z,CONTRIBUTOR,True,4,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,c80a58a50f5a0e2b6e82230426a1ccfef369b51b,Add descriptions to generated Glean schemas
139,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/133,133,[Bug 1645897] Add descriptions to generated Glean schemas,"Fixes https://bugzilla.mozilla.org/show_bug.cgi?id=1645897

Descriptions now appear in generated schemas, see https://github.com/mozilla-services/mozilla-pipeline-schemas/blob/57d236d038727fe573ccb3c8d5a945c8598df65b/schemas/org-mozilla-mozregression/usage/usage.1.bq#L340",scholtzan,1239705,2020-06-17T18:17:21Z,CONTRIBUTOR,True,4,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,c33b3ef96e846eb05fac7e97b914c397471cfefc,"Refactor Glean description check

Co-authored-by: Anthony Miyaguchi <acmiyaguchi@gmail.com>"
140,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/132,132,Fix: Fail schema generation if maximum schema size is exceeded,"There was a bug in the code which resulted in not throwing an error when the maximum schema size gets exceeded. The fix was to check the size of the schema after filling in the probes. 

I also increased the maximum size to 9500 columns.",scholtzan,1239705,2020-06-09T22:35:36Z,CONTRIBUTOR,True,17,1,2,A library for creating full representations of Mozilla telemetry pings.,Python,d1fe48ad762be195ed6b025498299b0aafc36473,Fix fail schema generator when max schema size is exceeded
141,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/131,131,[Bug 1642389] Add payload.processes.parent.scalars column to new_profile,"The column `payload.processes.parent.scalars` is missing in `new_profile` and data is written to `additional_properties` as:

```
{""payload"":{""processes"":{""parent"":{""scalars"":{""startup.profile_selection_reason"":""firstrun-created-default""}}}}}
```

With this change, the generated BQ `new_profile.4.bq` schema also includes the following fields:

```
...
  {
    ""fields"": [
      {
        ""fields"": [
          {
            ""fields"": [
              {
                ""fields"": [
                  {
                    ""description"": ""How the profile was selected during startup. One of the following reasons:\n  unknown:\n    Generally should not happen, set as a default in case no other reason\n    occured.\n  profile-manager:\n    The profile was selected by the profile manager.\n  profile-reset:\n    The profile was selected for reset, normally this would mean a restart.\n  restart:\n    The user restarted the application, the same profile as previous will\n    be used.\n  argument-profile:\n    The profile was selected by the --profile command line argument.\n  argument-p:\n    The profile was selected by the -p command line argument.\n  firstrun-claimed-default:\n    A first run of a dedicated profiles build chose the old default\n    profile to be the default for this install.\n  firstrun-skipped-default:\n    A first run of a dedicated profiles build skipped over the old default\n    profile and created a new profile.\n  restart-claimed-default:\n    A first run of a dedicated profiles build after a restart chose the\n    old defaul"",
                    ""mode"": ""NULLABLE"",
                    ""name"": ""startup_profile_selection_reason"",
                    ""type"": ""STRING""
                  }
                ],
                ""mode"": ""NULLABLE"",
                ""name"": ""scalars"",
                ""type"": ""RECORD""
              }
            ],
            ""mode"": ""NULLABLE"",
            ""name"": ""parent"",
            ""type"": ""RECORD""
          }
        ],
        ""mode"": ""NULLABLE"",
        ""name"": ""processes"",
        ""type"": ""RECORD""
      },
      {
        ""mode"": ""NULLABLE"",
        ""name"": ""reason"",
        ""type"": ""STRING""
      }
    ],
    ""mode"": ""NULLABLE"",
    ""name"": ""payload"",
    ""type"": ""RECORD""
  },
...
```",scholtzan,1239705,2020-06-02T18:30:57Z,CONTRIBUTOR,True,15,1,2,A library for creating full representations of Mozilla telemetry pings.,Python,6cd890d17931798f090d778d218ac5dd1cd172ce,[Bug 1642389] Add payload.processes.parent.scalars column to new_profile schema
142,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/130,130,Cache JSON files locally,"I looked things over and realized caching will be a real improvement.

`master`:
```
>> time python -m mozilla_schema_generator generate-glean-pings --out-dir glean/
real	8m0.271s
user	0m25.931s
sys	0m1.564s
```

`caching`, stale cache:
```
>> time python -m mozilla_schema_generator generate-glean-pings --out-dir glean/
real	0m17.616s
user	0m2.521s
sys	0m0.177s
```

Re-runs are free:
```
real	0m1.582s
user	0m1.477s
sys	0m0.100s
```",fbertsch,20819040,2020-05-12T03:42:17Z,COLLABORATOR,True,32,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,6525993e40e119966dbf602970c3186af6bb2f56,Cache JSON files locally
143,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/130,130,Cache JSON files locally,"I looked things over and realized caching will be a real improvement.

`master`:
```
>> time python -m mozilla_schema_generator generate-glean-pings --out-dir glean/
real	8m0.271s
user	0m25.931s
sys	0m1.564s
```

`caching`, stale cache:
```
>> time python -m mozilla_schema_generator generate-glean-pings --out-dir glean/
real	0m17.616s
user	0m2.521s
sys	0m0.177s
```

Re-runs are free:
```
real	0m1.582s
user	0m1.477s
sys	0m0.100s
```",fbertsch,20819040,2020-05-12T03:42:17Z,COLLABORATOR,True,32,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,03d0c05ffa7e551a2bb3ccf81831b6a5dd6c9c78,Fix lint
144,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/129,129,Fix #128 - Parallelize glean ping generation,"This fixes #128 by using multiprocessing to parallelize glean generation. Generating the glean ping is by far the slowest thing in the process. By default, this will use processes equal to the number of CPUs available. 

Before: `make run  0.45s user 0.20s system 0% cpu 8:23.99 total`
After: `make run  0.40s user 0.15s system 0% cpu 3:27.38 total`

One downside of this is that the logging is interleaved.",acmiyaguchi,3304040,2020-05-11T23:14:39Z,COLLABORATOR,False,5,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,074a49183672c59e77dc1dda6d5e7d534a5a4aff,Parallelize glean ping generation
145,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/126,126,Bug 1636317 - Add logic for pioneer-ingestion metadata,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1636317)

This has a dependency on https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/544, but I'm actually not sure what the proper order to land these in are. It shouldn't matter if they're merged in at the same time though.

The following diff was generated using the following command: `make build && MPS_BRANCH_SOURCE=pioneer make run`

https://github.com/mozilla-services/mozilla-pipeline-schemas/commit/6fc366544a62ef805335963f5e62030b9c081537",acmiyaguchi,3304040,2020-05-08T01:22:20Z,COLLABORATOR,True,15,8,2,A library for creating full representations of Mozilla telemetry pings.,Python,9a93fff1a67e952c4aebd6d297a86e17c8e53409,Bug 1636317 - Add logic for pioneer-ingestion metadata
146,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/126,126,Bug 1636317 - Add logic for pioneer-ingestion metadata,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1636317)

This has a dependency on https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/544, but I'm actually not sure what the proper order to land these in are. It shouldn't matter if they're merged in at the same time though.

The following diff was generated using the following command: `make build && MPS_BRANCH_SOURCE=pioneer make run`

https://github.com/mozilla-services/mozilla-pipeline-schemas/commit/6fc366544a62ef805335963f5e62030b9c081537",acmiyaguchi,3304040,2020-05-08T01:22:20Z,COLLABORATOR,True,15,8,2,A library for creating full representations of Mozilla telemetry pings.,Python,4c528d6c38b13d04a7ae78b68fce9403d8b2d29d,Use -path for filtering pioneer studies
147,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/126,126,Bug 1636317 - Add logic for pioneer-ingestion metadata,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1636317)

This has a dependency on https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/544, but I'm actually not sure what the proper order to land these in are. It shouldn't matter if they're merged in at the same time though.

The following diff was generated using the following command: `make build && MPS_BRANCH_SOURCE=pioneer make run`

https://github.com/mozilla-services/mozilla-pipeline-schemas/commit/6fc366544a62ef805335963f5e62030b9c081537",acmiyaguchi,3304040,2020-05-08T01:22:20Z,COLLABORATOR,True,15,8,2,A library for creating full representations of Mozilla telemetry pings.,Python,75f32ef596d411348d57c4579e6e89a19ca7e481,Remove pioneer-study and add metadata/pioneer-ingestion
148,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/126,126,Bug 1636317 - Add logic for pioneer-ingestion metadata,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1636317)

This has a dependency on https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/544, but I'm actually not sure what the proper order to land these in are. It shouldn't matter if they're merged in at the same time though.

The following diff was generated using the following command: `make build && MPS_BRANCH_SOURCE=pioneer make run`

https://github.com/mozilla-services/mozilla-pipeline-schemas/commit/6fc366544a62ef805335963f5e62030b9c081537",acmiyaguchi,3304040,2020-05-08T01:22:20Z,COLLABORATOR,True,15,8,2,A library for creating full representations of Mozilla telemetry pings.,Python,42984c3b134e38ee6b4076cb7fbeb1589d1dcc3a,Replace find statements with a for loop
149,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/126,126,Bug 1636317 - Add logic for pioneer-ingestion metadata,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1636317)

This has a dependency on https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/544, but I'm actually not sure what the proper order to land these in are. It shouldn't matter if they're merged in at the same time though.

The following diff was generated using the following command: `make build && MPS_BRANCH_SOURCE=pioneer make run`

https://github.com/mozilla-services/mozilla-pipeline-schemas/commit/6fc366544a62ef805335963f5e62030b9c081537",acmiyaguchi,3304040,2020-05-08T01:22:20Z,COLLABORATOR,True,15,8,2,A library for creating full representations of Mozilla telemetry pings.,Python,a2a9c3ee21c7a6619e1698bb2a2d93b19717e307,Use regex for matching paths
150,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/125,125,[Bug 1635206] Handle new_profile as common ping,"Adds the new-profile ping to the common pings list.

I also made changes to use `yaml.safe_load` rather than `yaml.load`.",scholtzan,1239705,2020-05-05T22:07:10Z,CONTRIBUTOR,True,6,3,2,A library for creating full representations of Mozilla telemetry pings.,Python,8cc2045e10677d497ba0b96722f6107b416984c5,handle new_profile as common ping
151,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/124,124,Bug 1611027 - Update activeGMPlugins to be schema compatible via casting,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1611027)

This casts the integer into a boolean, since this is being reported differently in a few pings. https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/489

Diff can be found here: https://github.com/mozilla-services/mozilla-pipeline-schemas/compare/bdfb8fc~2...bdfb8fc

It looks like this is correctly nested.

```
wget https://raw.githubusercontent.com/mozilla-services/mozilla-pipeline-schemas/bdfb8fcab009521b93e386e15c9513519e1852b9/schemas/telemetry/crash/crash.4.bq
cat crash.4.bq | jq -r '.[] | recurse(.fields[]? + {parent: ((.parent? // []) + [.name])}) | .parent + [.name] | join(""."")'  | grep active_gm_plugins

environment.addons.active_gm_plugins
environment.addons.active_gm_plugins.key
environment.addons.active_gm_plugins.value
environment.addons.active_gm_plugins.value.apply_background_updates
environment.addons.active_gm_plugins.value.user_disabled
environment.addons.active_gm_plugins.value.version
```",acmiyaguchi,3304040,2020-04-24T23:50:03Z,COLLABORATOR,True,12,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,b585621b4968f3b60b7a2fb395f370bba5ff0b9c,Bug 1611027 - Update activeGMPlugins to be schema compatible via casting
152,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/124,124,Bug 1611027 - Update activeGMPlugins to be schema compatible via casting,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1611027)

This casts the integer into a boolean, since this is being reported differently in a few pings. https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/489

Diff can be found here: https://github.com/mozilla-services/mozilla-pipeline-schemas/compare/bdfb8fc~2...bdfb8fc

It looks like this is correctly nested.

```
wget https://raw.githubusercontent.com/mozilla-services/mozilla-pipeline-schemas/bdfb8fcab009521b93e386e15c9513519e1852b9/schemas/telemetry/crash/crash.4.bq
cat crash.4.bq | jq -r '.[] | recurse(.fields[]? + {parent: ((.parent? // []) + [.name])}) | .parent + [.name] | join(""."")'  | grep active_gm_plugins

environment.addons.active_gm_plugins
environment.addons.active_gm_plugins.key
environment.addons.active_gm_plugins.value
environment.addons.active_gm_plugins.value.apply_background_updates
environment.addons.active_gm_plugins.value.user_disabled
environment.addons.active_gm_plugins.value.version
```",acmiyaguchi,3304040,2020-04-24T23:50:03Z,COLLABORATOR,True,12,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,ed06f0cb82944e2f9e3605227db046280ca2700b,Nest activeGMPlugins under addons
153,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/124,124,Bug 1611027 - Update activeGMPlugins to be schema compatible via casting,"[bug link](https://bugzilla.mozilla.org/show_bug.cgi?id=1611027)

This casts the integer into a boolean, since this is being reported differently in a few pings. https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/489

Diff can be found here: https://github.com/mozilla-services/mozilla-pipeline-schemas/compare/bdfb8fc~2...bdfb8fc

It looks like this is correctly nested.

```
wget https://raw.githubusercontent.com/mozilla-services/mozilla-pipeline-schemas/bdfb8fcab009521b93e386e15c9513519e1852b9/schemas/telemetry/crash/crash.4.bq
cat crash.4.bq | jq -r '.[] | recurse(.fields[]? + {parent: ((.parent? // []) + [.name])}) | .parent + [.name] | join(""."")'  | grep active_gm_plugins

environment.addons.active_gm_plugins
environment.addons.active_gm_plugins.key
environment.addons.active_gm_plugins.value
environment.addons.active_gm_plugins.value.apply_background_updates
environment.addons.active_gm_plugins.value.user_disabled
environment.addons.active_gm_plugins.value.version
```",acmiyaguchi,3304040,2020-04-24T23:50:03Z,COLLABORATOR,True,12,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,8bc3a9961aeb0326da6f4df992a8104ce7f9ebbb,Cast applyBackgroundUpdates to integer
154,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/123,123,[Bug 1626706] Fix deletion_request impression ID config,"This fixes https://bugzilla.mozilla.org/show_bug.cgi?id=1626706

For the deletion_request payload:
`{""payload"":{""scalars"":{""parent"":{""deletion.request.impression_id"":""{0d...a9}""}}}}`
the configuration needed to be changed. 

The resulting schema for deletion_request_v4:

```
[...]
{
    ""mode"": ""REQUIRED"",
    ""name"": ""id"",
    ""type"": ""STRING""
  },
  {
    ""fields"": [
      {
        ""fields"": [
          {
            ""fields"": [
              {
                ""mode"": ""REQUIRED"",
                ""name"": ""key"",
                ""type"": ""STRING""
              },
              {
                ""mode"": ""REQUIRED"",
                ""name"": ""value"",
                ""type"": ""STRING""
              }
            ],
            ""mode"": ""REPEATED"",
            ""name"": ""content"",
            ""type"": ""RECORD""
          },
          {
            ""fields"": [
              {
                ""description"": ""An identifier used by user interaction pings in Pocket/newtab and Messaging System.\n"",
                ""mode"": ""NULLABLE"",
                ""name"": ""deletion_request_impression_id"",
                ""type"": ""STRING""
              }
            ],
            ""mode"": ""NULLABLE"",
            ""name"": ""parent"",
            ""type"": ""RECORD""
          }
        ],
        ""mode"": ""NULLABLE"",
        ""name"": ""scalars"",
        ""type"": ""RECORD""
      }
    ],
    ""mode"": ""NULLABLE"",
    ""name"": ""payload"",
    ""type"": ""RECORD""
  },
  {
    ""mode"": ""REQUIRED"",
    ""name"": ""type"",
    ""type"": ""STRING""
  },
[...]
```",scholtzan,1239705,2020-04-14T16:10:09Z,CONTRIBUTOR,True,12,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,ac0e54599351cf98112d2620c3bec5182efd7b41,Fix deletion_request impression ID config
155,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/123,123,[Bug 1626706] Fix deletion_request impression ID config,"This fixes https://bugzilla.mozilla.org/show_bug.cgi?id=1626706

For the deletion_request payload:
`{""payload"":{""scalars"":{""parent"":{""deletion.request.impression_id"":""{0d...a9}""}}}}`
the configuration needed to be changed. 

The resulting schema for deletion_request_v4:

```
[...]
{
    ""mode"": ""REQUIRED"",
    ""name"": ""id"",
    ""type"": ""STRING""
  },
  {
    ""fields"": [
      {
        ""fields"": [
          {
            ""fields"": [
              {
                ""mode"": ""REQUIRED"",
                ""name"": ""key"",
                ""type"": ""STRING""
              },
              {
                ""mode"": ""REQUIRED"",
                ""name"": ""value"",
                ""type"": ""STRING""
              }
            ],
            ""mode"": ""REPEATED"",
            ""name"": ""content"",
            ""type"": ""RECORD""
          },
          {
            ""fields"": [
              {
                ""description"": ""An identifier used by user interaction pings in Pocket/newtab and Messaging System.\n"",
                ""mode"": ""NULLABLE"",
                ""name"": ""deletion_request_impression_id"",
                ""type"": ""STRING""
              }
            ],
            ""mode"": ""NULLABLE"",
            ""name"": ""parent"",
            ""type"": ""RECORD""
          }
        ],
        ""mode"": ""NULLABLE"",
        ""name"": ""scalars"",
        ""type"": ""RECORD""
      }
    ],
    ""mode"": ""NULLABLE"",
    ""name"": ""payload"",
    ""type"": ""RECORD""
  },
  {
    ""mode"": ""REQUIRED"",
    ""name"": ""type"",
    ""type"": ""STRING""
  },
[...]
```",scholtzan,1239705,2020-04-14T16:10:09Z,CONTRIBUTOR,True,12,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,03d5055b3bd0ccfb6246aa636f1bf694dfbbbd22,deletion_request config backwards compatibility
156,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/122,122,[Bug 1614416] Add environment.system.os.hasSuperfetch and environment.system.os.hasPrefetch as common ping columns,"This adds `environment.system.os.hasSuperfetch` and `environment.system.os.hasPrefetch` as common ping columns. 

Closes https://bugzilla.mozilla.org/show_bug.cgi?id=1614416 

I'm not sure if there are more columns that should be added. Those were the only ones I found that were listed in the Dashboard. Note that everything with `activeGMPlugins` needs to be handled differently and is captured in https://bugzilla.mozilla.org/show_bug.cgi?id=1611027 ",scholtzan,1239705,2020-04-06T19:14:47Z,CONTRIBUTOR,True,5,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,402d76a29de819d242ebd5b11f505ba5cdf761a0,Add environment.system.os.hasSuperfetch and environment.system.os.hasPrefetch as common ping columns
157,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/122,122,[Bug 1614416] Add environment.system.os.hasSuperfetch and environment.system.os.hasPrefetch as common ping columns,"This adds `environment.system.os.hasSuperfetch` and `environment.system.os.hasPrefetch` as common ping columns. 

Closes https://bugzilla.mozilla.org/show_bug.cgi?id=1614416 

I'm not sure if there are more columns that should be added. Those were the only ones I found that were listed in the Dashboard. Note that everything with `activeGMPlugins` needs to be handled differently and is captured in https://bugzilla.mozilla.org/show_bug.cgi?id=1611027 ",scholtzan,1239705,2020-04-06T19:14:47Z,CONTRIBUTOR,True,5,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,160c6872713bfb5648900af6e09aa6ce7ecfd402,hasPrefetch and hasSuperfetch as boolean fields
158,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/121,121,Fix mozilla-pipeline-schemas url,,acmiyaguchi,3304040,2020-03-11T00:35:33Z,COLLABORATOR,True,1,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,7210a86fab1c2ee06991d0bb58af67d72fe86387,Fix mozilla-pipeline-schemas url
159,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/120,120,Bug 1614416 Common ping format implementation,"This PR adds support for propagating changes for schemas outside of the main ping to those that include the common ping format. This fixes issues where columns are missing for some schemas that get added by the schema generator (see https://bugzilla.mozilla.org/show_bug.cgi?id=1614416)

Schemas that follow the common ping format and should be processed are defined in `common_pings.json`. Currently 2 schemas were invalid due to missing types and missing from that list: 
* https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/511/files#diff-4d86bea8f5f8b9760701da04328d9574
* https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/511/files#diff-ed9293105c5e86452f2bbab2ab604106

I filed https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/511 to fix these issues.

This PR also adds scalar processing for the deletion-request ping (see https://github.com/mozilla/mozilla-schema-generator/issues/85). `common_pings.json` allows to specify configs that should be applied when processing schemas.

I also implemented https://github.com/mozilla/mozilla-schema-generator/issues/110 for easier debugging.",scholtzan,1239705,2020-03-10T23:23:41Z,CONTRIBUTOR,True,293,67,10,A library for creating full representations of Mozilla telemetry pings.,Python,c3d739aeb923b9b04a0be0215139cb9068d64951,Process common pings
160,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/120,120,Bug 1614416 Common ping format implementation,"This PR adds support for propagating changes for schemas outside of the main ping to those that include the common ping format. This fixes issues where columns are missing for some schemas that get added by the schema generator (see https://bugzilla.mozilla.org/show_bug.cgi?id=1614416)

Schemas that follow the common ping format and should be processed are defined in `common_pings.json`. Currently 2 schemas were invalid due to missing types and missing from that list: 
* https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/511/files#diff-4d86bea8f5f8b9760701da04328d9574
* https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/511/files#diff-ed9293105c5e86452f2bbab2ab604106

I filed https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/511 to fix these issues.

This PR also adds scalar processing for the deletion-request ping (see https://github.com/mozilla/mozilla-schema-generator/issues/85). `common_pings.json` allows to specify configs that should be applied when processing schemas.

I also implemented https://github.com/mozilla/mozilla-schema-generator/issues/110 for easier debugging.",scholtzan,1239705,2020-03-10T23:23:41Z,CONTRIBUTOR,True,293,67,10,A library for creating full representations of Mozilla telemetry pings.,Python,2b01d3c6da47e2ffd047b86642788265c572f7fc,Implement __repr__ for probes
161,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/120,120,Bug 1614416 Common ping format implementation,"This PR adds support for propagating changes for schemas outside of the main ping to those that include the common ping format. This fixes issues where columns are missing for some schemas that get added by the schema generator (see https://bugzilla.mozilla.org/show_bug.cgi?id=1614416)

Schemas that follow the common ping format and should be processed are defined in `common_pings.json`. Currently 2 schemas were invalid due to missing types and missing from that list: 
* https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/511/files#diff-4d86bea8f5f8b9760701da04328d9574
* https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/511/files#diff-ed9293105c5e86452f2bbab2ab604106

I filed https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/511 to fix these issues.

This PR also adds scalar processing for the deletion-request ping (see https://github.com/mozilla/mozilla-schema-generator/issues/85). `common_pings.json` allows to specify configs that should be applied when processing schemas.

I also implemented https://github.com/mozilla/mozilla-schema-generator/issues/110 for easier debugging.",scholtzan,1239705,2020-03-10T23:23:41Z,CONTRIBUTOR,True,293,67,10,A library for creating full representations of Mozilla telemetry pings.,Python,325ae93ab99d26db6c9653af892c7bb22ce46d12,Fix tests for common ping
162,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/120,120,Bug 1614416 Common ping format implementation,"This PR adds support for propagating changes for schemas outside of the main ping to those that include the common ping format. This fixes issues where columns are missing for some schemas that get added by the schema generator (see https://bugzilla.mozilla.org/show_bug.cgi?id=1614416)

Schemas that follow the common ping format and should be processed are defined in `common_pings.json`. Currently 2 schemas were invalid due to missing types and missing from that list: 
* https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/511/files#diff-4d86bea8f5f8b9760701da04328d9574
* https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/511/files#diff-ed9293105c5e86452f2bbab2ab604106

I filed https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/511 to fix these issues.

This PR also adds scalar processing for the deletion-request ping (see https://github.com/mozilla/mozilla-schema-generator/issues/85). `common_pings.json` allows to specify configs that should be applied when processing schemas.

I also implemented https://github.com/mozilla/mozilla-schema-generator/issues/110 for easier debugging.",scholtzan,1239705,2020-03-10T23:23:41Z,CONTRIBUTOR,True,293,67,10,A library for creating full representations of Mozilla telemetry pings.,Python,3f9b43113b46d9ba608dc0c3a314f09ac7fe9bd0,Common pings and split exceptions
163,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/120,120,Bug 1614416 Common ping format implementation,"This PR adds support for propagating changes for schemas outside of the main ping to those that include the common ping format. This fixes issues where columns are missing for some schemas that get added by the schema generator (see https://bugzilla.mozilla.org/show_bug.cgi?id=1614416)

Schemas that follow the common ping format and should be processed are defined in `common_pings.json`. Currently 2 schemas were invalid due to missing types and missing from that list: 
* https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/511/files#diff-4d86bea8f5f8b9760701da04328d9574
* https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/511/files#diff-ed9293105c5e86452f2bbab2ab604106

I filed https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/511 to fix these issues.

This PR also adds scalar processing for the deletion-request ping (see https://github.com/mozilla/mozilla-schema-generator/issues/85). `common_pings.json` allows to specify configs that should be applied when processing schemas.

I also implemented https://github.com/mozilla/mozilla-schema-generator/issues/110 for easier debugging.",scholtzan,1239705,2020-03-10T23:23:41Z,CONTRIBUTOR,True,293,67,10,A library for creating full representations of Mozilla telemetry pings.,Python,7d015efd4cf65091243eef512f4e10ef6fccbc64,Common ping config for run scripts
164,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/120,120,Bug 1614416 Common ping format implementation,"This PR adds support for propagating changes for schemas outside of the main ping to those that include the common ping format. This fixes issues where columns are missing for some schemas that get added by the schema generator (see https://bugzilla.mozilla.org/show_bug.cgi?id=1614416)

Schemas that follow the common ping format and should be processed are defined in `common_pings.json`. Currently 2 schemas were invalid due to missing types and missing from that list: 
* https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/511/files#diff-4d86bea8f5f8b9760701da04328d9574
* https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/511/files#diff-ed9293105c5e86452f2bbab2ab604106

I filed https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/511 to fix these issues.

This PR also adds scalar processing for the deletion-request ping (see https://github.com/mozilla/mozilla-schema-generator/issues/85). `common_pings.json` allows to specify configs that should be applied when processing schemas.

I also implemented https://github.com/mozilla/mozilla-schema-generator/issues/110 for easier debugging.",scholtzan,1239705,2020-03-10T23:23:41Z,CONTRIBUTOR,True,293,67,10,A library for creating full representations of Mozilla telemetry pings.,Python,07684485460c2fae7246c211e0dfdb0fb633baa7,Keep MainPing for backwards compatibility
165,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/120,120,Bug 1614416 Common ping format implementation,"This PR adds support for propagating changes for schemas outside of the main ping to those that include the common ping format. This fixes issues where columns are missing for some schemas that get added by the schema generator (see https://bugzilla.mozilla.org/show_bug.cgi?id=1614416)

Schemas that follow the common ping format and should be processed are defined in `common_pings.json`. Currently 2 schemas were invalid due to missing types and missing from that list: 
* https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/511/files#diff-4d86bea8f5f8b9760701da04328d9574
* https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/511/files#diff-ed9293105c5e86452f2bbab2ab604106

I filed https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/511 to fix these issues.

This PR also adds scalar processing for the deletion-request ping (see https://github.com/mozilla/mozilla-schema-generator/issues/85). `common_pings.json` allows to specify configs that should be applied when processing schemas.

I also implemented https://github.com/mozilla/mozilla-schema-generator/issues/110 for easier debugging.",scholtzan,1239705,2020-03-10T23:23:41Z,CONTRIBUTOR,True,293,67,10,A library for creating full representations of Mozilla telemetry pings.,Python,5d9d6bd4573fc815733b6e06bbe9fcb81b29347a,Return exceptions for util._get()
166,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/119,119,Fix #118 - Maintain schema compatibility for changed probe type,"Fixes #118. This is done on a case-by-case basis. In particular, this adds a copy of the `installation.timestamp` metric as a string and a datetime.

```bash
export MPS_SSH_KEY_BASE64=$(cat ~/.ssh/id_rsa | base64)

git checkout master
make build && make run

git checkout type_change
make build && make run
```

This diff shows the change from master: https://github.com/mozilla-services/mozilla-pipeline-schemas/commit/9c966c1c5e4b4982c6a1e5027df9a629bfbbf49b",acmiyaguchi,3304040,2020-03-09T21:17:55Z,COLLABORATOR,True,43,3,2,A library for creating full representations of Mozilla telemetry pings.,Python,7d8431ec4702badaca3034accb1c8d4ee6173dbd,"Fix #118 - Maintain schema compatibility for changed probe type

This is done on a case-by-case basis. In particular, this adds a copy of
the `installation.timestamp` metric as a string and a datetime."
167,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/119,119,Fix #118 - Maintain schema compatibility for changed probe type,"Fixes #118. This is done on a case-by-case basis. In particular, this adds a copy of the `installation.timestamp` metric as a string and a datetime.

```bash
export MPS_SSH_KEY_BASE64=$(cat ~/.ssh/id_rsa | base64)

git checkout master
make build && make run

git checkout type_change
make build && make run
```

This diff shows the change from master: https://github.com/mozilla-services/mozilla-pipeline-schemas/commit/9c966c1c5e4b4982c6a1e5027df9a629bfbbf49b",acmiyaguchi,3304040,2020-03-09T21:17:55Z,COLLABORATOR,True,43,3,2,A library for creating full representations of Mozilla telemetry pings.,Python,ff1d0201b9c81d534dbc5aeb609a246d6bf2c3ee,Order history in descending order
168,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/119,119,Fix #118 - Maintain schema compatibility for changed probe type,"Fixes #118. This is done on a case-by-case basis. In particular, this adds a copy of the `installation.timestamp` metric as a string and a datetime.

```bash
export MPS_SSH_KEY_BASE64=$(cat ~/.ssh/id_rsa | base64)

git checkout master
make build && make run

git checkout type_change
make build && make run
```

This diff shows the change from master: https://github.com/mozilla-services/mozilla-pipeline-schemas/commit/9c966c1c5e4b4982c6a1e5027df9a629bfbbf49b",acmiyaguchi,3304040,2020-03-09T21:17:55Z,COLLABORATOR,True,43,3,2,A library for creating full representations of Mozilla telemetry pings.,Python,dbed12b5fac89919947d57055b0b4cad0abed936,Update probe type to match historical type
169,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/119,119,Fix #118 - Maintain schema compatibility for changed probe type,"Fixes #118. This is done on a case-by-case basis. In particular, this adds a copy of the `installation.timestamp` metric as a string and a datetime.

```bash
export MPS_SSH_KEY_BASE64=$(cat ~/.ssh/id_rsa | base64)

git checkout master
make build && make run

git checkout type_change
make build && make run
```

This diff shows the change from master: https://github.com/mozilla-services/mozilla-pipeline-schemas/commit/9c966c1c5e4b4982c6a1e5027df9a629bfbbf49b",acmiyaguchi,3304040,2020-03-09T21:17:55Z,COLLABORATOR,True,43,3,2,A library for creating full representations of Mozilla telemetry pings.,Python,033d1fdaa607148d3966616f91a198682e186dd3,Remove extra logging
170,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/119,119,Fix #118 - Maintain schema compatibility for changed probe type,"Fixes #118. This is done on a case-by-case basis. In particular, this adds a copy of the `installation.timestamp` metric as a string and a datetime.

```bash
export MPS_SSH_KEY_BASE64=$(cat ~/.ssh/id_rsa | base64)

git checkout master
make build && make run

git checkout type_change
make build && make run
```

This diff shows the change from master: https://github.com/mozilla-services/mozilla-pipeline-schemas/commit/9c966c1c5e4b4982c6a1e5027df9a629bfbbf49b",acmiyaguchi,3304040,2020-03-09T21:17:55Z,COLLABORATOR,True,43,3,2,A library for creating full representations of Mozilla telemetry pings.,Python,7834bcbb98583d1f3a9f5ad5c89d4260709d6c07,Fix typo in pings
171,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/119,119,Fix #118 - Maintain schema compatibility for changed probe type,"Fixes #118. This is done on a case-by-case basis. In particular, this adds a copy of the `installation.timestamp` metric as a string and a datetime.

```bash
export MPS_SSH_KEY_BASE64=$(cat ~/.ssh/id_rsa | base64)

git checkout master
make build && make run

git checkout type_change
make build && make run
```

This diff shows the change from master: https://github.com/mozilla-services/mozilla-pipeline-schemas/commit/9c966c1c5e4b4982c6a1e5027df9a629bfbbf49b",acmiyaguchi,3304040,2020-03-09T21:17:55Z,COLLABORATOR,True,43,3,2,A library for creating full representations of Mozilla telemetry pings.,Python,ca92cf29d97474a688b3f0b9d8a00a1354815e33,Add full set of affected repo names
172,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/117,117,Fix schema generation of main probes,"This fixes https://github.com/mozilla/mozilla-schema-generator/issues/115

Comparing the generated test-schema and the previously generated schema:

```diff
{
-                    ""description"": ""Time from submission to dispatch of HTTP/3 transaction (ms)"",
+                    ""description"": ""A list of known accessibility clients that inject into Firefox process space (see https://dxr.mozilla.org/mozilla-central/source/accessible/windows/msaa/Compatibility.h)."",
                     ""mode"": ""NULLABLE"",
                     ""name"": ""a11y_consumers"",
                     ""type"": ""STRING""
                   },
                   {
-                    ""description"": ""Time from submission to dispatch of HTTP/3 transaction (ms)"",
+                    ""description"": ""Flag indicating the IAccessibleTable accessibility interface has been used."",
                     ""mode"": ""NULLABLE"",
                     ""name"": ""a11y_iatable_usage_flag"",
                     ""type"": ""STRING""
                   },
                   {
-                    ""description"": ""Time from submission to dispatch of HTTP/3 transaction (ms)"",
+                    ""description"": ""Flag indicating accessibility support has been instantiated."",
                     ""mode"": ""NULLABLE"",
                     ""name"": ""a11y_instantiated_flag"",
                     ""type"": ""STRING""
                   },
                   {
-                    ""description"": ""Time from submission to dispatch of HTTP/3 transaction (ms)"",
+                    ""description"": ""Flag indicating the ISimpleDOM* accessibility interfaces has been used."",
                     ""mode"": ""NULLABLE"",
                     ""name"": ""a11y_isimpledom_usage_flag"",
                     ""type"": ""STRING""
                   },
                   {
-                    ""description"": ""Time from submission to dispatch of HTTP/3 transaction (ms)"",
+                    ""description"": ""The amount of time taken to update the accessibility tree (ms)"",
                     ""mode"": ""NULLABLE"",
                     ""name"": ""a11y_tree_update_timing_ms"",
                     ""type"": ""STRING""
                   },
```",scholtzan,1239705,2020-03-06T23:59:35Z,CONTRIBUTOR,True,1,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,bea08d449c8284b5f077c9a5da6ac80fc3689b77,Fix schema generation of main probes
173,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/116,116,Glean descriptions,Fixes https://github.com/mozilla/mozilla-schema-generator/issues/112,scholtzan,1239705,2020-03-05T22:26:58Z,CONTRIBUTOR,True,4,1,2,A library for creating full representations of Mozilla telemetry pings.,Python,2cbb6c95786cd48275101c42d838b506ed20db83,Bugfix: set descriptions for Glean probes
174,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/116,116,Glean descriptions,Fixes https://github.com/mozilla/mozilla-schema-generator/issues/112,scholtzan,1239705,2020-03-05T22:26:58Z,CONTRIBUTOR,True,4,1,2,A library for creating full representations of Mozilla telemetry pings.,Python,300ba63a69a9b06ac6cc1c599a41010e1149ce5b,Glean description test
175,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/114,114,Max length of descriptions is 1024 characters,Should fix https://github.com/mozilla/mozilla-schema-generator/issues/111,scholtzan,1239705,2020-03-04T21:08:40Z,CONTRIBUTOR,True,32,2,2,A library for creating full representations of Mozilla telemetry pings.,Python,7f36a138648a5d9079b35efeb2c2b6326b12f38b,Max length of descriptions is 1024 characters
176,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/114,114,Max length of descriptions is 1024 characters,Should fix https://github.com/mozilla/mozilla-schema-generator/issues/111,scholtzan,1239705,2020-03-04T21:08:40Z,CONTRIBUTOR,True,32,2,2,A library for creating full representations of Mozilla telemetry pings.,Python,3614e71594a584ab27d88a76b9593fff921812d2,Merge branch 'master' into max-description-length
177,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/113,113,Bump release version,,fbertsch,20819040,2020-03-04T21:01:03Z,COLLABORATOR,True,2,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,5956adb19590045ec86d707f9c04f628499be46b,Bump release version
178,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/108,108,Add test-generated-schemas to README,Add info of how to run the script that pushes the generated schemas to `test-generated-schemas`,scholtzan,1239705,2020-03-03T23:12:30Z,CONTRIBUTOR,True,17,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,0e94fdacbbfe87915c3c643f6bbcfe3ceea7365f,Add test-generated-schemas to README
179,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/108,108,Add test-generated-schemas to README,Add info of how to run the script that pushes the generated schemas to `test-generated-schemas`,scholtzan,1239705,2020-03-03T23:12:30Z,CONTRIBUTOR,True,17,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,915010de7d2124050db372b41f1ba75a81085bd1,Merge branch 'master' into make-run-doc
180,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/107,107,Bug 1603536 Add descriptions to generated schemas,This adds support for parsing descriptions from probes and adding them to generated schemas.,scholtzan,1239705,2020-03-03T18:46:39Z,CONTRIBUTOR,True,37,14,2,A library for creating full representations of Mozilla telemetry pings.,Python,24a38dab96546a18841d0b2f846938e61353156a,Add descriptions to generated schemas
181,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/107,107,Bug 1603536 Add descriptions to generated schemas,This adds support for parsing descriptions from probes and adding them to generated schemas.,scholtzan,1239705,2020-03-03T18:46:39Z,CONTRIBUTOR,True,37,14,2,A library for creating full representations of Mozilla telemetry pings.,Python,8533d0454cac8c6aa8770bc7352189c1c398cd77,Refactor parsing descriptions from probes and tests
182,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/106,106,Bug 1597782 - fix gpu histograms again,This change doesn't remove any fields from the schema.,tdsmith,173889,2020-02-13T22:30:27Z,MEMBER,True,5,2,1,A library for creating full representations of Mozilla telemetry pings.,Python,9327bfd462b9e6a99b370885c1f62d3379a26b3c,Fix stray whitespace
183,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/106,106,Bug 1597782 - fix gpu histograms again,This change doesn't remove any fields from the schema.,tdsmith,173889,2020-02-13T22:30:27Z,MEMBER,True,5,2,1,A library for creating full representations of Mozilla telemetry pings.,Python,f7b8466f9465cfa7c7b2b513e514ecbc8a608e45,Include simple GPU histograms in the schema
184,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/104,104,"Revert ""Bug 1597782 -Collect GPU process histograms correctly""","Reverts mozilla/mozilla-schema-generator#103

This removed columns in the generated schemas in the following commit: https://github.com/mozilla-services/mozilla-pipeline-schemas/commit/1f1ae08c08c3eb1bbdfcf813fb180e1422c94720

This is currently stalling schema deploys, so this will be backed out. We should ensure a review of the generated diff against the generated branch before merging to avoid this problem next time. 

cc @tdsmith ",acmiyaguchi,3304040,2020-02-12T21:28:27Z,COLLABORATOR,True,2,2,1,A library for creating full representations of Mozilla telemetry pings.,Python,9678be04dafcbcb1c7db02ec77ba59548d9bf154,"Revert ""Fix stray whitespace""

This reverts commit 74c41e1d5a319f9a77909754d0681847b52dcaa5."
185,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/104,104,"Revert ""Bug 1597782 -Collect GPU process histograms correctly""","Reverts mozilla/mozilla-schema-generator#103

This removed columns in the generated schemas in the following commit: https://github.com/mozilla-services/mozilla-pipeline-schemas/commit/1f1ae08c08c3eb1bbdfcf813fb180e1422c94720

This is currently stalling schema deploys, so this will be backed out. We should ensure a review of the generated diff against the generated branch before merging to avoid this problem next time. 

cc @tdsmith ",acmiyaguchi,3304040,2020-02-12T21:28:27Z,COLLABORATOR,True,2,2,1,A library for creating full representations of Mozilla telemetry pings.,Python,b9ba995d0739888d62672d12d40149a3c8d0ef9b,"Revert ""Collect GPU process histograms correctly""

This reverts commit dc35d1874a34ed416c9bd64bef5325ba9362de6d."
186,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/103,103,Bug 1597782 -Collect GPU process histograms correctly,`payload.processes.gpu.histograms` should collect unkeyed histograms.,tdsmith,173889,2020-02-12T00:00:19Z,MEMBER,True,2,2,1,A library for creating full representations of Mozilla telemetry pings.,Python,ba7d7354db608c8ff3d833064fb462e48ecdc675,"Collect GPU process histograms correctly

`payload.processes.gpu.histograms` should collect unkeyed histograms."
187,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/103,103,Bug 1597782 -Collect GPU process histograms correctly,`payload.processes.gpu.histograms` should collect unkeyed histograms.,tdsmith,173889,2020-02-12T00:00:19Z,MEMBER,True,2,2,1,A library for creating full representations of Mozilla telemetry pings.,Python,7ac76c403cd36a560e1afb752b21d64d4b29d035,Fix stray whitespace
188,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/101,101,Bump jsonschema-transpiler to v1.8.0,Adds descriptions to schemas as per https://github.com/mozilla/jsonschema-transpiler/releases/tag/v1.8.0,acmiyaguchi,3304040,2020-01-24T21:16:44Z,COLLABORATOR,True,1,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,630994dfdfb5ea806586778aea596a766411d653,"Bump jsonschema-transpiler to v1.8.0

Adds descriptions to schemas as per https://github.com/mozilla/jsonschema-transpiler/releases/tag/v1.8.0"
189,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/99,99,Use timestamp for latest probes file,,fbertsch,20819040,2020-01-17T17:04:46Z,COLLABORATOR,True,2,2,1,A library for creating full representations of Mozilla telemetry pings.,Python,04ce10b70c7f88f5bcbae2b8bd4a78028c5b84be,Use timestamp for latest probes file
190,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/98,98,Add individual commit information into auto-pushed commits,"This fixes #20 by adding log information of commits between the last generated commit and the present. This works by looking at the last commit date in the generated-schemas branch, and filtering out the commits in the master branch using the `--since` flag. This works best when all commits are added via squash/rebase, so I've disabled merge commits in mozilla-pipeline-schemas. This is easy to revert if undesirable.

The test associated test generates the following branch in mozilla-pipeline-schemas: https://github.com/mozilla-services/mozilla-pipeline-schemas/commits/test-generated-schemas-changelog

```
 Auto-push from schema generation [ci skip]

b696996	2020-01-08 12:51:40 -0500	Make the $id for main ping schema show version as ""4""
a56043b	2020-01-08 11:54:56 -0500	Add page for china build to activity stream impression_stats
6b9c323	2020-01-08 10:39:36 -0500	Allow negative sessionLengths and event timestamps
29b042f	2020-01-08 10:26:59 -0500	Allow for old-style ping_type in glean
d093483	2020-01-08 10:26:59 -0500	Add changelog entry
dc87e27	2020-01-08 10:26:59 -0500	Make glean ping_type kebab
f28259d	2020-01-07 15:58:25 -0800	Revert ""Add build/ folder to gitignore""
```

There are some quirks around how we handle git management within the container that I think are undesirable. First, every run of `schema_generator.sh` will clobber/delete the state of the previous run, which requires typing in the password for your ssh key to push to the repo. There are also protected files in the checked out repo that will require user prompting in the script. One idea is to prepopulate this repo with a submodule pointing to mozilla-pipeline-schemas, like mozilla-services/edge-validator, or to modifying the `setup_git_ssh` and `clone_and_configure_mps` functions so they can be run without throwing away all the initialization. This would make it easier to generate diffs between versions of the repo or revisions of mps. 

Additionally, we might want to think about adding tags to the master branch that correspond to a generated schema. This could be used as an alternative landmark to commit date for determining the date range for the autocommit comment. ",acmiyaguchi,3304040,2020-01-17T01:10:20Z,COLLABORATOR,True,85,7,2,A library for creating full representations of Mozilla telemetry pings.,Python,fc4404e1d919a9b8d85ee4c5d0f92fc0b0d2439f,Start ssh-agent to avoid multiple prompts
191,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/98,98,Add individual commit information into auto-pushed commits,"This fixes #20 by adding log information of commits between the last generated commit and the present. This works by looking at the last commit date in the generated-schemas branch, and filtering out the commits in the master branch using the `--since` flag. This works best when all commits are added via squash/rebase, so I've disabled merge commits in mozilla-pipeline-schemas. This is easy to revert if undesirable.

The test associated test generates the following branch in mozilla-pipeline-schemas: https://github.com/mozilla-services/mozilla-pipeline-schemas/commits/test-generated-schemas-changelog

```
 Auto-push from schema generation [ci skip]

b696996	2020-01-08 12:51:40 -0500	Make the $id for main ping schema show version as ""4""
a56043b	2020-01-08 11:54:56 -0500	Add page for china build to activity stream impression_stats
6b9c323	2020-01-08 10:39:36 -0500	Allow negative sessionLengths and event timestamps
29b042f	2020-01-08 10:26:59 -0500	Allow for old-style ping_type in glean
d093483	2020-01-08 10:26:59 -0500	Add changelog entry
dc87e27	2020-01-08 10:26:59 -0500	Make glean ping_type kebab
f28259d	2020-01-07 15:58:25 -0800	Revert ""Add build/ folder to gitignore""
```

There are some quirks around how we handle git management within the container that I think are undesirable. First, every run of `schema_generator.sh` will clobber/delete the state of the previous run, which requires typing in the password for your ssh key to push to the repo. There are also protected files in the checked out repo that will require user prompting in the script. One idea is to prepopulate this repo with a submodule pointing to mozilla-pipeline-schemas, like mozilla-services/edge-validator, or to modifying the `setup_git_ssh` and `clone_and_configure_mps` functions so they can be run without throwing away all the initialization. This would make it easier to generate diffs between versions of the repo or revisions of mps. 

Additionally, we might want to think about adding tags to the master branch that correspond to a generated schema. This could be used as an alternative landmark to commit date for determining the date range for the autocommit comment. ",acmiyaguchi,3304040,2020-01-17T01:10:20Z,COLLABORATOR,True,85,7,2,A library for creating full representations of Mozilla telemetry pings.,Python,3bab852ed8af4ebe13357d63675c984000e65257,Move git push into function
192,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/98,98,Add individual commit information into auto-pushed commits,"This fixes #20 by adding log information of commits between the last generated commit and the present. This works by looking at the last commit date in the generated-schemas branch, and filtering out the commits in the master branch using the `--since` flag. This works best when all commits are added via squash/rebase, so I've disabled merge commits in mozilla-pipeline-schemas. This is easy to revert if undesirable.

The test associated test generates the following branch in mozilla-pipeline-schemas: https://github.com/mozilla-services/mozilla-pipeline-schemas/commits/test-generated-schemas-changelog

```
 Auto-push from schema generation [ci skip]

b696996	2020-01-08 12:51:40 -0500	Make the $id for main ping schema show version as ""4""
a56043b	2020-01-08 11:54:56 -0500	Add page for china build to activity stream impression_stats
6b9c323	2020-01-08 10:39:36 -0500	Allow negative sessionLengths and event timestamps
29b042f	2020-01-08 10:26:59 -0500	Allow for old-style ping_type in glean
d093483	2020-01-08 10:26:59 -0500	Add changelog entry
dc87e27	2020-01-08 10:26:59 -0500	Make glean ping_type kebab
f28259d	2020-01-07 15:58:25 -0800	Revert ""Add build/ folder to gitignore""
```

There are some quirks around how we handle git management within the container that I think are undesirable. First, every run of `schema_generator.sh` will clobber/delete the state of the previous run, which requires typing in the password for your ssh key to push to the repo. There are also protected files in the checked out repo that will require user prompting in the script. One idea is to prepopulate this repo with a submodule pointing to mozilla-pipeline-schemas, like mozilla-services/edge-validator, or to modifying the `setup_git_ssh` and `clone_and_configure_mps` functions so they can be run without throwing away all the initialization. This would make it easier to generate diffs between versions of the repo or revisions of mps. 

Additionally, we might want to think about adding tags to the master branch that correspond to a generated schema. This could be used as an alternative landmark to commit date for determining the date range for the autocommit comment. ",acmiyaguchi,3304040,2020-01-17T01:10:20Z,COLLABORATOR,True,85,7,2,A library for creating full representations of Mozilla telemetry pings.,Python,014c6fe3d0b675996d6115c900f18be5c8edf1bb,Add changelog to commit message
193,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/98,98,Add individual commit information into auto-pushed commits,"This fixes #20 by adding log information of commits between the last generated commit and the present. This works by looking at the last commit date in the generated-schemas branch, and filtering out the commits in the master branch using the `--since` flag. This works best when all commits are added via squash/rebase, so I've disabled merge commits in mozilla-pipeline-schemas. This is easy to revert if undesirable.

The test associated test generates the following branch in mozilla-pipeline-schemas: https://github.com/mozilla-services/mozilla-pipeline-schemas/commits/test-generated-schemas-changelog

```
 Auto-push from schema generation [ci skip]

b696996	2020-01-08 12:51:40 -0500	Make the $id for main ping schema show version as ""4""
a56043b	2020-01-08 11:54:56 -0500	Add page for china build to activity stream impression_stats
6b9c323	2020-01-08 10:39:36 -0500	Allow negative sessionLengths and event timestamps
29b042f	2020-01-08 10:26:59 -0500	Allow for old-style ping_type in glean
d093483	2020-01-08 10:26:59 -0500	Add changelog entry
dc87e27	2020-01-08 10:26:59 -0500	Make glean ping_type kebab
f28259d	2020-01-07 15:58:25 -0800	Revert ""Add build/ folder to gitignore""
```

There are some quirks around how we handle git management within the container that I think are undesirable. First, every run of `schema_generator.sh` will clobber/delete the state of the previous run, which requires typing in the password for your ssh key to push to the repo. There are also protected files in the checked out repo that will require user prompting in the script. One idea is to prepopulate this repo with a submodule pointing to mozilla-pipeline-schemas, like mozilla-services/edge-validator, or to modifying the `setup_git_ssh` and `clone_and_configure_mps` functions so they can be run without throwing away all the initialization. This would make it easier to generate diffs between versions of the repo or revisions of mps. 

Additionally, we might want to think about adding tags to the master branch that correspond to a generated schema. This could be used as an alternative landmark to commit date for determining the date range for the autocommit comment. ",acmiyaguchi,3304040,2020-01-17T01:10:20Z,COLLABORATOR,True,85,7,2,A library for creating full representations of Mozilla telemetry pings.,Python,6b832717657e578ab4f9de172444d6f4cf3483cf,Remove obsolete TODO
194,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/98,98,Add individual commit information into auto-pushed commits,"This fixes #20 by adding log information of commits between the last generated commit and the present. This works by looking at the last commit date in the generated-schemas branch, and filtering out the commits in the master branch using the `--since` flag. This works best when all commits are added via squash/rebase, so I've disabled merge commits in mozilla-pipeline-schemas. This is easy to revert if undesirable.

The test associated test generates the following branch in mozilla-pipeline-schemas: https://github.com/mozilla-services/mozilla-pipeline-schemas/commits/test-generated-schemas-changelog

```
 Auto-push from schema generation [ci skip]

b696996	2020-01-08 12:51:40 -0500	Make the $id for main ping schema show version as ""4""
a56043b	2020-01-08 11:54:56 -0500	Add page for china build to activity stream impression_stats
6b9c323	2020-01-08 10:39:36 -0500	Allow negative sessionLengths and event timestamps
29b042f	2020-01-08 10:26:59 -0500	Allow for old-style ping_type in glean
d093483	2020-01-08 10:26:59 -0500	Add changelog entry
dc87e27	2020-01-08 10:26:59 -0500	Make glean ping_type kebab
f28259d	2020-01-07 15:58:25 -0800	Revert ""Add build/ folder to gitignore""
```

There are some quirks around how we handle git management within the container that I think are undesirable. First, every run of `schema_generator.sh` will clobber/delete the state of the previous run, which requires typing in the password for your ssh key to push to the repo. There are also protected files in the checked out repo that will require user prompting in the script. One idea is to prepopulate this repo with a submodule pointing to mozilla-pipeline-schemas, like mozilla-services/edge-validator, or to modifying the `setup_git_ssh` and `clone_and_configure_mps` functions so they can be run without throwing away all the initialization. This would make it easier to generate diffs between versions of the repo or revisions of mps. 

Additionally, we might want to think about adding tags to the master branch that correspond to a generated schema. This could be used as an alternative landmark to commit date for determining the date range for the autocommit comment. ",acmiyaguchi,3304040,2020-01-17T01:10:20Z,COLLABORATOR,True,85,7,2,A library for creating full representations of Mozilla telemetry pings.,Python,e226b6e2a3721fd3d895b2cdc45de1edf219e6f3,Add initial script for testing changelog
195,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/98,98,Add individual commit information into auto-pushed commits,"This fixes #20 by adding log information of commits between the last generated commit and the present. This works by looking at the last commit date in the generated-schemas branch, and filtering out the commits in the master branch using the `--since` flag. This works best when all commits are added via squash/rebase, so I've disabled merge commits in mozilla-pipeline-schemas. This is easy to revert if undesirable.

The test associated test generates the following branch in mozilla-pipeline-schemas: https://github.com/mozilla-services/mozilla-pipeline-schemas/commits/test-generated-schemas-changelog

```
 Auto-push from schema generation [ci skip]

b696996	2020-01-08 12:51:40 -0500	Make the $id for main ping schema show version as ""4""
a56043b	2020-01-08 11:54:56 -0500	Add page for china build to activity stream impression_stats
6b9c323	2020-01-08 10:39:36 -0500	Allow negative sessionLengths and event timestamps
29b042f	2020-01-08 10:26:59 -0500	Allow for old-style ping_type in glean
d093483	2020-01-08 10:26:59 -0500	Add changelog entry
dc87e27	2020-01-08 10:26:59 -0500	Make glean ping_type kebab
f28259d	2020-01-07 15:58:25 -0800	Revert ""Add build/ folder to gitignore""
```

There are some quirks around how we handle git management within the container that I think are undesirable. First, every run of `schema_generator.sh` will clobber/delete the state of the previous run, which requires typing in the password for your ssh key to push to the repo. There are also protected files in the checked out repo that will require user prompting in the script. One idea is to prepopulate this repo with a submodule pointing to mozilla-pipeline-schemas, like mozilla-services/edge-validator, or to modifying the `setup_git_ssh` and `clone_and_configure_mps` functions so they can be run without throwing away all the initialization. This would make it easier to generate diffs between versions of the repo or revisions of mps. 

Additionally, we might want to think about adding tags to the master branch that correspond to a generated schema. This could be used as an alternative landmark to commit date for determining the date range for the autocommit comment. ",acmiyaguchi,3304040,2020-01-17T01:10:20Z,COLLABORATOR,True,85,7,2,A library for creating full representations of Mozilla telemetry pings.,Python,6a2e6bd412a82d6744e4ad5ddb0508d238dff481,"Push to upstream if not exists, and use commit date"
196,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/98,98,Add individual commit information into auto-pushed commits,"This fixes #20 by adding log information of commits between the last generated commit and the present. This works by looking at the last commit date in the generated-schemas branch, and filtering out the commits in the master branch using the `--since` flag. This works best when all commits are added via squash/rebase, so I've disabled merge commits in mozilla-pipeline-schemas. This is easy to revert if undesirable.

The test associated test generates the following branch in mozilla-pipeline-schemas: https://github.com/mozilla-services/mozilla-pipeline-schemas/commits/test-generated-schemas-changelog

```
 Auto-push from schema generation [ci skip]

b696996	2020-01-08 12:51:40 -0500	Make the $id for main ping schema show version as ""4""
a56043b	2020-01-08 11:54:56 -0500	Add page for china build to activity stream impression_stats
6b9c323	2020-01-08 10:39:36 -0500	Allow negative sessionLengths and event timestamps
29b042f	2020-01-08 10:26:59 -0500	Allow for old-style ping_type in glean
d093483	2020-01-08 10:26:59 -0500	Add changelog entry
dc87e27	2020-01-08 10:26:59 -0500	Make glean ping_type kebab
f28259d	2020-01-07 15:58:25 -0800	Revert ""Add build/ folder to gitignore""
```

There are some quirks around how we handle git management within the container that I think are undesirable. First, every run of `schema_generator.sh` will clobber/delete the state of the previous run, which requires typing in the password for your ssh key to push to the repo. There are also protected files in the checked out repo that will require user prompting in the script. One idea is to prepopulate this repo with a submodule pointing to mozilla-pipeline-schemas, like mozilla-services/edge-validator, or to modifying the `setup_git_ssh` and `clone_and_configure_mps` functions so they can be run without throwing away all the initialization. This would make it easier to generate diffs between versions of the repo or revisions of mps. 

Additionally, we might want to think about adding tags to the master branch that correspond to a generated schema. This could be used as an alternative landmark to commit date for determining the date range for the autocommit comment. ",acmiyaguchi,3304040,2020-01-17T01:10:20Z,COLLABORATOR,True,85,7,2,A library for creating full representations of Mozilla telemetry pings.,Python,e78e826f114cd6e2fd00e1594dd8061ef4fa8ca7,Avoid interactive changes in testing script
197,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/98,98,Add individual commit information into auto-pushed commits,"This fixes #20 by adding log information of commits between the last generated commit and the present. This works by looking at the last commit date in the generated-schemas branch, and filtering out the commits in the master branch using the `--since` flag. This works best when all commits are added via squash/rebase, so I've disabled merge commits in mozilla-pipeline-schemas. This is easy to revert if undesirable.

The test associated test generates the following branch in mozilla-pipeline-schemas: https://github.com/mozilla-services/mozilla-pipeline-schemas/commits/test-generated-schemas-changelog

```
 Auto-push from schema generation [ci skip]

b696996	2020-01-08 12:51:40 -0500	Make the $id for main ping schema show version as ""4""
a56043b	2020-01-08 11:54:56 -0500	Add page for china build to activity stream impression_stats
6b9c323	2020-01-08 10:39:36 -0500	Allow negative sessionLengths and event timestamps
29b042f	2020-01-08 10:26:59 -0500	Allow for old-style ping_type in glean
d093483	2020-01-08 10:26:59 -0500	Add changelog entry
dc87e27	2020-01-08 10:26:59 -0500	Make glean ping_type kebab
f28259d	2020-01-07 15:58:25 -0800	Revert ""Add build/ folder to gitignore""
```

There are some quirks around how we handle git management within the container that I think are undesirable. First, every run of `schema_generator.sh` will clobber/delete the state of the previous run, which requires typing in the password for your ssh key to push to the repo. There are also protected files in the checked out repo that will require user prompting in the script. One idea is to prepopulate this repo with a submodule pointing to mozilla-pipeline-schemas, like mozilla-services/edge-validator, or to modifying the `setup_git_ssh` and `clone_and_configure_mps` functions so they can be run without throwing away all the initialization. This would make it easier to generate diffs between versions of the repo or revisions of mps. 

Additionally, we might want to think about adding tags to the master branch that correspond to a generated schema. This could be used as an alternative landmark to commit date for determining the date range for the autocommit comment. ",acmiyaguchi,3304040,2020-01-17T01:10:20Z,COLLABORATOR,True,85,7,2,A library for creating full representations of Mozilla telemetry pings.,Python,256ee100c5fcf4cc571bb30d2a1480c55b4eced2,"Remove cat after git log

Paging is not a problem when using -1"
198,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/98,98,Add individual commit information into auto-pushed commits,"This fixes #20 by adding log information of commits between the last generated commit and the present. This works by looking at the last commit date in the generated-schemas branch, and filtering out the commits in the master branch using the `--since` flag. This works best when all commits are added via squash/rebase, so I've disabled merge commits in mozilla-pipeline-schemas. This is easy to revert if undesirable.

The test associated test generates the following branch in mozilla-pipeline-schemas: https://github.com/mozilla-services/mozilla-pipeline-schemas/commits/test-generated-schemas-changelog

```
 Auto-push from schema generation [ci skip]

b696996	2020-01-08 12:51:40 -0500	Make the $id for main ping schema show version as ""4""
a56043b	2020-01-08 11:54:56 -0500	Add page for china build to activity stream impression_stats
6b9c323	2020-01-08 10:39:36 -0500	Allow negative sessionLengths and event timestamps
29b042f	2020-01-08 10:26:59 -0500	Allow for old-style ping_type in glean
d093483	2020-01-08 10:26:59 -0500	Add changelog entry
dc87e27	2020-01-08 10:26:59 -0500	Make glean ping_type kebab
f28259d	2020-01-07 15:58:25 -0800	Revert ""Add build/ folder to gitignore""
```

There are some quirks around how we handle git management within the container that I think are undesirable. First, every run of `schema_generator.sh` will clobber/delete the state of the previous run, which requires typing in the password for your ssh key to push to the repo. There are also protected files in the checked out repo that will require user prompting in the script. One idea is to prepopulate this repo with a submodule pointing to mozilla-pipeline-schemas, like mozilla-services/edge-validator, or to modifying the `setup_git_ssh` and `clone_and_configure_mps` functions so they can be run without throwing away all the initialization. This would make it easier to generate diffs between versions of the repo or revisions of mps. 

Additionally, we might want to think about adding tags to the master branch that correspond to a generated schema. This could be used as an alternative landmark to commit date for determining the date range for the autocommit comment. ",acmiyaguchi,3304040,2020-01-17T01:10:20Z,COLLABORATOR,True,85,7,2,A library for creating full representations of Mozilla telemetry pings.,Python,20c1dbf668a54fa16d1f7e6a36e12953a4f56bcd,Address review
199,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/95,95,Use latest version of probe-info-service,,fbertsch,20819040,2020-01-16T19:51:11Z,COLLABORATOR,True,12,5,3,A library for creating full representations of Mozilla telemetry pings.,Python,446b7092d3089715c0fc2bf08f676f9dba15d002,Use latest version of probe-info-service
200,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/94,94,Dependency pings,Fixes #93 ,fbertsch,20819040,2020-01-15T15:31:03Z,COLLABORATOR,True,16,22,2,A library for creating full representations of Mozilla telemetry pings.,Python,e01925eaca9b65be33859d51c46f4046d04f3faa,Hard fail when pings file is missing
201,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/94,94,Dependency pings,Fixes #93 ,fbertsch,20819040,2020-01-15T15:31:03Z,COLLABORATOR,True,16,22,2,A library for creating full representations of Mozilla telemetry pings.,Python,ffc64b3c0b863b8e599c2bfbf276b0380ac6c56b,Retrieve dependency pings
202,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/90,90,"Ignore ""all_pings"" glean ping type",This should fix failing tests,scholtzan,1239705,2020-01-13T21:55:26Z,CONTRIBUTOR,False,1,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,c22d667a612896e47dfd550f7bcbdb4bc18c35a6,"Ignore ""all_pings"" glean ping type"
203,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/89,89,Allow historic version of all_pings,"We updated all_pings to all-pings, but historically we still
have all_pings. We need to allow these values.

Good thing we have a retro tomorrow  ",fbertsch,20819040,2020-01-13T21:34:51Z,COLLABORATOR,True,3,3,2,A library for creating full representations of Mozilla telemetry pings.,Python,4de16fb6a9a3544ffa3ba148617d3299d64823d6,"Allow historic version of all_pings

We updated all_pings to all-pings, but historically we still
have all_pings. We need to allow these values."
204,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/86,86,Fix kebab-cased all-pings,"Looks like the switch to kebab-case broke the schema-generator:

- It's added a ping `all-pings`, which used to be a snake-cased `all_pings` which indicated to send a metric in every ping
- It's removed a few core glean fields, but that's related to the above because it's any of the ones with `all-pings`

This fixes those.",fbertsch,20819040,2019-12-19T12:55:34Z,COLLABORATOR,True,3,3,3,A library for creating full representations of Mozilla telemetry pings.,Python,89f65b0a6624148d4ad26784904e47d27d831f77,Fix kebab-cased all-pings
205,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/84,84,Use glean/glean schema rather than baseline,"Once we make this change here, we can remove glean/baseline from mozilla-pipeline-schemas so that we truly have only one canonical copy of the Glean JSON schema.",jklukas,691060,2019-12-12T21:46:15Z,CONTRIBUTOR,True,1,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,26e5e069cf93f18f44b380d5a4b9f2f87398c229,"Use glean/glean schema rather than baseline

Once we make this change here, we can remove glean/baseline from
mozilla-pipeline-schemas so that we truly have only one canonical
copy of the Glean JSON schema."
206,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/83,83,Bug 1601270 Transform snake_case ping names to kebab-case,See the [diff of test-generated-schemas before and after this change](https://github.com/mozilla-services/mozilla-pipeline-schemas/compare/b3cd120f388dcc3392684ba8da1e887a9ea88254...3db4703101b7a2c05cee7c6d6da461d3f5d7771c?expand=1).,jklukas,691060,2019-12-12T21:37:19Z,CONTRIBUTOR,True,3,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,6ffdc59d72f66e3b7f07d57bac33b8aee21d53a4,Bug 1601270 Transform snake_case ping names to kebab-case
207,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/83,83,Bug 1601270 Transform snake_case ping names to kebab-case,See the [diff of test-generated-schemas before and after this change](https://github.com/mozilla-services/mozilla-pipeline-schemas/compare/b3cd120f388dcc3392684ba8da1e887a9ea88254...3db4703101b7a2c05cee7c6d6da461d3f5d7771c?expand=1).,jklukas,691060,2019-12-12T21:37:19Z,CONTRIBUTOR,True,3,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,16b086a80427c043642c0adea78c1ec6675e5a63,Merge branch 'master' into kebab-case-pings
208,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/82,82,Fetch ping names from ping definition list,"It might be as easy as this, we do need to:

* Land the probe-scraper changes first
* Then add the pings.yaml files to the probe-scraper correctly for all projects

Fixes #81",badboy,2129,2019-12-12T15:27:04Z,MEMBER,True,20,22,3,A library for creating full representations of Mozilla telemetry pings.,Python,0c1fcf89ddd274736af1918c2620f24626c3ef15,"Fetch ping names from ping definition list

Fixes #81"
209,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/82,82,Fetch ping names from ping definition list,"It might be as easy as this, we do need to:

* Land the probe-scraper changes first
* Then add the pings.yaml files to the probe-scraper correctly for all projects

Fixes #81",badboy,2129,2019-12-12T15:27:04Z,MEMBER,True,20,22,3,A library for creating full representations of Mozilla telemetry pings.,Python,54117efb6f77245a566f3eda5d85c7dbb172dc1f,"Don't fail if no ping info is needed and use default pings

If the parsed ping info is empty, it will also be just default pings."
210,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/82,82,Fetch ping names from ping definition list,"It might be as easy as this, we do need to:

* Land the probe-scraper changes first
* Then add the pings.yaml files to the probe-scraper correctly for all projects

Fixes #81",badboy,2129,2019-12-12T15:27:04Z,MEMBER,True,20,22,3,A library for creating full representations of Mozilla telemetry pings.,Python,3a14e766368ef6297a279703ee0da8c8ecaa371b,"Extend default ping list

The newly introduced deletion-request ping is available for all Glean users."
211,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/82,82,Fetch ping names from ping definition list,"It might be as easy as this, we do need to:

* Land the probe-scraper changes first
* Then add the pings.yaml files to the probe-scraper correctly for all projects

Fixes #81",badboy,2129,2019-12-12T15:27:04Z,MEMBER,True,20,22,3,A library for creating full representations of Mozilla telemetry pings.,Python,4f1ecd8ab9a8313ec3c8cb540cf43478eb140694,"Get verbose test ouptut

On CI we always want full output to easily diagnose test failures."
212,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/80,80,Bug 1595899 - Add XPI field to main ping schema,,relud,433717,2019-11-22T00:17:45Z,CONTRIBUTOR,False,15,0,2,A library for creating full representations of Mozilla telemetry pings.,Python,b7c0e9ec46b3494c0480138811187fdbca297b89,Bug 1595899 - Add XPI field to main ping schema
213,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/79,79,Bug 1595899 - Add fields to main ping schema,,relud,433717,2019-11-18T21:49:54Z,CONTRIBUTOR,True,21,6,1,A library for creating full representations of Mozilla telemetry pings.,Python,38bddcd15061b44f5ccf3d08cd85646c573a544d,Bug 1595899 - Add fields to main ping schema
214,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/77,77,Retrieve processes from all_childs,Fixes #75 ,fbertsch,20819040,2019-10-15T14:35:38Z,COLLABORATOR,True,246,3,6,A library for creating full representations of Mozilla telemetry pings.,Python,0f5563be09de15a80962a06c44ed39588ecfeb5b,Retrieve processes from all_childs
215,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/77,77,Retrieve processes from all_childs,Fixes #75 ,fbertsch,20819040,2019-10-15T14:35:38Z,COLLABORATOR,True,246,3,6,A library for creating full representations of Mozilla telemetry pings.,Python,70ba0342d3acc801351d282f1a42ecc880336ad5,Fix lint issues
216,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/77,77,Retrieve processes from all_childs,Fixes #75 ,fbertsch,20819040,2019-10-15T14:35:38Z,COLLABORATOR,True,246,3,6,A library for creating full representations of Mozilla telemetry pings.,Python,df1238d2463cc2d8856709d73216f706e950e961,Add other process types
217,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/77,77,Retrieve processes from all_childs,Fixes #75 ,fbertsch,20819040,2019-10-15T14:35:38Z,COLLABORATOR,True,246,3,6,A library for creating full representations of Mozilla telemetry pings.,Python,710bd895947ab7c0123b806b90716aed3222d84e,Manually change type of userPrefs and os-version
218,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/77,77,Retrieve processes from all_childs,Fixes #75 ,fbertsch,20819040,2019-10-15T14:35:38Z,COLLABORATOR,True,246,3,6,A library for creating full representations of Mozilla telemetry pings.,Python,86b6cb9f642f6436c6e306eca813383952dadab5,Fill-in other processes
219,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/77,77,Retrieve processes from all_childs,Fixes #75 ,fbertsch,20819040,2019-10-15T14:35:38Z,COLLABORATOR,True,246,3,6,A library for creating full representations of Mozilla telemetry pings.,Python,b9371730f6dac619465b802c0871932f949235eb,Dont run script for shell entry
220,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/73,73,Use master instead of dev for Glean,Results from a test here: https://github.com/mozilla-services/mozilla-pipeline-schemas/tree/frank-test-generated-schemas,fbertsch,20819040,2019-09-26T15:43:54Z,COLLABORATOR,True,19,1,2,A library for creating full representations of Mozilla telemetry pings.,Python,9d1c61489001bc874e1bfeb04837e447f4b552d6,Use master instead of dev for Glean
221,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/73,73,Use master instead of dev for Glean,Results from a test here: https://github.com/mozilla-services/mozilla-pipeline-schemas/tree/frank-test-generated-schemas,fbertsch,20819040,2019-09-26T15:43:54Z,COLLABORATOR,True,19,1,2,A library for creating full representations of Mozilla telemetry pings.,Python,0c4ceec05546ea10a53f144c562b35ce43b38b61,Add new metrics to config
222,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/71,71,Add --tuple-struct to schema generation,My understanding is that this can roll out independently from https://github.com/mozilla/gcp-ingestion/pull/847. The probe scraper dag is running now so perhaps we should merge+deploy this tomorrow.,whd,808776,2019-09-26T00:41:55Z,MEMBER,True,2,1,2,A library for creating full representations of Mozilla telemetry pings.,Python,b3ac49d538792492549a8f2e2c131a0c857f93b7,Add --tuple-struct to schema generation
223,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/71,71,Add --tuple-struct to schema generation,My understanding is that this can roll out independently from https://github.com/mozilla/gcp-ingestion/pull/847. The probe scraper dag is running now so perhaps we should merge+deploy this tomorrow.,whd,808776,2019-09-26T00:41:55Z,MEMBER,True,2,1,2,A library for creating full representations of Mozilla telemetry pings.,Python,2ba04b0c257a34e11333d0d8fd73376c499f68a7,Merge branch 'master' into tuples
224,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/71,71,Add --tuple-struct to schema generation,My understanding is that this can roll out independently from https://github.com/mozilla/gcp-ingestion/pull/847. The probe scraper dag is running now so perhaps we should merge+deploy this tomorrow.,whd,808776,2019-09-26T00:41:55Z,MEMBER,True,2,1,2,A library for creating full representations of Mozilla telemetry pings.,Python,89bef2d1ec6e949c51b61182c8aef021f48caca0,Bump jsonschema-transpiler to v1.6.0
225,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/68,68,Include any pings a probe has reported,"Run here: https://github.com/fbertsch/mozilla-pipeline-schemas/blob/612c4811de3702f93affe6f446b43089620ddc4c/schemas/org-mozilla-fenix/metrics/metrics.1.bq

Looks like it adds the counters back in.",fbertsch,20819040,2019-08-21T19:03:14Z,COLLABORATOR,True,42,2,3,A library for creating full representations of Mozilla telemetry pings.,Python,5dae10b4f581d179974225220058daa592409c2d,Include any pings a probe has reported
226,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/68,68,Include any pings a probe has reported,"Run here: https://github.com/fbertsch/mozilla-pipeline-schemas/blob/612c4811de3702f93affe6f446b43089620ddc4c/schemas/org-mozilla-fenix/metrics/metrics.1.bq

Looks like it adds the counters back in.",fbertsch,20819040,2019-08-21T19:03:14Z,COLLABORATOR,True,42,2,3,A library for creating full representations of Mozilla telemetry pings.,Python,d743ba9447f49a0ceef85eccba8ac8ced8333d91,Fix lint
227,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/66,66,Bump jsonschema-transpiler to v1.4.0 and force nullable schemas,,acmiyaguchi,3304040,2019-08-19T22:45:24Z,COLLABORATOR,True,7,2,2,A library for creating full representations of Mozilla telemetry pings.,Python,0736c8bf0472a1aafba3f2b53a5363e142a2cc78,Bump jsonschema-transpiler to v1.4.0
228,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/66,66,Bump jsonschema-transpiler to v1.4.0 and force nullable schemas,,acmiyaguchi,3304040,2019-08-19T22:45:24Z,COLLABORATOR,True,7,2,2,A library for creating full representations of Mozilla telemetry pings.,Python,bb545cda9c1af61412b3aad21cc74374a9c4f151,Add --force-nullable to schema generation
229,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/66,66,Bump jsonschema-transpiler to v1.4.0 and force nullable schemas,,acmiyaguchi,3304040,2019-08-19T22:45:24Z,COLLABORATOR,True,7,2,2,A library for creating full representations of Mozilla telemetry pings.,Python,7a04e49be282c073ada01ad1c2a26dc05730feb9,Bump jsonschema-transpiler to 1.4.1
230,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/65,65,Prod fix,"This limits to recent FX versions, and also fixes the recent difference of processes.",fbertsch,20819040,2019-08-19T20:56:33Z,COLLABORATOR,True,29,2,4,A library for creating full representations of Mozilla telemetry pings.,Python,9ddc99c39255aa0b4045d9ab9ef9faf235831687,Limit to probes in recent Fx versions
231,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/65,65,Prod fix,"This limits to recent FX versions, and also fixes the recent difference of processes.",fbertsch,20819040,2019-08-19T20:56:33Z,COLLABORATOR,True,29,2,4,A library for creating full representations of Mozilla telemetry pings.,Python,282fc94b2b7fc5aa6a966fbaeb75bbea4d2d0cd3,Include all historical processes for a probe
232,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/65,65,Prod fix,"This limits to recent FX versions, and also fixes the recent difference of processes.",fbertsch,20819040,2019-08-19T20:56:33Z,COLLABORATOR,True,29,2,4,A library for creating full representations of Mozilla telemetry pings.,Python,463375f566c39fb4e2f88ca1e1bfcb85ba6b66eb,Merge branch 'master' into prod_fix
233,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/65,65,Prod fix,"This limits to recent FX versions, and also fixes the recent difference of processes.",fbertsch,20819040,2019-08-19T20:56:33Z,COLLABORATOR,True,29,2,4,A library for creating full representations of Mozilla telemetry pings.,Python,88170b55b9339e0962a28a273a1f2491b8959c90,Merge branch 'master' into prod_fix
234,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/65,65,Prod fix,"This limits to recent FX versions, and also fixes the recent difference of processes.",fbertsch,20819040,2019-08-19T20:56:33Z,COLLABORATOR,True,29,2,4,A library for creating full representations of Mozilla telemetry pings.,Python,4221c8df3db55a4bebf7b908f60daffa2ea479e7,"Decrement MainPing.MIN_FX_VERSION to 30

This fixes prior incompatible schema changes to the main ping, leaving the
total column at 5444."
235,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/64,64,Ignore camelCase docTypes,Companion to https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/391,jklukas,691060,2019-08-19T18:35:02Z,CONTRIBUTOR,True,2,4,2,A library for creating full representations of Mozilla telemetry pings.,Python,50437312dc53fea4c3b428de0f980aa506745d04,Ignore camelCase docTypes
236,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/64,64,Ignore camelCase docTypes,Companion to https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/391,jklukas,691060,2019-08-19T18:35:02Z,CONTRIBUTOR,True,2,4,2,A library for creating full representations of Mozilla telemetry pings.,Python,14c5948a03a542e79cf7e7e4ad639382265e9100,Add camelCase docTypes to the disallow list
237,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/61,61,Add circleci status badge,,fbertsch,20819040,2019-08-16T18:29:12Z,COLLABORATOR,True,2,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,15aee22703fc89aba0cf86fda7c342752ba1cc73,Add circleci status badge
238,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/60,60,Requirements fail,"Before, the requirements weren't being installed during the image creation - now they are. This should guarantee that the script has access to them.",fbertsch,20819040,2019-08-16T15:27:30Z,COLLABORATOR,True,8,13,3,A library for creating full representations of Mozilla telemetry pings.,Python,6b9ca88663450a0d5f5de9c0402198f70b3e3677,Add jsonschema to python requirements
239,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/60,60,Requirements fail,"Before, the requirements weren't being installed during the image creation - now they are. This should guarantee that the script has access to them.",fbertsch,20819040,2019-08-16T15:27:30Z,COLLABORATOR,True,8,13,3,A library for creating full representations of Mozilla telemetry pings.,Python,3e52eb4316b79f3d7671d537190ac3882f521e0e,Install requirements during build
240,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/60,60,Requirements fail,"Before, the requirements weren't being installed during the image creation - now they are. This should guarantee that the script has access to them.",fbertsch,20819040,2019-08-16T15:27:30Z,COLLABORATOR,True,8,13,3,A library for creating full representations of Mozilla telemetry pings.,Python,ad27eeb78e31fe96e775a4c1e299ca0d16d37820,Add comma after jsonschema
241,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/60,60,Requirements fail,"Before, the requirements weren't being installed during the image creation - now they are. This should guarantee that the script has access to them.",fbertsch,20819040,2019-08-16T15:27:30Z,COLLABORATOR,True,8,13,3,A library for creating full representations of Mozilla telemetry pings.,Python,819aa7b0f440d9af8bda89bf735b0725525a04c8,Install all requirements to container
242,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/59,59,Move jsonschema requirement,I re-ran MSG from airflow and it looks like only test requirements were updated for jsonschema. See [the log](https://workflow.telemetry.mozilla.org/log?task_id=mozilla_schema_generator&dag_id=probe_scraper&execution_date=2019-08-14T00%3A00%3A00%2B00%3A00).,whd,808776,2019-08-15T21:54:05Z,MEMBER,True,1,1,2,A library for creating full representations of Mozilla telemetry pings.,Python,93a52d2b1c357a6a92191a884119193df83732a5,Move jsonschema requirement
243,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/58,58,Add support for schema aliasing,"Resolves #53, for both saved-session and first-shutdown.

This adds a new file which lists the schemas we want to alias.
This does not handle versions; the aliased namespace/doctype
are assumed to have the same versions as the source schemas.

This also includes a validation schema for the aliasing file,
and tests that the file is valid.

The test output is here: https://github.com/mozilla-services/mozilla-pipeline-schemas/tree/test-generated-schemas",fbertsch,20819040,2019-08-15T16:33:11Z,COLLABORATOR,True,242,1,9,A library for creating full representations of Mozilla telemetry pings.,Python,3bfdc941adb294f14905f730cc59607433a525a4,"Add support for schema aliasing

This adds a new file which lists the schemas we want to alias.
This does not handle versions; the aliased namespace/doctype
are assumed to have the same versions as the source schemas.

This also includes a validation schema for the aliasing file,
and tests that the file is valid."
244,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/58,58,Add support for schema aliasing,"Resolves #53, for both saved-session and first-shutdown.

This adds a new file which lists the schemas we want to alias.
This does not handle versions; the aliased namespace/doctype
are assumed to have the same versions as the source schemas.

This also includes a validation schema for the aliasing file,
and tests that the file is valid.

The test output is here: https://github.com/mozilla-services/mozilla-pipeline-schemas/tree/test-generated-schemas",fbertsch,20819040,2019-08-15T16:33:11Z,COLLABORATOR,True,242,1,9,A library for creating full representations of Mozilla telemetry pings.,Python,0c7517691c05441485ee2e575838175cac4bddab,Fix naming
245,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/58,58,Add support for schema aliasing,"Resolves #53, for both saved-session and first-shutdown.

This adds a new file which lists the schemas we want to alias.
This does not handle versions; the aliased namespace/doctype
are assumed to have the same versions as the source schemas.

This also includes a validation schema for the aliasing file,
and tests that the file is valid.

The test output is here: https://github.com/mozilla-services/mozilla-pipeline-schemas/tree/test-generated-schemas",fbertsch,20819040,2019-08-15T16:33:11Z,COLLABORATOR,True,242,1,9,A library for creating full representations of Mozilla telemetry pings.,Python,4ce4e80b0ca39a1a171c0dd8ae3bddd8a8e45354,Add tests for aliasing
246,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/58,58,Add support for schema aliasing,"Resolves #53, for both saved-session and first-shutdown.

This adds a new file which lists the schemas we want to alias.
This does not handle versions; the aliased namespace/doctype
are assumed to have the same versions as the source schemas.

This also includes a validation schema for the aliasing file,
and tests that the file is valid.

The test output is here: https://github.com/mozilla-services/mozilla-pipeline-schemas/tree/test-generated-schemas",fbertsch,20819040,2019-08-15T16:33:11Z,COLLABORATOR,True,242,1,9,A library for creating full representations of Mozilla telemetry pings.,Python,db1388caa3f93751a28cf643c5838e68690eef89,"Use f-string instead of format

Co-Authored-By: Anthony Miyaguchi <amiyaguchi@mozilla.com>"
247,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/58,58,Add support for schema aliasing,"Resolves #53, for both saved-session and first-shutdown.

This adds a new file which lists the schemas we want to alias.
This does not handle versions; the aliased namespace/doctype
are assumed to have the same versions as the source schemas.

This also includes a validation schema for the aliasing file,
and tests that the file is valid.

The test output is here: https://github.com/mozilla-services/mozilla-pipeline-schemas/tree/test-generated-schemas",fbertsch,20819040,2019-08-15T16:33:11Z,COLLABORATOR,True,242,1,9,A library for creating full representations of Mozilla telemetry pings.,Python,c04e51f9a9bd6b1baeff113e78c1be1cdc00abb7,Disallow additionalProperties in alias namespaces
248,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/58,58,Add support for schema aliasing,"Resolves #53, for both saved-session and first-shutdown.

This adds a new file which lists the schemas we want to alias.
This does not handle versions; the aliased namespace/doctype
are assumed to have the same versions as the source schemas.

This also includes a validation schema for the aliasing file,
and tests that the file is valid.

The test output is here: https://github.com/mozilla-services/mozilla-pipeline-schemas/tree/test-generated-schemas",fbertsch,20819040,2019-08-15T16:33:11Z,COLLABORATOR,True,242,1,9,A library for creating full representations of Mozilla telemetry pings.,Python,27f8d8e4132a0320dcb762ec85daa92ad6540fcf,Fix linting
249,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/57,57,Add first-shutdown to the disallowlist,Prevents https://github.com/mozilla-services/mozilla-pipeline-schemas/pull/383 from being pushed to BigQuery.,acmiyaguchi,3304040,2019-08-14T18:29:54Z,COLLABORATOR,True,1,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,f2b986c7e50d0c40f675f8bd5a05d5d0fc766d21,Add first-shutdown to the disallowlist
250,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/56,56,Move to disallowlist for schemas,"Closes #30.

The schemas that we currently remove due to the allowlist is here:
```
./pioneer-study/online-news-log.2.bq
./pioneer-study/pathfinder-event.1.bq
./pioneer-study/shield-study-addon.3.bq
./pioneer-study/shield-study-error.3.bq
./pioneer-study/esper-study-telemetry.1.bq
./pioneer-study/shield-study.3.bq
./pioneer-study/online-news-log.1.bq
./pioneer-study/event.1.bq
./pioneer-study/pathfinder-log.1.bq
./metadata/structured-ingestion/structured-ingestion.1.bq
./metadata/telemetry-ingestion/telemetry-ingestion.1.bq
./metadata/credentials/credentials.1.bq
./glean/baseline/baseline.1.bq
./glean/events/events.1.bq
./glean/metrics/metrics.1.bq
```

The disallowlist matches this exactly.",fbertsch,20819040,2019-08-13T20:27:25Z,COLLABORATOR,True,9,23,3,A library for creating full representations of Mozilla telemetry pings.,Python,429ddefc14e0176abf5bba29d53e31a13116a1bb,Move to disallowlist for schemas
251,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/56,56,Move to disallowlist for schemas,"Closes #30.

The schemas that we currently remove due to the allowlist is here:
```
./pioneer-study/online-news-log.2.bq
./pioneer-study/pathfinder-event.1.bq
./pioneer-study/shield-study-addon.3.bq
./pioneer-study/shield-study-error.3.bq
./pioneer-study/esper-study-telemetry.1.bq
./pioneer-study/shield-study.3.bq
./pioneer-study/online-news-log.1.bq
./pioneer-study/event.1.bq
./pioneer-study/pathfinder-log.1.bq
./metadata/structured-ingestion/structured-ingestion.1.bq
./metadata/telemetry-ingestion/telemetry-ingestion.1.bq
./metadata/credentials/credentials.1.bq
./glean/baseline/baseline.1.bq
./glean/events/events.1.bq
./glean/metrics/metrics.1.bq
```

The disallowlist matches this exactly.",fbertsch,20819040,2019-08-13T20:27:25Z,COLLABORATOR,True,9,23,3,A library for creating full representations of Mozilla telemetry pings.,Python,654829705b1eafae51a5db72b60569fdd1c50cd9,Add metadata/sources to disallowlist
252,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/55,55,Generate BQ schemas for fenix-nightly,Should this be considered prod as well? Currently these will be routed to stage because they are a different namespace (we're moving everything to prod soonish so it perhaps won't be as relevant).,whd,808776,2019-08-13T02:10:08Z,MEMBER,True,1,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,d41c0cc3b62884431cb3091d6eef2124e36b21fb,Generate BQ schemas for fenix-nightly
253,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/54,54,Enable all_pings for Glean,"- Allows `all_pings` for a Glean probe definition, where
  the metric is added to every ping for that app
- Correctly sorts the Glean probe definitions by date
- Move sorting of Main probes to the MainProbe class
- Update tests to fix new schema for Main probe defs
  (it now matches the probe-info-service exactly)",fbertsch,20819040,2019-08-12T15:53:06Z,COLLABORATOR,True,311,91,8,A library for creating full representations of Mozilla telemetry pings.,Python,300263de91edc6a68815eb096fcf8bafd62031c2,"Enable all_pings for Glean

- Allows `all_pings` for a Glean probe definition, where
  the metric is added to every ping for that app
- Correctly sorts the Glean probe definitions by date
- Move sorting of Main probes to the MainProbe class
- Update tests to fix new schema for Main probe defs
  (it now matches the probe-info-service exactly)"
254,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/54,54,Enable all_pings for Glean,"- Allows `all_pings` for a Glean probe definition, where
  the metric is added to every ping for that app
- Correctly sorts the Glean probe definitions by date
- Move sorting of Main probes to the MainProbe class
- Update tests to fix new schema for Main probe defs
  (it now matches the probe-info-service exactly)",fbertsch,20819040,2019-08-12T15:53:06Z,COLLABORATOR,True,311,91,8,A library for creating full representations of Mozilla telemetry pings.,Python,8db5f04279816be421f9345ba272b6f9b4aa5e57,Add test_probes file
255,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/54,54,Enable all_pings for Glean,"- Allows `all_pings` for a Glean probe definition, where
  the metric is added to every ping for that app
- Correctly sorts the Glean probe definitions by date
- Move sorting of Main probes to the MainProbe class
- Update tests to fix new schema for Main probe defs
  (it now matches the probe-info-service exactly)",fbertsch,20819040,2019-08-12T15:53:06Z,COLLABORATOR,True,311,91,8,A library for creating full representations of Mozilla telemetry pings.,Python,c544b9ac15fb775efa74af0f0d281021f7d302d5,Include errors in glean test
256,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/51,51,Transpile payload bytes pubsub schemas,"See https://github.com/mozilla/mozilla-schema-generator/issues/52 for discussion

~~CI failure is unrelated and being worked on.~~

I've verified this produces the output I expect, but didn't push the commit to the test-generated-schemas branch.",whd,808776,2019-08-06T21:24:45Z,MEMBER,True,8,4,2,A library for creating full representations of Mozilla telemetry pings.,Python,5a2a3e8e05c10fc0e797d78c3dc69c286b74e562,Transpile payload bytes pubsub schemas
257,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/50,50,Bump jsonschema-transpiler dependency to 1.3.0,This pulls in the new feature introduced in https://github.com/mozilla/jsonschema-transpiler/pull/82.,acmiyaguchi,3304040,2019-08-05T21:50:51Z,COLLABORATOR,True,1,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,9ef1e695cd60a613204205c1f4e5213d44e45860,Bump jsonschema-transpiler dependency to 1.3.0
258,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/49,49,Add disableSHA1rollout to specially snake-cased pings,,whd,808776,2019-08-01T20:18:12Z,MEMBER,True,2,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,94ce3e7bae81e02e40a3212b3814345478e2e10d,Add disableSHA1rollout to specially snake-cased pings
259,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/46,46,Snake case BQ table and field names,"Relies on https://github.com/mozilla/jsonschema-transpiler/pull/79

Closes #41",jklukas,691060,2019-07-16T18:18:11Z,CONTRIBUTOR,True,7,3,2,A library for creating full representations of Mozilla telemetry pings.,Python,9f6b26ca30122181d37865bda7feaa25034a453c,Drop under-specified columns during transpilation
260,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/46,46,Snake case BQ table and field names,"Relies on https://github.com/mozilla/jsonschema-transpiler/pull/79

Closes #41",jklukas,691060,2019-07-16T18:18:11Z,CONTRIBUTOR,True,7,3,2,A library for creating full representations of Mozilla telemetry pings.,Python,71ff704b388532ce0ce6afe03cf21b2b8d1b4abe,Skip CI when pushing to test branch of m-p-s
261,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/46,46,Snake case BQ table and field names,"Relies on https://github.com/mozilla/jsonschema-transpiler/pull/79

Closes #41",jklukas,691060,2019-07-16T18:18:11Z,CONTRIBUTOR,True,7,3,2,A library for creating full representations of Mozilla telemetry pings.,Python,478c1592e53355976b20087052f214e10ad812ae,"Snake case BQ table and field names

Relies on https://github.com/mozilla/jsonschema-transpiler/pull/79"
262,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/46,46,Snake case BQ table and field names,"Relies on https://github.com/mozilla/jsonschema-transpiler/pull/79

Closes #41",jklukas,691060,2019-07-16T18:18:11Z,CONTRIBUTOR,True,7,3,2,A library for creating full representations of Mozilla telemetry pings.,Python,257cfa02387a90f7716fd11dba104db50d61ce34,Use hyphen rather than underscore when converting untrustedModules
263,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/46,46,Snake case BQ table and field names,"Relies on https://github.com/mozilla/jsonschema-transpiler/pull/79

Closes #41",jklukas,691060,2019-07-16T18:18:11Z,CONTRIBUTOR,True,7,3,2,A library for creating full representations of Mozilla telemetry pings.,Python,d20d7a6155ffb5812ec0b7a7611d0743134d1014,Merge branch 'master' into snake-case-schemas
264,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/45,45,Add remaining telemetry pings,"Requires https://github.com/mozilla-services/cloudops-infra/pull/1178

We may need to back this out again if the additional pings cause issues, but we're not expecting that to be the case.

Sync pings are still an open question but can hopefully be dealt with in a backwards-compatible manner from the [current placeholder schema](https://github.com/mozilla-services/mozilla-pipeline-schemas/blob/master/schemas/telemetry/sync/sync.4.schema.json).",whd,808776,2019-07-09T20:38:15Z,MEMBER,True,1,3,1,A library for creating full representations of Mozilla telemetry pings.,Python,985c2701b9231324e6bb1aff9514fae80e8992ee,Add remaining telemetry pings to allowlist
265,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/44,44,Add main ping,"Changes available here: https://github.com/mozilla-services/mozilla-pipeline-schemas/tree/test-generated-schemas

Closes https://github.com/mozilla/mozilla-schema-generator/issues/43
",fbertsch,20819040,2019-07-08T20:33:01Z,COLLABORATOR,True,32,1120,9,A library for creating full representations of Mozilla telemetry pings.,Python,539e5b8d938d1c5d86f12c8fd16ce2603224c75b,Write main pings out using main name
266,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/44,44,Add main ping,"Changes available here: https://github.com/mozilla-services/mozilla-pipeline-schemas/tree/test-generated-schemas

Closes https://github.com/mozilla/mozilla-schema-generator/issues/43
",fbertsch,20819040,2019-07-08T20:33:01Z,COLLABORATOR,True,32,1120,9,A library for creating full representations of Mozilla telemetry pings.,Python,d512810104608fc06b9c0d4e449591761a2bdaf0,Use schema-generator for main ping
267,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/44,44,Add main ping,"Changes available here: https://github.com/mozilla-services/mozilla-pipeline-schemas/tree/test-generated-schemas

Closes https://github.com/mozilla/mozilla-schema-generator/issues/43
",fbertsch,20819040,2019-07-08T20:33:01Z,COLLABORATOR,True,32,1120,9,A library for creating full representations of Mozilla telemetry pings.,Python,289ec509042a7df9e472176407abb4de59505d49,Remove changes to the main ping schema
268,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/44,44,Add main ping,"Changes available here: https://github.com/mozilla-services/mozilla-pipeline-schemas/tree/test-generated-schemas

Closes https://github.com/mozilla/mozilla-schema-generator/issues/43
",fbertsch,20819040,2019-07-08T20:33:01Z,COLLABORATOR,True,32,1120,9,A library for creating full representations of Mozilla telemetry pings.,Python,f4baf4af2d93ffd7158eced177f426cbff72fa51,Use correct version for main ping
269,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/44,44,Add main ping,"Changes available here: https://github.com/mozilla-services/mozilla-pipeline-schemas/tree/test-generated-schemas

Closes https://github.com/mozilla/mozilla-schema-generator/issues/43
",fbertsch,20819040,2019-07-08T20:33:01Z,COLLABORATOR,True,32,1120,9,A library for creating full representations of Mozilla telemetry pings.,Python,2fb8cf2d79a598cfab04448d7060e94c9f63ebbe,Merge branch 'master' into add_main_ping
270,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/41,41,Drop under-specified columns during transpilation,"Commit with differences here: https://github.com/mozilla-services/mozilla-pipeline-schemas/commit/ae10d1e4d8efa88aaaf80a15a29b35d71533a515

Looks like just a few schemas will change (and the prio ping added?)",fbertsch,20819040,2019-07-02T21:01:38Z,COLLABORATOR,False,2,2,2,A library for creating full representations of Mozilla telemetry pings.,Python,97073fca49c3b693227735782089211b899713ce,Drop under-specified columns during transpilation
271,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/41,41,Drop under-specified columns during transpilation,"Commit with differences here: https://github.com/mozilla-services/mozilla-pipeline-schemas/commit/ae10d1e4d8efa88aaaf80a15a29b35d71533a515

Looks like just a few schemas will change (and the prio ping added?)",fbertsch,20819040,2019-07-02T21:01:38Z,COLLABORATOR,False,2,2,2,A library for creating full representations of Mozilla telemetry pings.,Python,ee75de75d2708712f83b2d0373af775bd3e685f6,Merge branch 'master' into resolve_schemas
272,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/39,39,Represent histograms as strings,Fixes #38,jklukas,691060,2019-06-28T19:02:29Z,CONTRIBUTOR,True,26,48,2,A library for creating full representations of Mozilla telemetry pings.,Python,0427be44032375f4adb5ea178a7b298a877fe531,Fix max_size with new histogram size
273,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/39,39,Represent histograms as strings,Fixes #38,jklukas,691060,2019-06-28T19:02:29Z,CONTRIBUTOR,True,26,48,2,A library for creating full representations of Mozilla telemetry pings.,Python,e95618db4e401d5a9b274a9cd3c4651f15753741,Represent histograms as strings
274,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/37,37,Expose a public interface to the schema generator script for testing,"This exposes `MPS_REPO_URL`, `MPS_BRANCH_SOURCE`, and `MPS_BRANCH_PUBLISH` as a public interface to the container's main entry point. This also defaults the publish branch to `test-generated-schemas` when running the job locally. This prevents accidentally pushing to the production branch when testing locally. 

Fixes https://github.com/mozilla/mozilla-schema-generator/issues/28.",acmiyaguchi,3304040,2019-06-25T20:25:09Z,COLLABORATOR,True,14,7,2,A library for creating full representations of Mozilla telemetry pings.,Python,103f7ce0662a6ccb6d4cc49fe68b62ca3a4ed091,Expose a public interface to the schema generator script for testing
275,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/37,37,Expose a public interface to the schema generator script for testing,"This exposes `MPS_REPO_URL`, `MPS_BRANCH_SOURCE`, and `MPS_BRANCH_PUBLISH` as a public interface to the container's main entry point. This also defaults the publish branch to `test-generated-schemas` when running the job locally. This prevents accidentally pushing to the production branch when testing locally. 

Fixes https://github.com/mozilla/mozilla-schema-generator/issues/28.",acmiyaguchi,3304040,2019-06-25T20:25:09Z,COLLABORATOR,True,14,7,2,A library for creating full representations of Mozilla telemetry pings.,Python,32a08b98c349e550e388b617d71c7f6f49a9ca5b,Update default publish branch in the container
276,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/36,36,Update allowlist for prio ping,,acmiyaguchi,3304040,2019-06-20T17:36:02Z,COLLABORATOR,True,1,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,38e67f44e93ae78c6ffbeb884087ba4086565774,Update allowlist for prio ping
277,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/35,35,Use MPG master,,fbertsch,20819040,2019-06-19T20:00:32Z,COLLABORATOR,True,1,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,30aa9f1cf3783aec969cbf14ab3ffcc68c1a7f2e,Use MPS master
278,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/34,34,Add minimal main ping schema,"- Reorder allowlist
- Add schemas dir which overwrites schemas
- Add main ping to allowlist",fbertsch,20819040,2019-06-19T17:08:37Z,COLLABORATOR,True,1061,8,3,A library for creating full representations of Mozilla telemetry pings.,Python,abac1a742847a614e504c945efbf4cdfdac1b1fb,"Add minimal main ping schema

- Reorder allowlist
- Add schemas dir which overwrites schemas
- Add main ping to allowlist"
279,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/33,33,Back out most telemetry tables while we sort out some issues,"See https://github.com/mozilla/gcp-ingestion/issues/651. Since we know we run stably with only core pings and structured, we're going to hold off enabling telemetry for the forthcoming production stacks.",whd,808776,2019-06-14T18:49:58Z,MEMBER,True,0,53,1,A library for creating full representations of Mozilla telemetry pings.,Python,bc78269e86c28a42630b90ad87413bb4b564a27c,Back out most telemetry tables while we sort out some issues
280,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/32,32,Remove mobile-metrics from the allowlist,See https://github.com/mozilla/gcp-ingestion/issues/649 for details,whd,808776,2019-06-12T17:36:12Z,MEMBER,True,0,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,ca28b8c88989a767b2b3c565c8f0d108a60ab780,"Remove mobile-metrics from the allowlist

See https://github.com/mozilla/gcp-ingestion/issues/649 for details"
281,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/31,31,Add back core pings,whoops,whd,808776,2019-06-07T01:06:14Z,MEMBER,True,1,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,f549e8c9aebe32f10944181a253233ba32b01e25,Add back core pings
282,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/29,29,Add non-sync non-main non-pioneer telemetry doctypes to allowlist,"It looks like the schema rollouts so far have been successful. Bigquery tables are case-sensitive so currently e.g. `untrustedModules` will be used as-is in the bq table name, though we could normalize it if we wanted to.",whd,808776,2019-06-06T18:05:35Z,MEMBER,True,54,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,26f656002bf92b84b8ba7286678c67bd3e7df20d,Add non-sync non-main non-pioneer telemetry doctypes to allowlist
283,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/27,27,Glean ping schemas,"@mdboom to review the glean MSG changes
@whd to review the script and allowlist updates

Note: The allowlist does need to be updated since it deletes BQ schemas not in it, so although MGS adds them automatically, they still have to be included (I was wrong earlier).",fbertsch,20819040,2019-06-05T17:47:49Z,COLLABORATOR,True,56,23,6,A library for creating full representations of Mozilla telemetry pings.,Python,51346f3ab856aa1dc06b1c53ae8a4114b126be7b,Rename get-glean-ping
284,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/27,27,Glean ping schemas,"@mdboom to review the glean MSG changes
@whd to review the script and allowlist updates

Note: The allowlist does need to be updated since it deletes BQ schemas not in it, so although MGS adds them automatically, they still have to be included (I was wrong earlier).",fbertsch,20819040,2019-06-05T17:47:49Z,COLLABORATOR,True,56,23,6,A library for creating full representations of Mozilla telemetry pings.,Python,be2d46a5e7b08d0db4d4a81bc0a66135dedb88cf,Add logging instead of printing
285,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/27,27,Glean ping schemas,"@mdboom to review the glean MSG changes
@whd to review the script and allowlist updates

Note: The allowlist does need to be updated since it deletes BQ schemas not in it, so although MGS adds them automatically, they still have to be included (I was wrong earlier).",fbertsch,20819040,2019-06-05T17:47:49Z,COLLABORATOR,True,56,23,6,A library for creating full representations of Mozilla telemetry pings.,Python,3f6f27f214e15a27ebc4277a48b3bbf7781637e0,Fix repo option for glean
286,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/27,27,Glean ping schemas,"@mdboom to review the glean MSG changes
@whd to review the script and allowlist updates

Note: The allowlist does need to be updated since it deletes BQ schemas not in it, so although MGS adds them automatically, they still have to be included (I was wrong earlier).",fbertsch,20819040,2019-06-05T17:47:49Z,COLLABORATOR,True,56,23,6,A library for creating full representations of Mozilla telemetry pings.,Python,fe9f596f50884100383dc2a418c9f849d622943b,"Add generic-ping option for glean

Generic-ping is the non-filled in ping, but for all apps and pings
that glean is reporting. This can be useful for validation when
the exact structure is not required.

* Update types in glean_ping
* Don't include libraries in output"
287,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/27,27,Glean ping schemas,"@mdboom to review the glean MSG changes
@whd to review the script and allowlist updates

Note: The allowlist does need to be updated since it deletes BQ schemas not in it, so although MGS adds them automatically, they still have to be included (I was wrong earlier).",fbertsch,20819040,2019-06-05T17:47:49Z,COLLABORATOR,True,56,23,6,A library for creating full representations of Mozilla telemetry pings.,Python,c64053ec1c2aae171d267df3ec978c5d8d8277dd,Add generic glean json schemas to MPS
288,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/27,27,Glean ping schemas,"@mdboom to review the glean MSG changes
@whd to review the script and allowlist updates

Note: The allowlist does need to be updated since it deletes BQ schemas not in it, so although MGS adds them automatically, they still have to be included (I was wrong earlier).",fbertsch,20819040,2019-06-05T17:47:49Z,COLLABORATOR,True,56,23,6,A library for creating full representations of Mozilla telemetry pings.,Python,bc46804a9a9a926c87249927b38cb5234b81c31a,Lint fixes
289,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/27,27,Glean ping schemas,"@mdboom to review the glean MSG changes
@whd to review the script and allowlist updates

Note: The allowlist does need to be updated since it deletes BQ schemas not in it, so although MGS adds them automatically, they still have to be included (I was wrong earlier).",fbertsch,20819040,2019-06-05T17:47:49Z,COLLABORATOR,True,56,23,6,A library for creating full representations of Mozilla telemetry pings.,Python,14fa1cfd81906d7a5aa5fea0fe20af3da63ed748,Merge branch 'master' into glean_ping_schemas
290,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/27,27,Glean ping schemas,"@mdboom to review the glean MSG changes
@whd to review the script and allowlist updates

Note: The allowlist does need to be updated since it deletes BQ schemas not in it, so although MGS adds them automatically, they still have to be included (I was wrong earlier).",fbertsch,20819040,2019-06-05T17:47:49Z,COLLABORATOR,True,56,23,6,A library for creating full representations of Mozilla telemetry pings.,Python,b3da9c3b12e8047f57cc42d2daca0dc0c582bd54,"Update bin/schema_generator.sh

Co-Authored-By: whd <whd@users.noreply.github.com>"
291,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/26,26,Add remaining structured ingestion schemas to allowlist,,whd,808776,2019-06-04T18:18:45Z,MEMBER,True,9,2,1,A library for creating full representations of Mozilla telemetry pings.,Python,607993b6d84fc9cbd72cad17c136239758a01278,Add remaining structured ingestion schemas to allowlist
292,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/25,25,Remove addl properties,Fixes #22 ,fbertsch,20819040,2019-06-03T20:04:56Z,COLLABORATOR,True,122,33,6,A library for creating full representations of Mozilla telemetry pings.,Python,07d15bf82f1d4e9af4110f1e4abdfbbd919e95de,"Remove additionalProperties for non-filled in sections

Previously, some sections would have an 'additionalProperties'
section that remained after fill-in; this was because they
didn't have any probes that filled the sections in.

Instead of keeping that additionalProperties, we now remove
it. This way the resulting schema is what we hope - an empty
struct."
293,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/25,25,Remove addl properties,Fixes #22 ,fbertsch,20819040,2019-06-03T20:04:56Z,COLLABORATOR,True,122,33,6,A library for creating full representations of Mozilla telemetry pings.,Python,9da833e63676567ff4b2b7610f65a6ffbb90ea25,Fix lint issues
294,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/25,25,Remove addl properties,Fixes #22 ,fbertsch,20819040,2019-06-03T20:04:56Z,COLLABORATOR,True,122,33,6,A library for creating full representations of Mozilla telemetry pings.,Python,2f1df2f266254f3910e23df9261a04e08a83cbdc,"Address review feedback

* update test with schema key deletion
* add explanation for propogate"
295,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/25,25,Remove addl properties,Fixes #22 ,fbertsch,20819040,2019-06-03T20:04:56Z,COLLABORATOR,True,122,33,6,A library for creating full representations of Mozilla telemetry pings.,Python,b7c31b15a68f4c701b4c15987671d4f84fbab710,"Delete additionalProperties

Previously we set additionalProperties to false. This leads
to structs with no elements, which are not allowed in BQ
tables.

This commit deletes those, and propagates that deletion to
parents. As such, sometimes entire metrics sections are
left out of ping schemas.

* Add documentation for propagate"
296,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/25,25,Remove addl properties,Fixes #22 ,fbertsch,20819040,2019-06-03T20:04:56Z,COLLABORATOR,True,122,33,6,A library for creating full representations of Mozilla telemetry pings.,Python,24d41e048187096c184ffa8bdaba724d2874c775,Reenable delete test in test_schema
297,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/25,25,Remove addl properties,Fixes #22 ,fbertsch,20819040,2019-06-03T20:04:56Z,COLLABORATOR,True,122,33,6,A library for creating full representations of Mozilla telemetry pings.,Python,b3a0a41e73ff2a8683d4f0ec174fec9af1a43e29,Merge branch 'master' into remove_addl_properties
298,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/24,24,Add firefox installer pings to the allowlist,"More generally I'm going to start filing PRs to add more entries to the allowlist, but this is a specific case that is important.",whd,808776,2019-05-30T01:10:24Z,MEMBER,True,1,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,a968ff959bc0196633d9d036e88a1bbb548c5e11,Add firefox installer pings to the allowlist
299,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/21,21,1542709: Merge glean probes based on dependencies,This requires https://github.com/mozilla/probe-scraper/pull/87 to land first.,mdboom,38294,2019-05-20T19:20:40Z,CONTRIBUTOR,True,54,6,3,A library for creating full representations of Mozilla telemetry pings.,Python,808ff7bf58bfa32d2f265cf37662a7ccfab86537,1542709: Merge glean probes based on dependencies
300,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/21,21,1542709: Merge glean probes based on dependencies,This requires https://github.com/mozilla/probe-scraper/pull/87 to land first.,mdboom,38294,2019-05-20T19:20:40Z,CONTRIBUTOR,True,54,6,3,A library for creating full representations of Mozilla telemetry pings.,Python,2b472192763b05daee636a78cfe5b0a15392cb1b,Log the dependencies found
301,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/21,21,1542709: Merge glean probes based on dependencies,This requires https://github.com/mozilla/probe-scraper/pull/87 to land first.,mdboom,38294,2019-05-20T19:20:40Z,CONTRIBUTOR,True,54,6,3,A library for creating full representations of Mozilla telemetry pings.,Python,1741de0434f8cbba179de1385d54e29d9ad7e176,Add dependencies_url_template
302,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/21,21,1542709: Merge glean probes based on dependencies,This requires https://github.com/mozilla/probe-scraper/pull/87 to land first.,mdboom,38294,2019-05-20T19:20:40Z,CONTRIBUTOR,True,54,6,3,A library for creating full representations of Mozilla telemetry pings.,Python,66173fad5cd53bb6c6526b9b31a07be1f4709d80,Fix so testing is actually doing something
303,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/21,21,1542709: Merge glean probes based on dependencies,This requires https://github.com/mozilla/probe-scraper/pull/87 to land first.,mdboom,38294,2019-05-20T19:20:40Z,CONTRIBUTOR,True,54,6,3,A library for creating full representations of Mozilla telemetry pings.,Python,a12f3b49ae07c401157b491176c982888c768878,It's unlikely that no dependencies are found at this point
304,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/21,21,1542709: Merge glean probes based on dependencies,This requires https://github.com/mozilla/probe-scraper/pull/87 to land first.,mdboom,38294,2019-05-20T19:20:40Z,CONTRIBUTOR,True,54,6,3,A library for creating full representations of Mozilla telemetry pings.,Python,44c55e4d2e339317f293da7abe2db44e234a2b41,Improve example run
305,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/21,21,1542709: Merge glean probes based on dependencies,This requires https://github.com/mozilla/probe-scraper/pull/87 to land first.,mdboom,38294,2019-05-20T19:20:40Z,CONTRIBUTOR,True,54,6,3,A library for creating full representations of Mozilla telemetry pings.,Python,b867ef319c681be5f3037966da3a0afca518613f,flake8
306,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/21,21,1542709: Merge glean probes based on dependencies,This requires https://github.com/mozilla/probe-scraper/pull/87 to land first.,mdboom,38294,2019-05-20T19:20:40Z,CONTRIBUTOR,True,54,6,3,A library for creating full representations of Mozilla telemetry pings.,Python,ba37aa94964f69fdabf502f19c79df2c66a84da7,Fix generating glean dependencies
307,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,e7f9d1a13ad538e46a463aced5a8ab8bcd7b40d2,Add script to generate and upload schemas
308,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,639b25fb6302f4527d1b425e9e007e7f799e3cb0,Update metadata-merge with correct output
309,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,c49a65c060a195ef913b0197dc8d949154e291e9,Add namespace/doctype whitelist
310,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,4d9baf8a43ab6cce84b41fc5c627de3aa653a871,"Update git user and commit handling

- Use ssh key for pushing to github
- Cherry-pick commit for updated schemas
- Remove GCS handling"
311,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,0adf84b08f20fd35be12b88a91d82ba7c84638a1,Use published transpiler
312,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,51317e6a01d400c72ca91657c05913ccbfbc1410,Remove Avro schemas from script
313,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,90046c51f405720eb9fc50b6d940d640bcdc8a4c,Use dev branch of MPS
314,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,e0c7062d97761415dfe338c6dabe6ac3dd1287b9,Update whitelist
315,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,6dc5f1d953f316259dbd8c9432f13330a712dbe1,Use correct credentials for git push
316,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,4247724724aa6ce24955a9edc04c8981a76868e3,Correct transpiler BQ output with jq
317,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,7d3217bf231f4b8d7608a82bd413eff3de181c0c,"Push only whitelisted schemas

Pushes only the whitelisted schemas, and no other files.
Moved the generated main ping files to a new location."
318,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,0ff53a605a95604259922df9d2bb4ee91908d681,Move git config to script
319,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,47cd7a2a9ef940917fb3a39ee9f1e244c2ab563e,Remove controversial terminology
320,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,1e9dd8a3b412ab361829b4b0f6b0e00b981f68ca,Use local copy of mozilla-schema-generator
321,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,b97d6c6663a615d5cb689e222f7504b192623d2d,Use correct name for events ping
322,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,df6aad6f20eb91dd348fe937518608688acaa37a,Work on separate devlopment branch
323,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,7c15cce8e9abdc69f12048e4998ab9a34f0374e9,Remove non allowed-list bq schemas
324,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,b58ba56051636f489785965939759cde94768451,Don't include metadata in Json schemas
325,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,21a67f49571e47238d97b6daa08da347118ecd0d,Don't include parquet files
326,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,7e01548fd428af26563a4cfd2c892d0c41760d42,Pin jsonschema-transpiler to v1.0.0
327,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,c4438f65d96984621404647c50db1c9a5ab9cdb0,Assume binary location from PATH
328,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,0054cbe940c284fb28ff4793b9947aa33cd4e70d,Rename MPS_SSH_KEY_BASE64 and remove USER_ID
329,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,c0f227dfb08dff2c8fba6869cfeb30f86cd5ab86,Add script doc and move transpiler dep to dockerfile
330,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,158ff1357d65ac069dc5ce15c09a2f613e343657,Refactor script into modular parts
331,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,3c2d4189417f9be318aa75eb026822c190cf281f,Rename variables and make shellcheck happy
332,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,9ee438e89c9f9930609c88c168c96cf2dd67f5a0,Add newline
333,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,60591a84f846b0534e0885e304af37add7372ea0,"Update bin/allowlist

Co-Authored-By: whd <whd@users.noreply.github.com>"
334,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,857a1316b69f9ad4b99c482a894477f679490c3d,"Simplify dockerfile

* Remove excess chown
* Rename GROUP to GROUP_ID"
335,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,3a5abec5e3e0317b011c18f77181526f50ad7a82,"Fix permissions, use python3 -m venv, and set -exuo pipefail"
336,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/18,18,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:58:55Z,COLLABORATOR,True,231,11,7,A library for creating full representations of Mozilla telemetry pings.,Python,5b897e9a3b89ee70c2d7e2045d33c3d30cd17fc3,Only merge valid schemas; remove numbering
337,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/17,17,Add script to generate and upload schemas,,fbertsch,20819040,2019-04-25T20:54:34Z,COLLABORATOR,False,148,3,3,A library for creating full representations of Mozilla telemetry pings.,Python,e7f9d1a13ad538e46a463aced5a8ab8bcd7b40d2,Add script to generate and upload schemas
338,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/14,14,Update version,,fbertsch,20819040,2019-04-24T18:53:19Z,COLLABORATOR,True,1,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,3f3ddc85360ec2d6eb10b5dfb09498bc048ca08d,Update version
339,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/13,13,Write pings to directories with proper name,,fbertsch,20819040,2019-04-24T16:07:50Z,COLLABORATOR,True,22,12,4,A library for creating full representations of Mozilla telemetry pings.,Python,503a6e528a51890e438a427e2839d41560a34988,Write pings to directories with proper name
340,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/13,13,Write pings to directories with proper name,,fbertsch,20819040,2019-04-24T16:07:50Z,COLLABORATOR,True,22,12,4,A library for creating full representations of Mozilla telemetry pings.,Python,f62380e26d6703a579ba5f2b292ccf40693347aa,"Move pings to subdirectories

Also increments version by 1"
341,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/13,13,Write pings to directories with proper name,,fbertsch,20819040,2019-04-24T16:07:50Z,COLLABORATOR,True,22,12,4,A library for creating full representations of Mozilla telemetry pings.,Python,7b5d0c6307061b8229f9e51ca5aeeb4a5769b38d,Update readme with out-dir info
342,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/11,11,Pypy release and Docker container,,fbertsch,20819040,2019-04-18T20:58:27Z,COLLABORATOR,True,157,66,12,A library for creating full representations of Mozilla telemetry pings.,Python,812dc3d8352fde5edda86c8c60a632c3f4fb7481,"Setup deploy to work correctly

- Move config files to subdirectory
- Use twine for deploy"
343,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/11,11,Pypy release and Docker container,,fbertsch,20819040,2019-04-18T20:58:27Z,COLLABORATOR,True,157,66,12,A library for creating full representations of Mozilla telemetry pings.,Python,af3481f4c8c7c210bc57a306463bfb86b28d52c0,Add Docker container
344,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/11,11,Pypy release and Docker container,,fbertsch,20819040,2019-04-18T20:58:27Z,COLLABORATOR,True,157,66,12,A library for creating full representations of Mozilla telemetry pings.,Python,5dd4bb80516fb428da9714ee60dc7673fcae4d73,Rename docker clean command
345,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/11,11,Pypy release and Docker container,,fbertsch,20819040,2019-04-18T20:58:27Z,COLLABORATOR,True,157,66,12,A library for creating full representations of Mozilla telemetry pings.,Python,03b826c5b7b4d19fa3fc4a033401f6f8796d1d05,Remove labeled in config
346,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/11,11,Pypy release and Docker container,,fbertsch,20819040,2019-04-18T20:58:27Z,COLLABORATOR,True,157,66,12,A library for creating full representations of Mozilla telemetry pings.,Python,fce5b3a992091bbdeab8bc3a060ef7a92f63dfb9,Fix lint issue
347,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/11,11,Pypy release and Docker container,,fbertsch,20819040,2019-04-18T20:58:27Z,COLLABORATOR,True,157,66,12,A library for creating full representations of Mozilla telemetry pings.,Python,105cfec8ea6160cd9cf76c6b612e78da346569e7,Add CI deploy of container
348,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/10,10,Add Mozilla Code of Conduct,"Fixes #9


As of January 1 2019, Mozilla requires that all GitHub projects include this [CODE_OF_CONDUCT.md](https://github.com/mozilla/repo-templates/blob/master/templates/CODE_OF_CONDUCT.md) file in the project root. The file has two parts:

1. Required Text - All text under the headings *Community Participation Guidelines and How to Report*, are required, and should not be altered.
2. Optional Text - The Project Specific Etiquette heading provides a space to speak more specifically about ways people can work effectively and inclusively together. Some examples of those can be found on the [Firefox Debugger](https://github.com/devtools-html/debugger.html/blob/master/CODE_OF_CONDUCT.md) project, and [Common Voice](https://github.com/mozilla/voice-web/blob/master/CODE_OF_CONDUCT.md). (The optional part is commented out in the [raw template file](https://raw.githubusercontent.com/mozilla/repo-templates/blob/master/templates/CODE_OF_CONDUCT.md), and will not be visible until you modify and uncomment that part.)

If you have any questions about this file, or Code of Conduct policies and procedures, please see [Mozilla-GitHub-Standards](https://wiki.mozilla.org/GitHub/Repository_Requirements) or email Mozilla-GitHub-Standards+CoC@mozilla.com.

_(Message COC002)_",Mozilla-GitHub-Standards,48073334,2019-03-30T07:12:47Z,CONTRIBUTOR,True,15,0,1,A library for creating full representations of Mozilla telemetry pings.,Python,569f5220dfa7de9397aa99fbb0838dabcacf559f,"Add Mozilla Code of Conduct file

Fixes #9.

_(Message COC002)_"
349,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/8,8,Glean,,fbertsch,20819040,2019-03-18T16:49:45Z,COLLABORATOR,True,652,84,16,A library for creating full representations of Mozilla telemetry pings.,Python,9b0acda12abebc2f09dd1ad19bd00149ffb25173,"Refactoring

* Remove circular dependencies
* Move more functionality to GenericPing"
350,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/8,8,Glean,,fbertsch,20819040,2019-03-18T16:49:45Z,COLLABORATOR,True,652,84,16,A library for creating full representations of Mozilla telemetry pings.,Python,1c4e4278eb92427060a7fef14b2a7b06b6f9bb0c,Add Glean generation
351,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/8,8,Glean,,fbertsch,20819040,2019-03-18T16:49:45Z,COLLABORATOR,True,652,84,16,A library for creating full representations of Mozilla telemetry pings.,Python,6ad61c46b8eb3eff52e3ce6ffea24866b4854f40,"WIP: Glean full-ping creation

This isn't finalized yet, but does include pulling the existing
schema from the additionalProperties and applying it to the
metrics.

Next steps is to create a different schema for every ping that
is found in the metrics file."
352,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/8,8,Glean,,fbertsch,20819040,2019-03-18T16:49:45Z,COLLABORATOR,True,652,84,16,A library for creating full representations of Mozilla telemetry pings.,Python,e7bca56f45594560959cc82a4b800081510b7a30,Change circleci config extension
353,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/8,8,Glean,,fbertsch,20819040,2019-03-18T16:49:45Z,COLLABORATOR,True,652,84,16,A library for creating full representations of Mozilla telemetry pings.,Python,b7dcd4c26a284d965f7315b060c0dd56e5d2b050,Add venv to ci
354,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/8,8,Glean,,fbertsch,20819040,2019-03-18T16:49:45Z,COLLABORATOR,True,652,84,16,A library for creating full representations of Mozilla telemetry pings.,Python,5098caed64f62adb4af05037c9280623e0f142c7,Use a Monostep
355,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/8,8,Glean,,fbertsch,20819040,2019-03-18T16:49:45Z,COLLABORATOR,True,652,84,16,A library for creating full representations of Mozilla telemetry pings.,Python,9db79422aca30c85a48c2e0457ae1eb6d34927e6,Include flake8 in test_requirements
356,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/8,8,Glean,,fbertsch,20819040,2019-03-18T16:49:45Z,COLLABORATOR,True,652,84,16,A library for creating full representations of Mozilla telemetry pings.,Python,c27e0c7174a08dc1fd81c1873fddb272876ac5a9,Update Makefile and ci
357,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/8,8,Glean,,fbertsch,20819040,2019-03-18T16:49:45Z,COLLABORATOR,True,652,84,16,A library for creating full representations of Mozilla telemetry pings.,Python,9d27dcc18a31c9c2061282893aeefad4771cedcf,"Add new repositories and pings

Glean now generates schemas for every repository in `repositories.yaml`,
as well as for every ping listed for in that repositories `metrics.yaml`
file."
358,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/8,8,Glean,,fbertsch,20819040,2019-03-18T16:49:45Z,COLLABORATOR,True,652,84,16,A library for creating full representations of Mozilla telemetry pings.,Python,cb385d07dd84f024d4796eab8a5355b77bc86594,Use updated glean schema
359,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/8,8,Glean,,fbertsch,20819040,2019-03-18T16:49:45Z,COLLABORATOR,True,652,84,16,A library for creating full representations of Mozilla telemetry pings.,Python,2e97deb2d50452600214bd25c8f5181fb8d3d294,Update README with glean info
360,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/4,4,Update README to use `generated`,,fbertsch,20819040,2019-03-14T16:49:41Z,COLLABORATOR,True,6,6,1,A library for creating full representations of Mozilla telemetry pings.,Python,18be32337b6dac6924ccc88f41902be330270297,Update README to use `generated`
361,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/3,3,Switch to MPL,,fbertsch,20819040,2019-03-14T16:19:05Z,COLLABORATOR,True,474,20,18,A library for creating full representations of Mozilla telemetry pings.,Python,befd0e4276a0a734949ebcfbe8e9612bb9a63026,Switch to MPL
362,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/2,2,Fix sec alert,,fbertsch,20819040,2019-03-14T15:48:44Z,COLLABORATOR,True,1,1,1,A library for creating full representations of Mozilla telemetry pings.,Python,7a150e2ff741a926b44e04a4602db1f05c94d43c,Fix sec alert
363,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/1,1,Main ping,,fbertsch,20819040,2019-03-13T19:59:44Z,COLLABORATOR,True,1623,1067,39,A library for creating full representations of Mozilla telemetry pings.,Python,b55b336e954eebab92a92efa51b7f15bda9cb32b,Initial code+tests for main ping generation
364,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/1,1,Main ping,,fbertsch,20819040,2019-03-13T19:59:44Z,COLLABORATOR,True,1623,1067,39,A library for creating full representations of Mozilla telemetry pings.,Python,eef61ee8f3e57eec1597ac33ec6d4c0054bf346e,Update README and setup
365,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/1,1,Main ping,,fbertsch,20819040,2019-03-13T19:59:44Z,COLLABORATOR,True,1623,1067,39,A library for creating full representations of Mozilla telemetry pings.,Python,a533f811443132f7649753797c0699172ee74407,"Flake8 fixes, README update, remove tox"
366,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/1,1,Main ping,,fbertsch,20819040,2019-03-13T19:59:44Z,COLLABORATOR,True,1623,1067,39,A library for creating full representations of Mozilla telemetry pings.,Python,0009bb412cf8253053239bbcd12cdee844e18edd,Remove docs
367,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/1,1,Main ping,,fbertsch,20819040,2019-03-13T19:59:44Z,COLLABORATOR,True,1623,1067,39,A library for creating full representations of Mozilla telemetry pings.,Python,2311d0506985be81d4604dc648b7cb3f1fa00b01,"Update Makefile and README

Fix a few bugs when running using CLI"
368,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/1,1,Main ping,,fbertsch,20819040,2019-03-13T19:59:44Z,COLLABORATOR,True,1623,1067,39,A library for creating full representations of Mozilla telemetry pings.,Python,2dd2c2e81d012a6df2e4a8e401b5bab103241fcc,Add circleci integration
369,https://api.github.com/repos/mozilla/mozilla-schema-generator/pulls/1,1,Main ping,,fbertsch,20819040,2019-03-13T19:59:44Z,COLLABORATOR,True,1623,1067,39,A library for creating full representations of Mozilla telemetry pings.,Python,4a62e8ae3a40f5b8a3f830e17f113903bd9e35bf,s/mozilla-schema-creator/mozilla-schema-generator/g
